<!DOCTYPE html>

<html class="writer-html5" lang="en">
<head>
<meta charset="utf-8"/>
<meta content="IE=edge" http-equiv="X-UA-Compatible"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/><link href="https://sshah1502.github.io/irgsc/apireference.html" rel="canonical"/>
<link href="img/favicon.ico" rel="shortcut icon"/>
<title>API - irgsctool</title>
<link href="css/theme.css" rel="stylesheet"/>
<link href="css/theme_extra.css" rel="stylesheet"/>
<link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/styles/github.min.css" rel="stylesheet"/>
<link href="assets/_mkdocstrings.css" rel="stylesheet"/>
<script>
        // Current page data
        var mkdocs_page_name = "API";
        var mkdocs_page_input_path = "apireference.md";
        var mkdocs_page_url = "/irgsc/apireference.html";
      </script>
<script defer="" src="js/jquery-3.6.0.min.js"></script>
<!--[if lt IE 9]>
      <script src="js/html5shiv.min.js"></script>
    <![endif]-->
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/highlight.min.js"></script>
<script>hljs.initHighlightingOnLoad();</script>
<link href="assets/stylesheets/glightbox.min.css" rel="stylesheet"/><style>
            html.glightbox-open { overflow: initial; height: 100%; }
            .gslide-title { margin-top: 0px; user-select: text; }
            .gslide-desc { color: #666; user-select: text; }
            .gslide-image img { background: white; }
            </style><script src="assets/javascripts/glightbox.min.js"></script></head>
<body class="wy-body-for-nav" role="document">
<div class="wy-grid-for-nav">
<nav class="wy-nav-side stickynav" data-toggle="wy-nav-shift">
<div class="wy-side-scroll">
<div class="wy-side-nav-search">
<a href="index.html">
<img alt="Logo" class="logo" src="img/TMT_LOGO.PNG"/>
</a>
</div>
<div aria-label="Navigation menu" class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation">
<ul>
<li class="toctree-l1"><a class="reference internal" href="index.html">Home</a>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="about.html">About</a>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="" href="userguide.md">UserGuide</a>
</li>
</ul>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal current" href="apireference.html">API</a>
<ul class="current">
<li class="toctree-l2"><a class="reference internal" href="#irgsctool">irgsctool</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="#irgsctool.irgsc">irgsc</a>
<ul>
<li class="toctree-l3"><a class="reference internal" href="#irgsctool.irgsc.__init__">__init__()</a>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#irgsctool._get_data">irgsctool._get_data</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="#irgsctool._get_data.GetData">GetData</a>
<ul>
<li class="toctree-l3"><a class="reference internal" href="#irgsctool._get_data.GetData.get_gaia_data">get_gaia_data()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#irgsctool._get_data.GetData.get_panstarrs_data">get_panstarrs_data()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#irgsctool._get_data.GetData.get_ukidss_data">get_ukidss_data()</a>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#irgsctool._read_data">irgsctool._read_data</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="#irgsctool._read_data.ReadData">ReadData</a>
<ul>
<li class="toctree-l3"><a class="reference internal" href="#irgsctool._read_data.ReadData.read_gaia_data">read_gaia_data()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#irgsctool._read_data.ReadData.read_nir_data">read_nir_data()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#irgsctool._read_data.ReadData.read_optical_data">read_optical_data()</a>
<ul>
<li class="toctree-l4"><a class="reference internal" href="#irgsctool._read_data.ReadData.read_optical_data--irgsctoolreaddataread_optical_data">irgsctool.ReadData.read_optical_data()</a>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#irgsctool._sgc">irgsctool._sgc</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="#irgsctool._sgc.StarGalaxyClassification">StarGalaxyClassification</a>
<ul>
<li class="toctree-l3"><a class="reference internal" href="#irgsctool._sgc.StarGalaxyClassification.star_galaxy_classification">star_galaxy_classification()</a>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#irgsctool._extinction_correction">irgsctool._extinction_correction</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="#irgsctool._extinction_correction.ExtinctionCorrection">ExtinctionCorrection</a>
<ul>
<li class="toctree-l3"><a class="reference internal" href="#irgsctool._extinction_correction.ExtinctionCorrection.extinction_corrected_photometry">extinction_corrected_photometry()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#irgsctool._extinction_correction.ExtinctionCorrection.get_reddening">get_reddening()</a>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#irgsctool._sam">irgsctool._sam</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="#irgsctool._sam.Models">Models</a>
<ul>
<li class="toctree-l3"><a class="reference internal" href="#irgsctool._sam.Models.read_sam_file">read_sam_file()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#irgsctool._sam.Models.select_sam_range">select_sam_range()</a>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#irgsctool._fitting">irgsctool._fitting</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="#irgsctool._fitting.GenerateIRGSC">GenerateIRGSC</a>
<ul>
<li class="toctree-l3"><a class="reference internal" href="#irgsctool._fitting.GenerateIRGSC.generate_irgsc">generate_irgsc()</a>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#irgsctool._validate">irgsctool._validate</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="#irgsctool._validate.ValidateIRGSC">ValidateIRGSC</a>
<ul>
<li class="toctree-l3"><a class="reference internal" href="#irgsctool._validate.ValidateIRGSC.read_irgsc">read_irgsc()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#irgsctool._validate.ValidateIRGSC.validate">validate()</a>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="license.html">License</a>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="tutorials.html">Tutorials</a>
</li>
</ul>
</div>
</div>
</nav>
<section class="wy-nav-content-wrap" data-toggle="wy-nav-shift">
<nav aria-label="Mobile navigation menu" class="wy-nav-top" role="navigation">
<i class="fa fa-bars" data-toggle="wy-nav-top"></i>
<a href="index.html">irgsctool</a>
</nav>
<div class="wy-nav-content">
<div class="rst-content"><div aria-label="breadcrumbs navigation" role="navigation">
<ul class="wy-breadcrumbs">
<li><a alt="Docs" class="icon icon-home" href="index.html"></a> Â»</li>
<li>API</li>
<li class="wy-breadcrumbs-aside">
</li>
</ul>
<hr/>
</div>
<div class="document" itemscope="itemscope" itemtype="http://schema.org/Article" role="main">
<div class="section" itemprop="articleBody">
<h1 id="api-reference">API Reference</h1>
<p>This page introduces to the classes and functions in the <strong><em>irgsctool</em></strong> package. The main class is the <strong><em>irgsc</em></strong> class which has several subclasses like <a href="/irgsc/apireference/#irgsctool._get_data.GetData">GetData</a>, <a href="/irgsc/apireference/#irgsctool._read_data.ReadData">ReadData</a>, <a href="/irgsc/apireference/#irgsctool._sgc.StarGalaxyClassification">StarGalaxyClassification</a>, <a href="/irgsc/apireference/#irgsctool._extinction_correction.ExtinctionCorrection">ExtinctionCorrection</a>, <a href="/irgsc/apireference/#irgsctool._fitting.GenerateIRGSC">GenerateIRGSC</a>, <a href="/irgsc/apireference/#irgsctool._validate.ValidateIRGSC">ValidateIRGSC</a>.</p>
<p>Figure (1) shows the UML diagram of the irgsctool package.</p>
<p><center></center></p>
<figure>
<a class="glightbox" data-desc-position="bottom" data-height="auto" data-type="image" data-width="100%" href="img/uml.png"><img alt="uml" height="500" src="img/uml.png" width="600"/></a>
<figcaption><em><strong>Figure 1:</strong></em> The UML diagram of the <em><strong> irgsctool </strong></em> package.</figcaption>
</figure>
<p></p>
<div class="doc doc-object doc-module">
<a id="irgsctool"></a>
<div class="doc doc-contents first">
<div class="doc doc-children">
<div class="doc doc-object doc-class">
<h2 class="doc doc-heading" id="irgsctool.irgsc">
<code>irgsc</code>
</h2>
<div class="doc doc-contents">
<p class="doc doc-class-bases">
        Bases: <code><a class="autorefs autorefs-internal" title="irgsctool._get_data.GetData" href="#irgsctool._get_data.GetData">GetData</a></code>, <code><a class="autorefs autorefs-internal" title="irgsctool._read_data.ReadData" href="#irgsctool._read_data.ReadData">ReadData</a></code>, <code><a class="autorefs autorefs-internal" title="irgsctool._sgc.StarGalaxyClassification" href="#irgsctool._sgc.StarGalaxyClassification">StarGalaxyClassification</a></code>, <code><a class="autorefs autorefs-internal" title="irgsctool._extinction_correction.ExtinctionCorrection" href="#irgsctool._extinction_correction.ExtinctionCorrection">ExtinctionCorrection</a></code>, <code><a class="autorefs autorefs-internal" title="irgsctool._sam.Models" href="#irgsctool._sam.Models">Models</a></code>, <code><a class="autorefs autorefs-internal" title="irgsctool._fitting.GenerateIRGSC" href="#irgsctool._fitting.GenerateIRGSC">GenerateIRGSC</a></code>, <code><a class="autorefs autorefs-internal" title="irgsctool._validate.ValidateIRGSC" href="#irgsctool._validate.ValidateIRGSC">ValidateIRGSC</a></code></p>
<hr/>
<p>Initialisation of parent <strong><em> irgsc class </em></strong>. This class has several child classes.</p>
<details class="quote">
<summary>Source code in <code>irgsctool/__init__.py</code></summary>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">irgsc</span><span class="p">(</span><span class="n">GetData</span><span class="p">,</span> <span class="n">ReadData</span><span class="p">,</span> <span class="n">StarGalaxyClassification</span><span class="p">,</span> <span class="n">ExtinctionCorrection</span><span class="p">,</span> <span class="n">Models</span><span class="p">,</span>
            <span class="n">GenerateIRGSC</span><span class="p">,</span> <span class="n">ValidateIRGSC</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    ------------------------------------------</span>
<span class="sd">    Initialisation of parent *** irgsc class ***. This class has several child classes.</span>
<span class="sd">    """</span>
    <span class="nb">print</span> <span class="p">(</span><span class="s1">'##########################################################################'</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">""</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">'Initializing'</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">""</span><span class="p">)</span>
    <span class="nb">print</span> <span class="p">(</span><span class="s1">'##########################################################################'</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">""</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ra</span><span class="p">,</span> <span class="n">dec</span><span class="p">,</span> <span class="n">validate</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""</span>
<span class="sd">        This method described using input  ra and dec.</span>
<span class="sd">        It checks whther the data from PANSTARRS DR2, UKISS DR11 and</span>
<span class="sd">        Gaia DR3 can be obtained.</span>
<span class="sd">        Raises:</span>
<span class="sd">            ValueError: if the data is not available in UKIDSS or</span>
<span class="sd">                        PANSTARRS 3-pi survey. The code will not\</span>
<span class="sd">                             proceed further.</span>
<span class="sd">            Warning: if the data is not available in the Gaia DR3\</span>
<span class="sd">                        survey. In the IRGSC, the Gaia values will\</span>
<span class="sd">                            be replaces with -999.</span>

<span class="sd">        """</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">''</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">'##################################################'</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">'Checking the input coordinates'</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">''</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">'##################################################'</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">''</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ra</span> <span class="o">=</span> <span class="n">ra</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dec</span> <span class="o">=</span> <span class="n">dec</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">validate</span><span class="o">=</span><span class="n">validate</span>
        <span class="n">gd</span> <span class="o">=</span> <span class="n">GetData</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ra</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dec</span><span class="p">)</span>
        <span class="n">rd</span> <span class="o">=</span> <span class="n">ReadData</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ra</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dec</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ra</span> <span class="o">&lt;</span> <span class="mf">0.0</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">dec</span><span class="o">&lt;-</span><span class="mf">30.0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">'Please check the input coordinates'</span><span class="p">)</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

        <span class="n">ra_name</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ra</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">'.'</span><span class="p">,</span><span class="s1">'_'</span><span class="p">)</span>
        <span class="n">dec_name</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dec</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">'.'</span><span class="p">,</span> <span class="s1">'_'</span><span class="p">)</span>


        <span class="c1">#Checking whether UKIDSS data is available for the given field.</span>
        <span class="c1">###If yes then obtaining it.</span>

        <span class="n">file_name</span> <span class="o">=</span> <span class="s1">'UKIDSS'</span><span class="o">+</span><span class="s1">'_'</span><span class="o">+</span><span class="s1">'ra'</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ra_name</span><span class="p">)</span><span class="o">+</span><span class="s1">'DEC'</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">dec_name</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">validating_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">genfromtxt</span><span class="p">(</span><span class="n">file_name</span><span class="o">+</span><span class="s1">'.csv'</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">FileNotFoundError</span><span class="p">:</span>
            <span class="n">gd</span><span class="o">.</span><span class="n">get_ukidss_data</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ra</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dec</span><span class="p">)</span>
            <span class="n">validating_data</span> <span class="o">=</span> <span class="n">rd</span><span class="o">.</span><span class="n">read_nir_data</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ra</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dec</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">validate</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">validating_data</span><span class="p">)</span> <span class="o">==</span> <span class="mf">0.0</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">validate</span> <span class="o">=</span> <span class="kc">False</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">'UKIDSS Observed NIR data not available.</span><span class="se">\</span>
<span class="s1">                                 Validation of the generated IRGSC is not</span><span class="se">\</span>
<span class="s1">                                 possible for this field!!!'</span><span class="p">)</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

        <span class="c1">###Obtaining the PANSTARRS data for the given field.</span>

        <span class="n">file_name</span> <span class="o">=</span><span class="s1">'PS1'</span><span class="o">+</span><span class="s1">'_'</span><span class="o">+</span><span class="s1">'ra'</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ra_name</span><span class="p">)</span><span class="o">+</span><span class="s1">'DEC'</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">dec_name</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">optical_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">genfromtxt</span><span class="p">(</span><span class="n">file_name</span> <span class="o">+</span> <span class="s1">'.csv'</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">FileNotFoundError</span><span class="p">:</span>
            <span class="n">gd</span><span class="o">.</span><span class="n">get_panstarrs_data</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ra</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dec</span><span class="p">)</span>
            <span class="n">optical_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">genfromtxt</span><span class="p">(</span><span class="n">file_name</span> <span class="o">+</span> <span class="s1">'.csv'</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">optical_data</span><span class="p">)</span> <span class="o">==</span> <span class="mf">0.0</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">'Optical data is outside the range of PANSTARRS 3-pi survey.</span><span class="se">\</span>
<span class="s1">                                 Please check the input coordinates!!!'</span><span class="p">)</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

        <span class="c1">#Obtaining the GAIA data for the given field</span>

        <span class="n">file_name</span> <span class="o">=</span> <span class="s1">'GAIA'</span> <span class="o">+</span> <span class="s1">'_'</span> <span class="o">+</span> <span class="s1">'ra'</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ra_name</span><span class="p">)</span> <span class="o">+</span> <span class="s1">'DEC'</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">dec_name</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">gaia_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">genfromtxt</span><span class="p">(</span><span class="n">file_name</span> <span class="o">+</span> <span class="s1">'.csv'</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">FileNotFoundError</span><span class="p">:</span>
            <span class="n">gd</span><span class="o">.</span><span class="n">get_gaia_data</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ra</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dec</span><span class="p">)</span>
            <span class="n">gaia_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">genfromtxt</span><span class="p">(</span><span class="n">file_name</span> <span class="o">+</span> <span class="s1">'.csv'</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">gaia_data</span><span class="p">)</span> <span class="o">==</span> <span class="mf">0.0</span><span class="p">:</span>
                <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s1">'GAIA data not available for this field!!!</span><span class="se">\</span>
<span class="s1">                                The generated catalog will contain -999</span><span class="se">\</span>
<span class="s1">                                    values for GAIA information.'</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
</details>
<div class="doc doc-children">
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="irgsctool.irgsc.__init__">
<code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">ra</span><span class="p">,</span> <span class="n">dec</span><span class="p">,</span> <span class="n">validate</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>
</h3>
<div class="doc doc-contents">
<p>This method described using input  ra and dec.
It checks whther the data from PANSTARRS DR2, UKISS DR11 and
Gaia DR3 can be obtained.</p>
<p><strong>Raises:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<code>ValueError</code>
</td>
<td><p>if the data is not available in UKIDSS or
        PANSTARRS 3-pi survey. The code will not                             proceed further.</p></td>
</tr>
<tr>
<td>
<code>Warning</code>
</td>
<td><p>if the data is not available in the Gaia DR3                        survey. In the IRGSC, the Gaia values will                            be replaces with -999.</p></td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>irgsctool/__init__.py</code></summary>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ra</span><span class="p">,</span> <span class="n">dec</span><span class="p">,</span> <span class="n">validate</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    This method described using input  ra and dec.</span>
<span class="sd">    It checks whther the data from PANSTARRS DR2, UKISS DR11 and</span>
<span class="sd">    Gaia DR3 can be obtained.</span>
<span class="sd">    Raises:</span>
<span class="sd">        ValueError: if the data is not available in UKIDSS or</span>
<span class="sd">                    PANSTARRS 3-pi survey. The code will not\</span>
<span class="sd">                         proceed further.</span>
<span class="sd">        Warning: if the data is not available in the Gaia DR3\</span>
<span class="sd">                    survey. In the IRGSC, the Gaia values will\</span>
<span class="sd">                        be replaces with -999.</span>

<span class="sd">    """</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">''</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">'##################################################'</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">'Checking the input coordinates'</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">''</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">'##################################################'</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">''</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">ra</span> <span class="o">=</span> <span class="n">ra</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">dec</span> <span class="o">=</span> <span class="n">dec</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">validate</span><span class="o">=</span><span class="n">validate</span>
    <span class="n">gd</span> <span class="o">=</span> <span class="n">GetData</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ra</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dec</span><span class="p">)</span>
    <span class="n">rd</span> <span class="o">=</span> <span class="n">ReadData</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ra</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dec</span><span class="p">)</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ra</span> <span class="o">&lt;</span> <span class="mf">0.0</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">dec</span><span class="o">&lt;-</span><span class="mf">30.0</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">'Please check the input coordinates'</span><span class="p">)</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

    <span class="n">ra_name</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ra</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">'.'</span><span class="p">,</span><span class="s1">'_'</span><span class="p">)</span>
    <span class="n">dec_name</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dec</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">'.'</span><span class="p">,</span> <span class="s1">'_'</span><span class="p">)</span>


    <span class="c1">#Checking whether UKIDSS data is available for the given field.</span>
    <span class="c1">###If yes then obtaining it.</span>

    <span class="n">file_name</span> <span class="o">=</span> <span class="s1">'UKIDSS'</span><span class="o">+</span><span class="s1">'_'</span><span class="o">+</span><span class="s1">'ra'</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ra_name</span><span class="p">)</span><span class="o">+</span><span class="s1">'DEC'</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">dec_name</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">validating_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">genfromtxt</span><span class="p">(</span><span class="n">file_name</span><span class="o">+</span><span class="s1">'.csv'</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">FileNotFoundError</span><span class="p">:</span>
        <span class="n">gd</span><span class="o">.</span><span class="n">get_ukidss_data</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ra</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dec</span><span class="p">)</span>
        <span class="n">validating_data</span> <span class="o">=</span> <span class="n">rd</span><span class="o">.</span><span class="n">read_nir_data</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ra</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dec</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">validate</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">validating_data</span><span class="p">)</span> <span class="o">==</span> <span class="mf">0.0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">validate</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">'UKIDSS Observed NIR data not available.</span><span class="se">\</span>
<span class="s1">                             Validation of the generated IRGSC is not</span><span class="se">\</span>
<span class="s1">                             possible for this field!!!'</span><span class="p">)</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

    <span class="c1">###Obtaining the PANSTARRS data for the given field.</span>

    <span class="n">file_name</span> <span class="o">=</span><span class="s1">'PS1'</span><span class="o">+</span><span class="s1">'_'</span><span class="o">+</span><span class="s1">'ra'</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ra_name</span><span class="p">)</span><span class="o">+</span><span class="s1">'DEC'</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">dec_name</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">optical_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">genfromtxt</span><span class="p">(</span><span class="n">file_name</span> <span class="o">+</span> <span class="s1">'.csv'</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">FileNotFoundError</span><span class="p">:</span>
        <span class="n">gd</span><span class="o">.</span><span class="n">get_panstarrs_data</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ra</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dec</span><span class="p">)</span>
        <span class="n">optical_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">genfromtxt</span><span class="p">(</span><span class="n">file_name</span> <span class="o">+</span> <span class="s1">'.csv'</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">optical_data</span><span class="p">)</span> <span class="o">==</span> <span class="mf">0.0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">'Optical data is outside the range of PANSTARRS 3-pi survey.</span><span class="se">\</span>
<span class="s1">                             Please check the input coordinates!!!'</span><span class="p">)</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

    <span class="c1">#Obtaining the GAIA data for the given field</span>

    <span class="n">file_name</span> <span class="o">=</span> <span class="s1">'GAIA'</span> <span class="o">+</span> <span class="s1">'_'</span> <span class="o">+</span> <span class="s1">'ra'</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ra_name</span><span class="p">)</span> <span class="o">+</span> <span class="s1">'DEC'</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">dec_name</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">gaia_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">genfromtxt</span><span class="p">(</span><span class="n">file_name</span> <span class="o">+</span> <span class="s1">'.csv'</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">FileNotFoundError</span><span class="p">:</span>
        <span class="n">gd</span><span class="o">.</span><span class="n">get_gaia_data</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ra</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dec</span><span class="p">)</span>
        <span class="n">gaia_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">genfromtxt</span><span class="p">(</span><span class="n">file_name</span> <span class="o">+</span> <span class="s1">'.csv'</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">gaia_data</span><span class="p">)</span> <span class="o">==</span> <span class="mf">0.0</span><span class="p">:</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s1">'GAIA data not available for this field!!!</span><span class="se">\</span>
<span class="s1">                            The generated catalog will contain -999</span><span class="se">\</span>
<span class="s1">                                values for GAIA information.'</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="doc doc-object doc-module">
<a id="irgsctool._get_data"></a>
<div class="doc doc-contents first">
<div class="doc doc-children">
<div class="doc doc-object doc-class">
<h2 class="doc doc-heading" id="irgsctool._get_data.GetData">
<code>GetData</code>
</h2>
<div class="doc doc-contents">
<p><justify> <strong><em> GetData class </em></strong> contains methods to obtain 
PANSTARRS DR2 stacked optical photometry
data, UKIDSS NIR observed data and GAIA DR3 astrometry data.
The default search radius is 0.25 degrees due to the
limitation of pyvo.
The data retrieved is stored in .csv format with the name
of the survey + str(ra) + str(dec) </justify></p>
<p><strong>Examples:</strong></p>
<div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">irgsctool</span><span class="o">.</span><span class="n">GetData</span><span class="o">.</span><span class="n">get_panstarrs_data</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">)</span>
<span class="go">'PS1_RA_0_0_DEC_0_0.csv'</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">irgsctool</span><span class="o">.</span><span class="n">GetData</span><span class="o">.</span><span class="n">get_gaia_data</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">)</span>
<span class="go">'GAIA_RA_0_0_DEC_0_0.csv'</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">irgsctool</span><span class="o">.</span><span class="n">GetData</span><span class="o">.</span><span class="n">get_ukidss_data</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">)</span>
<span class="go">'UKIDSS_RA_0_0_DEC_0_0.csv'</span>
</code></pre></div>
<details class="quote">
<summary>Source code in <code>irgsctool/_get_data.py</code></summary>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 10</span>
<span class="normal"> 11</span>
<span class="normal"> 12</span>
<span class="normal"> 13</span>
<span class="normal"> 14</span>
<span class="normal"> 15</span>
<span class="normal"> 16</span>
<span class="normal"> 17</span>
<span class="normal"> 18</span>
<span class="normal"> 19</span>
<span class="normal"> 20</span>
<span class="normal"> 21</span>
<span class="normal"> 22</span>
<span class="normal"> 23</span>
<span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">GetData</span><span class="p">():</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    &lt;justify&gt; *** GetData class *** contains methods to obtain </span>
<span class="sd">    PANSTARRS DR2 stacked optical photometry</span>
<span class="sd">    data, UKIDSS NIR observed data and GAIA DR3 astrometry data.</span>
<span class="sd">    The default search radius is 0.25 degrees due to the</span>
<span class="sd">    limitation of pyvo.</span>
<span class="sd">    The data retrieved is stored in .csv format with the name</span>
<span class="sd">    of the survey + str(ra) + str(dec) &lt;/justify&gt;</span>

<span class="sd">    Examples:</span>
<span class="sd">            &gt;&gt;&gt; irgsctool.GetData.get_panstarrs_data(0.0,0.0)</span>
<span class="sd">            'PS1_RA_0_0_DEC_0_0.csv'</span>
<span class="sd">            &gt;&gt;&gt; irgsctool.GetData.get_gaia_data(0.0,0.0)</span>
<span class="sd">            'GAIA_RA_0_0_DEC_0_0.csv'</span>
<span class="sd">            &gt;&gt;&gt; irgsctool.GetData.get_ukidss_data(0.0,0.0)</span>
<span class="sd">            'UKIDSS_RA_0_0_DEC_0_0.csv'</span>

<span class="sd">    """</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ra</span><span class="p">,</span> <span class="n">dec</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ra</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dec</span> <span class="o">=</span> <span class="n">ra</span><span class="p">,</span> <span class="n">dec</span>

    <span class="k">def</span> <span class="nf">get_panstarrs_data</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""</span>
<span class="sd">        `irgsctool.GetData.get_panstarrs_data()`</span>

<span class="sd">        &lt;justify&gt; This function sends a query to obtain the PANSTARRS </span>
<span class="sd">        data from DR2 database.</span>
<span class="sd">        The query uses pyvo TAPService module for retrieving the data.</span>
<span class="sd">        The data is selected from StackObjectView db and the maximum</span>
<span class="sd">        search radius is 0.25 degrees.&lt;/justify&gt;</span>
<span class="sd">        Raises:</span>
<span class="sd">                ValueError if there is no observed PANSTARRS DR2 data for the</span>
<span class="sd">                            given set of input coordinates.</span>
<span class="sd">        """</span>
        <span class="n">ra_name</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ra</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">'.'</span><span class="p">,</span><span class="s1">'_'</span><span class="p">)</span>
        <span class="n">dec_name</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dec</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">'.'</span><span class="p">,</span> <span class="s1">'_'</span><span class="p">)</span>
        <span class="n">file_name</span> <span class="o">=</span> <span class="s1">'PS1'</span><span class="o">+</span><span class="s1">'_'</span><span class="o">+</span><span class="s1">'RA'</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ra_name</span><span class="p">)</span><span class="o">+</span><span class="s1">'DEC'</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">dec_name</span><span class="p">)</span><span class="o">+</span><span class="s1">'.csv'</span>
        <span class="n">Tap_Service</span> <span class="o">=</span> <span class="n">vo</span><span class="o">.</span><span class="n">dal</span><span class="o">.</span><span class="n">TAPService</span><span class="p">(</span><span class="s2">"https://vao.stsci.edu/PS1DR2/tapservice.aspx"</span><span class="p">)</span>
        <span class="c1">#Tap_service.describe()</span>
        <span class="n">Tap_Tables</span> <span class="o">=</span> <span class="n">Tap_Service</span><span class="o">.</span><span class="n">tables</span>
        <span class="c1">#for tablename in Tap_Tables.keys():</span>
            <span class="c1">#if not "TAP_schema" in tablename:  </span>
                <span class="c1">#Tap_Tables[tablename].describe()</span>
                <span class="c1">#print("Columns={}".format(sorted([k.name for k in\</span>
                <span class="c1">#                                  Tap_Tables[tablename].columns ])))</span>
                <span class="c1">#print("----")</span>
        <span class="n">query</span> <span class="o">=</span> <span class="s2">"""</span>
<span class="s2">            SELECT objID, RAMean, RAMeanErr, DecMean, DecMeanErr, gPSFMag, gPSFMagErr, gKronMag, gKronMagErr, rPSFMag, rPSFMagErr, rKronMag, rKronMagErr, iPSFMag, iPSFMagErr, iKronMag, iKronMagErr, zPSFMag, zPSFMagErr, zKronMag, zKronMagErr, yPSFMag, yPSFMagErr, yKronMag, yKronMagErr, objInfoFlag, qualityFlag, nDetections, nStackDetections, ginfoFlag, ginfoFlag2, ginfoFlag3, rinfoFlag, rinfoFlag2, rinfoFlag3, iinfoFlag, iinfoFlag2, iinfoFlag3, zinfoFlag, zinfoFlag2, zinfoFlag3, yinfoFlag, yinfoFlag2, yinfoFlag3</span>
<span class="s2">            FROM dbo.StackObjectView</span>
<span class="s2">            WHERE </span>
<span class="s2">            CONTAINS(POINT('ICRS', RAMean, DecMean),CIRCLE('ICRS',</span><span class="si">{}</span><span class="s2">,</span><span class="si">{}</span><span class="s2">,</span><span class="si">{}</span><span class="s2">))=1</span>
<span class="s2">                """</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ra</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">dec</span><span class="p">,</span><span class="mf">0.25</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">job</span> <span class="o">=</span> <span class="n">Tap_Service</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>
            <span class="n">Tap_Results</span> <span class="o">=</span> <span class="n">job</span><span class="o">.</span><span class="n">to_table</span><span class="p">()</span>
            <span class="n">np</span><span class="o">.</span><span class="n">savetxt</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">file_name</span><span class="p">),</span>\
                <span class="n">Tap_Results</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="s1">','</span><span class="p">,</span> <span class="n">header</span> <span class="o">=</span> <span class="s1">'objid, RAMean, RAMeanErr, DecMean, DecMeanErr, gPSFMag, gPSFMagErr, gKronMag, gKronMagErr, rPSFMag, rPSFMagErr, rKronMag, rKronMagErr, iPSFMag, iPSFMagErr, iKronMag, iKronMagErr, zPSFMag, zPSFMagErr, zKronMag, zKronMagErr, yPSFMag, yPSFMagErr, yKronMag, yKronMagErr, objInfoFlag, qualityFlag, nDetections, nStackDetections, ginfoFlag, ginfoFlag2, ginfoFlag3, rinfoFlag, rinfoFlag2, rinfoFlag3, iinfoFlag, iinfoFlag2, iinfoFlag3, zinfoFlag, zinfoFlag2,zinfoFlag3, yinfoFlag, yinfoFlag2, yinfoFlag3'</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">'This field is outside the sky coverage of PANSTARRS'</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">Tap_Results</span>

    <span class="k">def</span> <span class="nf">get_gaia_data</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""</span>
<span class="sd">        `irgsctool.GetData.get_gaia_data()`</span>

<span class="sd">        &lt;justify&gt; This function sends a query to obtain GAIA DR3 data</span>
<span class="sd">        using the astroquery module.</span>
<span class="sd">        The ROW_LIMIT is set to -1 which implies that the query retriees all</span>
<span class="sd">        the rows in the given field.&lt;/justify&gt;</span>
<span class="sd">        Raises:</span>
<span class="sd">                ValueError if there is no observed GAIA DR3 data for the</span>
<span class="sd">                            given set of input coordinates.</span>
<span class="sd">        """</span>
        <span class="n">ra_name</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ra</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">'.'</span><span class="p">,</span><span class="s1">'_'</span><span class="p">)</span>
        <span class="n">dec_name</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dec</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">'.'</span><span class="p">,</span> <span class="s1">'_'</span><span class="p">)</span>
        <span class="n">file_name</span> <span class="o">=</span> <span class="s1">'GAIA'</span> <span class="o">+</span> <span class="s1">'_'</span> <span class="o">+</span> <span class="s1">'RA'</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ra_name</span><span class="p">)</span>\
                    <span class="o">+</span> <span class="s1">'DEC'</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">dec_name</span><span class="p">)</span> <span class="o">+</span> <span class="s1">'.csv'</span>
        <span class="c1">#tables = Gaia.load_tables(only_names=True)</span>
        <span class="c1">#for table in (tables):</span>
            <span class="c1">#print (table.get_qualified_name())</span>
        <span class="n">coord</span> <span class="o">=</span> <span class="n">SkyCoord</span><span class="p">(</span><span class="n">ra</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ra</span><span class="p">,</span> <span class="n">dec</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dec</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">degree</span><span class="p">,</span> <span class="n">u</span><span class="o">.</span><span class="n">degree</span><span class="p">),</span> <span class="n">frame</span><span class="o">=</span><span class="s1">'icrs'</span><span class="p">)</span>
        <span class="n">Gaia</span><span class="o">.</span><span class="n">MAIN_GAIA_TABLE</span> <span class="o">=</span> <span class="s2">"gaiadr3.gaia_source"</span>
        <span class="n">Gaia</span><span class="o">.</span><span class="n">ROW_LIMIT</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">job</span><span class="o">=</span><span class="n">Gaia</span><span class="o">.</span><span class="n">cone_search</span><span class="p">(</span><span class="n">coordinate</span><span class="o">=</span><span class="n">coord</span><span class="p">,</span> <span class="n">radius</span><span class="o">=</span><span class="n">u</span><span class="o">.</span><span class="n">Quantity</span><span class="p">(</span><span class="mf">0.25</span><span class="p">,</span> <span class="n">u</span><span class="o">.</span><span class="n">deg</span><span class="p">),</span>\
                        <span class="n">table_name</span><span class="o">=</span><span class="s2">"gaiadr3.gaia_source"</span><span class="p">,</span>\
                        <span class="n">output_file</span><span class="o">=</span><span class="n">file_name</span><span class="p">,</span> <span class="n">output_format</span><span class="o">=</span><span class="s1">'csv'</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>\
                            <span class="n">dump_to_file</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">'source_id'</span><span class="p">,</span><span class="s1">'ra'</span><span class="p">,</span> <span class="s1">'ra_error'</span><span class="p">,</span><span class="s1">'dec'</span><span class="p">,</span>\
                                                        <span class="s1">'dec_error'</span><span class="p">,</span> <span class="s1">'parallax'</span><span class="p">,</span> <span class="s1">'parallax_error'</span><span class="p">,</span>\
                                                        <span class="s1">'pm'</span><span class="p">,</span> <span class="s1">'pmra'</span><span class="p">,</span> <span class="s1">'pmra_error'</span><span class="p">,</span> <span class="s1">'pmdec'</span><span class="p">,</span>\
                                                        <span class="s1">'pmdec_error'</span><span class="p">,</span> <span class="s1">'ruwe'</span><span class="p">])</span>
        <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">'No Gaia observations for this field'</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">job</span><span class="o">.</span><span class="n">get_results</span><span class="p">()</span>


    <span class="k">def</span> <span class="nf">get_ukidss_data</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""</span>
<span class="sd">        `irgsctool.GetData.get_ukidss_data()`</span>

<span class="sd">        &lt;justify&gt; This function sends a query to obtain UKIDSS DR11</span>
<span class="sd">        NIR data using astroquery.</span>
<span class="sd">        UKIDSS consists of five sub-surveys viz. UDS, GPS, GCS,</span>
<span class="sd">        DXS and LAS. The query loops over this surveys and retrieves</span>
<span class="sd">        the data for the given coordinates.</span>
<span class="sd">        The surveys which do not contain J and H band data,</span>
<span class="sd">        the function sends an alert. &lt;\justify&gt;</span>
<span class="sd">        Raises:</span>
<span class="sd">                ValueError if there is no observed UKIDSS data for the</span>
<span class="sd">                            given set of input coordinates.</span>


<span class="sd">        """</span>
        <span class="n">catalogs</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'UDS'</span><span class="p">,</span> <span class="s1">'GCS'</span><span class="p">,</span> <span class="s1">'GPS'</span><span class="p">,</span> <span class="s1">'DXS'</span><span class="p">,</span> <span class="s1">'LAS'</span><span class="p">]</span>
        <span class="n">ra_name</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ra</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">'.'</span><span class="p">,</span><span class="s1">'_'</span><span class="p">)</span>
        <span class="n">dec_name</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dec</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">'.'</span><span class="p">,</span> <span class="s1">'_'</span><span class="p">)</span>
        <span class="n">file_name</span> <span class="o">=</span> <span class="s1">'UKIDSS'</span> <span class="o">+</span> <span class="s1">'_'</span> <span class="o">+</span> <span class="s1">'RA'</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ra_name</span><span class="p">)</span>\
                    <span class="o">+</span> <span class="s1">'DEC'</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">dec_name</span><span class="p">)</span> <span class="o">+</span> <span class="s1">'.csv'</span>
        <span class="n">Ukidss</span><span class="o">.</span><span class="n">filters</span> <span class="o">=</span> <span class="p">{</span><span class="s1">'H'</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span><span class="s1">'J'</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">'K'</span><span class="p">:</span> <span class="mi">5</span><span class="p">}</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">catalogs</span><span class="p">)):</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">''</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">'Name of the catalog:'</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">catalogs</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">table</span> <span class="o">=</span> <span class="n">Ukidss</span><span class="o">.</span><span class="n">query_region</span><span class="p">(</span><span class="n">SkyCoord</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ra</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dec</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">deg</span><span class="p">,</span> <span class="n">u</span><span class="o">.</span><span class="n">deg</span><span class="p">),</span> <span class="n">frame</span><span class="o">=</span><span class="s1">'icrs'</span><span class="p">),</span>\
                            <span class="n">radius</span> <span class="o">=</span> <span class="mf">0.25</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">deg</span><span class="p">,</span> <span class="n">programme_id</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">catalogs</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span>\
                                <span class="n">database</span><span class="o">=</span><span class="s1">'UKIDSSDR11PLUS'</span><span class="p">,</span> <span class="n">attributes</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'ra'</span><span class="p">,</span> <span class="s1">'dec'</span><span class="p">,</span> <span class="s1">'jPetroMag'</span><span class="p">,</span> <span class="s1">'jPetroMagErr'</span><span class="p">,</span> <span class="s1">'hPetroMag'</span><span class="p">,</span> <span class="s1">'hPetroMagErr'</span><span class="p">,</span> <span class="s1">'kPetroMag'</span><span class="p">,</span> <span class="s1">'kPetroMagErr'</span><span class="p">],</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

                <span class="n">table</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">file_name</span><span class="p">,</span> <span class="nb">format</span> <span class="o">=</span> <span class="s1">'csv'</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">'No observations in'</span><span class="o">+</span><span class="s1">' '</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">catalogs</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">+</span><span class="s1">' '</span> <span class="o">+</span> <span class="s1">'catalog of UKIDSS'</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">table</span>
</code></pre></div></td></tr></table></div>
</details>
<div class="doc doc-children">
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="irgsctool._get_data.GetData.get_gaia_data">
<code class="highlight language-python"><span class="n">get_gaia_data</span><span class="p">()</span></code>
</h3>
<div class="doc doc-contents">
<p><code>irgsctool.GetData.get_gaia_data()</code></p>
<p><justify> This function sends a query to obtain GAIA DR3 data
using the astroquery module.
The ROW_LIMIT is set to -1 which implies that the query retriees all
the rows in the given field.</justify></p>
<details class="quote">
<summary>Source code in <code>irgsctool/_get_data.py</code></summary>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_gaia_data</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    `irgsctool.GetData.get_gaia_data()`</span>

<span class="sd">    &lt;justify&gt; This function sends a query to obtain GAIA DR3 data</span>
<span class="sd">    using the astroquery module.</span>
<span class="sd">    The ROW_LIMIT is set to -1 which implies that the query retriees all</span>
<span class="sd">    the rows in the given field.&lt;/justify&gt;</span>
<span class="sd">    Raises:</span>
<span class="sd">            ValueError if there is no observed GAIA DR3 data for the</span>
<span class="sd">                        given set of input coordinates.</span>
<span class="sd">    """</span>
    <span class="n">ra_name</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ra</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">'.'</span><span class="p">,</span><span class="s1">'_'</span><span class="p">)</span>
    <span class="n">dec_name</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dec</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">'.'</span><span class="p">,</span> <span class="s1">'_'</span><span class="p">)</span>
    <span class="n">file_name</span> <span class="o">=</span> <span class="s1">'GAIA'</span> <span class="o">+</span> <span class="s1">'_'</span> <span class="o">+</span> <span class="s1">'RA'</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ra_name</span><span class="p">)</span>\
                <span class="o">+</span> <span class="s1">'DEC'</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">dec_name</span><span class="p">)</span> <span class="o">+</span> <span class="s1">'.csv'</span>
    <span class="c1">#tables = Gaia.load_tables(only_names=True)</span>
    <span class="c1">#for table in (tables):</span>
        <span class="c1">#print (table.get_qualified_name())</span>
    <span class="n">coord</span> <span class="o">=</span> <span class="n">SkyCoord</span><span class="p">(</span><span class="n">ra</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ra</span><span class="p">,</span> <span class="n">dec</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dec</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">degree</span><span class="p">,</span> <span class="n">u</span><span class="o">.</span><span class="n">degree</span><span class="p">),</span> <span class="n">frame</span><span class="o">=</span><span class="s1">'icrs'</span><span class="p">)</span>
    <span class="n">Gaia</span><span class="o">.</span><span class="n">MAIN_GAIA_TABLE</span> <span class="o">=</span> <span class="s2">"gaiadr3.gaia_source"</span>
    <span class="n">Gaia</span><span class="o">.</span><span class="n">ROW_LIMIT</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">job</span><span class="o">=</span><span class="n">Gaia</span><span class="o">.</span><span class="n">cone_search</span><span class="p">(</span><span class="n">coordinate</span><span class="o">=</span><span class="n">coord</span><span class="p">,</span> <span class="n">radius</span><span class="o">=</span><span class="n">u</span><span class="o">.</span><span class="n">Quantity</span><span class="p">(</span><span class="mf">0.25</span><span class="p">,</span> <span class="n">u</span><span class="o">.</span><span class="n">deg</span><span class="p">),</span>\
                    <span class="n">table_name</span><span class="o">=</span><span class="s2">"gaiadr3.gaia_source"</span><span class="p">,</span>\
                    <span class="n">output_file</span><span class="o">=</span><span class="n">file_name</span><span class="p">,</span> <span class="n">output_format</span><span class="o">=</span><span class="s1">'csv'</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>\
                        <span class="n">dump_to_file</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">'source_id'</span><span class="p">,</span><span class="s1">'ra'</span><span class="p">,</span> <span class="s1">'ra_error'</span><span class="p">,</span><span class="s1">'dec'</span><span class="p">,</span>\
                                                    <span class="s1">'dec_error'</span><span class="p">,</span> <span class="s1">'parallax'</span><span class="p">,</span> <span class="s1">'parallax_error'</span><span class="p">,</span>\
                                                    <span class="s1">'pm'</span><span class="p">,</span> <span class="s1">'pmra'</span><span class="p">,</span> <span class="s1">'pmra_error'</span><span class="p">,</span> <span class="s1">'pmdec'</span><span class="p">,</span>\
                                                    <span class="s1">'pmdec_error'</span><span class="p">,</span> <span class="s1">'ruwe'</span><span class="p">])</span>
    <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">'No Gaia observations for this field'</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">job</span><span class="o">.</span><span class="n">get_results</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="irgsctool._get_data.GetData.get_panstarrs_data">
<code class="highlight language-python"><span class="n">get_panstarrs_data</span><span class="p">()</span></code>
</h3>
<div class="doc doc-contents">
<p><code>irgsctool.GetData.get_panstarrs_data()</code></p>
<p><justify> This function sends a query to obtain the PANSTARRS 
data from DR2 database.
The query uses pyvo TAPService module for retrieving the data.
The data is selected from StackObjectView db and the maximum
search radius is 0.25 degrees.</justify></p>
<details class="quote">
<summary>Source code in <code>irgsctool/_get_data.py</code></summary>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_panstarrs_data</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    `irgsctool.GetData.get_panstarrs_data()`</span>

<span class="sd">    &lt;justify&gt; This function sends a query to obtain the PANSTARRS </span>
<span class="sd">    data from DR2 database.</span>
<span class="sd">    The query uses pyvo TAPService module for retrieving the data.</span>
<span class="sd">    The data is selected from StackObjectView db and the maximum</span>
<span class="sd">    search radius is 0.25 degrees.&lt;/justify&gt;</span>
<span class="sd">    Raises:</span>
<span class="sd">            ValueError if there is no observed PANSTARRS DR2 data for the</span>
<span class="sd">                        given set of input coordinates.</span>
<span class="sd">    """</span>
    <span class="n">ra_name</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ra</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">'.'</span><span class="p">,</span><span class="s1">'_'</span><span class="p">)</span>
    <span class="n">dec_name</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dec</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">'.'</span><span class="p">,</span> <span class="s1">'_'</span><span class="p">)</span>
    <span class="n">file_name</span> <span class="o">=</span> <span class="s1">'PS1'</span><span class="o">+</span><span class="s1">'_'</span><span class="o">+</span><span class="s1">'RA'</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ra_name</span><span class="p">)</span><span class="o">+</span><span class="s1">'DEC'</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">dec_name</span><span class="p">)</span><span class="o">+</span><span class="s1">'.csv'</span>
    <span class="n">Tap_Service</span> <span class="o">=</span> <span class="n">vo</span><span class="o">.</span><span class="n">dal</span><span class="o">.</span><span class="n">TAPService</span><span class="p">(</span><span class="s2">"https://vao.stsci.edu/PS1DR2/tapservice.aspx"</span><span class="p">)</span>
    <span class="c1">#Tap_service.describe()</span>
    <span class="n">Tap_Tables</span> <span class="o">=</span> <span class="n">Tap_Service</span><span class="o">.</span><span class="n">tables</span>
    <span class="c1">#for tablename in Tap_Tables.keys():</span>
        <span class="c1">#if not "TAP_schema" in tablename:  </span>
            <span class="c1">#Tap_Tables[tablename].describe()</span>
            <span class="c1">#print("Columns={}".format(sorted([k.name for k in\</span>
            <span class="c1">#                                  Tap_Tables[tablename].columns ])))</span>
            <span class="c1">#print("----")</span>
    <span class="n">query</span> <span class="o">=</span> <span class="s2">"""</span>
<span class="s2">        SELECT objID, RAMean, RAMeanErr, DecMean, DecMeanErr, gPSFMag, gPSFMagErr, gKronMag, gKronMagErr, rPSFMag, rPSFMagErr, rKronMag, rKronMagErr, iPSFMag, iPSFMagErr, iKronMag, iKronMagErr, zPSFMag, zPSFMagErr, zKronMag, zKronMagErr, yPSFMag, yPSFMagErr, yKronMag, yKronMagErr, objInfoFlag, qualityFlag, nDetections, nStackDetections, ginfoFlag, ginfoFlag2, ginfoFlag3, rinfoFlag, rinfoFlag2, rinfoFlag3, iinfoFlag, iinfoFlag2, iinfoFlag3, zinfoFlag, zinfoFlag2, zinfoFlag3, yinfoFlag, yinfoFlag2, yinfoFlag3</span>
<span class="s2">        FROM dbo.StackObjectView</span>
<span class="s2">        WHERE </span>
<span class="s2">        CONTAINS(POINT('ICRS', RAMean, DecMean),CIRCLE('ICRS',</span><span class="si">{}</span><span class="s2">,</span><span class="si">{}</span><span class="s2">,</span><span class="si">{}</span><span class="s2">))=1</span>
<span class="s2">            """</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ra</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">dec</span><span class="p">,</span><span class="mf">0.25</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">job</span> <span class="o">=</span> <span class="n">Tap_Service</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>
        <span class="n">Tap_Results</span> <span class="o">=</span> <span class="n">job</span><span class="o">.</span><span class="n">to_table</span><span class="p">()</span>
        <span class="n">np</span><span class="o">.</span><span class="n">savetxt</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">file_name</span><span class="p">),</span>\
            <span class="n">Tap_Results</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="s1">','</span><span class="p">,</span> <span class="n">header</span> <span class="o">=</span> <span class="s1">'objid, RAMean, RAMeanErr, DecMean, DecMeanErr, gPSFMag, gPSFMagErr, gKronMag, gKronMagErr, rPSFMag, rPSFMagErr, rKronMag, rKronMagErr, iPSFMag, iPSFMagErr, iKronMag, iKronMagErr, zPSFMag, zPSFMagErr, zKronMag, zKronMagErr, yPSFMag, yPSFMagErr, yKronMag, yKronMagErr, objInfoFlag, qualityFlag, nDetections, nStackDetections, ginfoFlag, ginfoFlag2, ginfoFlag3, rinfoFlag, rinfoFlag2, rinfoFlag3, iinfoFlag, iinfoFlag2, iinfoFlag3, zinfoFlag, zinfoFlag2,zinfoFlag3, yinfoFlag, yinfoFlag2, yinfoFlag3'</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">'This field is outside the sky coverage of PANSTARRS'</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">Tap_Results</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="irgsctool._get_data.GetData.get_ukidss_data">
<code class="highlight language-python"><span class="n">get_ukidss_data</span><span class="p">()</span></code>
</h3>
<div class="doc doc-contents">
<p><code>irgsctool.GetData.get_ukidss_data()</code></p>
<p><justify> This function sends a query to obtain UKIDSS DR11
NIR data using astroquery.
UKIDSS consists of five sub-surveys viz. UDS, GPS, GCS,
DXS and LAS. The query loops over this surveys and retrieves
the data for the given coordinates.
The surveys which do not contain J and H band data,
the function sends an alert. &lt;\justify&gt;</justify></p>
<details class="quote">
<summary>Source code in <code>irgsctool/_get_data.py</code></summary>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_ukidss_data</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    `irgsctool.GetData.get_ukidss_data()`</span>

<span class="sd">    &lt;justify&gt; This function sends a query to obtain UKIDSS DR11</span>
<span class="sd">    NIR data using astroquery.</span>
<span class="sd">    UKIDSS consists of five sub-surveys viz. UDS, GPS, GCS,</span>
<span class="sd">    DXS and LAS. The query loops over this surveys and retrieves</span>
<span class="sd">    the data for the given coordinates.</span>
<span class="sd">    The surveys which do not contain J and H band data,</span>
<span class="sd">    the function sends an alert. &lt;\justify&gt;</span>
<span class="sd">    Raises:</span>
<span class="sd">            ValueError if there is no observed UKIDSS data for the</span>
<span class="sd">                        given set of input coordinates.</span>


<span class="sd">    """</span>
    <span class="n">catalogs</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'UDS'</span><span class="p">,</span> <span class="s1">'GCS'</span><span class="p">,</span> <span class="s1">'GPS'</span><span class="p">,</span> <span class="s1">'DXS'</span><span class="p">,</span> <span class="s1">'LAS'</span><span class="p">]</span>
    <span class="n">ra_name</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ra</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">'.'</span><span class="p">,</span><span class="s1">'_'</span><span class="p">)</span>
    <span class="n">dec_name</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dec</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">'.'</span><span class="p">,</span> <span class="s1">'_'</span><span class="p">)</span>
    <span class="n">file_name</span> <span class="o">=</span> <span class="s1">'UKIDSS'</span> <span class="o">+</span> <span class="s1">'_'</span> <span class="o">+</span> <span class="s1">'RA'</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ra_name</span><span class="p">)</span>\
                <span class="o">+</span> <span class="s1">'DEC'</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">dec_name</span><span class="p">)</span> <span class="o">+</span> <span class="s1">'.csv'</span>
    <span class="n">Ukidss</span><span class="o">.</span><span class="n">filters</span> <span class="o">=</span> <span class="p">{</span><span class="s1">'H'</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span><span class="s1">'J'</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">'K'</span><span class="p">:</span> <span class="mi">5</span><span class="p">}</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">catalogs</span><span class="p">)):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">''</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">'Name of the catalog:'</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">catalogs</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">table</span> <span class="o">=</span> <span class="n">Ukidss</span><span class="o">.</span><span class="n">query_region</span><span class="p">(</span><span class="n">SkyCoord</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ra</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dec</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">deg</span><span class="p">,</span> <span class="n">u</span><span class="o">.</span><span class="n">deg</span><span class="p">),</span> <span class="n">frame</span><span class="o">=</span><span class="s1">'icrs'</span><span class="p">),</span>\
                        <span class="n">radius</span> <span class="o">=</span> <span class="mf">0.25</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">deg</span><span class="p">,</span> <span class="n">programme_id</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">catalogs</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span>\
                            <span class="n">database</span><span class="o">=</span><span class="s1">'UKIDSSDR11PLUS'</span><span class="p">,</span> <span class="n">attributes</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'ra'</span><span class="p">,</span> <span class="s1">'dec'</span><span class="p">,</span> <span class="s1">'jPetroMag'</span><span class="p">,</span> <span class="s1">'jPetroMagErr'</span><span class="p">,</span> <span class="s1">'hPetroMag'</span><span class="p">,</span> <span class="s1">'hPetroMagErr'</span><span class="p">,</span> <span class="s1">'kPetroMag'</span><span class="p">,</span> <span class="s1">'kPetroMagErr'</span><span class="p">],</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

            <span class="n">table</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">file_name</span><span class="p">,</span> <span class="nb">format</span> <span class="o">=</span> <span class="s1">'csv'</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">'No observations in'</span><span class="o">+</span><span class="s1">' '</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">catalogs</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">+</span><span class="s1">' '</span> <span class="o">+</span> <span class="s1">'catalog of UKIDSS'</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">table</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="doc doc-object doc-module">
<a id="irgsctool._read_data"></a>
<div class="doc doc-contents first">
<div class="doc doc-children">
<div class="doc doc-object doc-class">
<h2 class="doc doc-heading" id="irgsctool._read_data.ReadData">
<code>ReadData</code>
</h2>
<div class="doc doc-contents">
<p><strong><em> ReadData </em></strong> class contains methods to read the photometric data from PS1 DR2,
GAIA DR3 and UKIDSS DR11.</p>
<details class="quote">
<summary>Source code in <code>irgsctool/_read_data.py</code></summary>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 19</span>
<span class="normal"> 20</span>
<span class="normal"> 21</span>
<span class="normal"> 22</span>
<span class="normal"> 23</span>
<span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span>
<span class="normal">548</span>
<span class="normal">549</span>
<span class="normal">550</span>
<span class="normal">551</span>
<span class="normal">552</span>
<span class="normal">553</span>
<span class="normal">554</span>
<span class="normal">555</span>
<span class="normal">556</span>
<span class="normal">557</span>
<span class="normal">558</span>
<span class="normal">559</span>
<span class="normal">560</span>
<span class="normal">561</span>
<span class="normal">562</span>
<span class="normal">563</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">ReadData</span><span class="p">():</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    *** ReadData *** class contains methods to read the photometric data from PS1 DR2,</span>
<span class="sd">    GAIA DR3 and UKIDSS DR11.</span>
<span class="sd">    """</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ra</span><span class="p">,</span> <span class="n">dec</span><span class="p">):</span>
         <span class="bp">self</span><span class="o">.</span><span class="n">ra</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dec</span> <span class="o">=</span> <span class="n">ra</span><span class="p">,</span> <span class="n">dec</span>
         <span class="bp">self</span><span class="o">.</span><span class="n">gd</span> <span class="o">=</span> <span class="n">GetData</span><span class="p">(</span><span class="n">ra</span><span class="p">,</span><span class="n">dec</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">read_optical_data</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""</span>
<span class="sd">            `irgsctool.ReadData.read_optical_data()`</span>
<span class="sd">            ------------------------------------------</span>

<span class="sd">            &lt;justify&gt; </span>
<span class="sd">            This function reads the input optical PANSTARRS data.</span>
<span class="sd">            The number of columns in the input file are 32.</span>
<span class="sd">            After reading the input data, this function filters it for</span>
<span class="sd">            nan values (if present) and restricts the data to the sources having</span>
<span class="sd">            detection in all the five bands and that have SNR atleast 5.</span>
<span class="sd">            This data is then fed to the Star-Galaxy classification routine to</span>
<span class="sd">            seperate stars and galaxies in the data. &lt;\justify&gt;</span>

<span class="sd">            Raises:</span>
<span class="sd">                FileNotFoundError: if the optical input data file is not available.</span>
<span class="sd">        """</span>
        <span class="n">ra_name</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ra</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">'.'</span><span class="p">,</span><span class="s1">'_'</span><span class="p">)</span>
        <span class="n">dec_name</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dec</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">'.'</span><span class="p">,</span> <span class="s1">'_'</span><span class="p">)</span>
        <span class="n">file_name</span> <span class="o">=</span> <span class="s1">'PS1'</span> <span class="o">+</span> <span class="s1">'_'</span> <span class="o">+</span> <span class="s1">'RA'</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ra_name</span><span class="p">)</span> <span class="o">+</span> <span class="s1">'DEC'</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">dec_name</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">ps1_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">genfromtxt</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">file_name</span><span class="p">)</span> <span class="o">+</span><span class="s1">'.csv'</span><span class="p">,</span>\
                                     <span class="n">delimiter</span><span class="o">=</span><span class="s1">','</span><span class="p">,</span> <span class="n">skip_header</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

        <span class="k">except</span> <span class="ne">FileNotFoundError</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">gd</span><span class="o">.</span><span class="n">get_panstarrs_data</span><span class="p">()</span>
            <span class="n">ps1_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">genfromtxt</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">file_name</span><span class="p">)</span> <span class="o">+</span><span class="s1">'.csv'</span><span class="p">,</span>\
                                     <span class="n">delimiter</span><span class="o">=</span><span class="s1">','</span><span class="p">,</span> <span class="n">skip_header</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">ps1_objid</span> <span class="o">=</span> <span class="n">ps1_data</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">ps_ra</span> <span class="o">=</span> <span class="n">ps1_data</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">err_ps_ra</span> <span class="o">=</span> <span class="n">ps1_data</span><span class="p">[:,</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">ps_dec</span> <span class="o">=</span> <span class="n">ps1_data</span><span class="p">[:,</span><span class="mi">3</span><span class="p">]</span>
        <span class="n">err_ps_dec</span> <span class="o">=</span> <span class="n">ps1_data</span><span class="p">[:,</span><span class="mi">4</span><span class="p">]</span>
        <span class="n">gmag</span> <span class="o">=</span> <span class="n">ps1_data</span><span class="p">[:,</span><span class="mi">5</span><span class="p">]</span>
        <span class="n">e_gmag</span> <span class="o">=</span> <span class="n">ps1_data</span><span class="p">[:,</span><span class="mi">6</span><span class="p">]</span>
        <span class="n">gkron</span> <span class="o">=</span> <span class="n">ps1_data</span><span class="p">[:,</span><span class="mi">7</span><span class="p">]</span>
        <span class="n">e_gkron</span> <span class="o">=</span> <span class="n">ps1_data</span><span class="p">[:,</span><span class="mi">8</span><span class="p">]</span>
        <span class="n">rmag</span> <span class="o">=</span> <span class="n">ps1_data</span><span class="p">[:,</span><span class="mi">9</span><span class="p">]</span>
        <span class="n">e_rmag</span> <span class="o">=</span> <span class="n">ps1_data</span><span class="p">[:,</span><span class="mi">10</span><span class="p">]</span>
        <span class="n">rkron</span> <span class="o">=</span> <span class="n">ps1_data</span><span class="p">[:,</span><span class="mi">11</span><span class="p">]</span>
        <span class="n">e_rkron</span> <span class="o">=</span> <span class="n">ps1_data</span><span class="p">[:,</span><span class="mi">12</span><span class="p">]</span>
        <span class="n">imag</span> <span class="o">=</span> <span class="n">ps1_data</span><span class="p">[:,</span><span class="mi">13</span><span class="p">]</span>
        <span class="n">e_imag</span> <span class="o">=</span> <span class="n">ps1_data</span><span class="p">[:,</span><span class="mi">14</span><span class="p">]</span>
        <span class="n">ikron</span> <span class="o">=</span> <span class="n">ps1_data</span><span class="p">[:,</span><span class="mi">15</span><span class="p">]</span>
        <span class="n">e_ikron</span> <span class="o">=</span> <span class="n">ps1_data</span><span class="p">[:,</span><span class="mi">16</span><span class="p">]</span>
        <span class="n">zmag</span> <span class="o">=</span> <span class="n">ps1_data</span><span class="p">[:,</span><span class="mi">17</span><span class="p">]</span>
        <span class="n">e_zmag</span> <span class="o">=</span> <span class="n">ps1_data</span><span class="p">[:,</span><span class="mi">18</span><span class="p">]</span>
        <span class="n">zkron</span> <span class="o">=</span> <span class="n">ps1_data</span><span class="p">[:,</span><span class="mi">19</span><span class="p">]</span>
        <span class="n">e_zkron</span> <span class="o">=</span> <span class="n">ps1_data</span><span class="p">[:,</span><span class="mi">20</span><span class="p">]</span>
        <span class="n">ymag</span> <span class="o">=</span> <span class="n">ps1_data</span><span class="p">[:,</span><span class="mi">21</span><span class="p">]</span>
        <span class="n">e_ymag</span> <span class="o">=</span> <span class="n">ps1_data</span><span class="p">[:,</span><span class="mi">22</span><span class="p">]</span>
        <span class="n">ykron</span> <span class="o">=</span> <span class="n">ps1_data</span><span class="p">[:,</span><span class="mi">23</span><span class="p">]</span>
        <span class="n">e_ykron</span> <span class="o">=</span> <span class="n">ps1_data</span><span class="p">[:,</span><span class="mi">24</span><span class="p">]</span>
        <span class="n">objinfoflag</span> <span class="o">=</span> <span class="n">ps1_data</span><span class="p">[:,</span><span class="mi">25</span><span class="p">]</span>
        <span class="n">qualityflag</span> <span class="o">=</span> <span class="n">ps1_data</span><span class="p">[:,</span><span class="mi">26</span><span class="p">]</span>
        <span class="n">ndetections</span> <span class="o">=</span> <span class="n">ps1_data</span><span class="p">[:,</span><span class="mi">27</span><span class="p">]</span>
        <span class="n">nstackdetections</span> <span class="o">=</span> <span class="n">ps1_data</span><span class="p">[:,</span><span class="mi">28</span><span class="p">]</span>
        <span class="n">ginfoflag</span> <span class="o">=</span> <span class="n">ps1_data</span><span class="p">[:,</span><span class="mi">29</span><span class="p">]</span>
        <span class="n">ginfoflag2</span> <span class="o">=</span> <span class="n">ps1_data</span><span class="p">[:,</span><span class="mi">30</span><span class="p">]</span>
        <span class="n">ginfoflag3</span> <span class="o">=</span> <span class="n">ps1_data</span><span class="p">[:,</span><span class="mi">31</span><span class="p">]</span>
        <span class="n">rinfoflag</span> <span class="o">=</span> <span class="n">ps1_data</span><span class="p">[:,</span><span class="mi">32</span><span class="p">]</span>
        <span class="n">rinfoflag2</span> <span class="o">=</span> <span class="n">ps1_data</span><span class="p">[:,</span><span class="mi">33</span><span class="p">]</span>
        <span class="n">rinfoflag3</span> <span class="o">=</span> <span class="n">ps1_data</span><span class="p">[:,</span><span class="mi">34</span><span class="p">]</span>
        <span class="n">iinfoflag</span> <span class="o">=</span> <span class="n">ps1_data</span><span class="p">[:,</span><span class="mi">35</span><span class="p">]</span>
        <span class="n">iinfoflag2</span> <span class="o">=</span> <span class="n">ps1_data</span><span class="p">[:,</span><span class="mi">36</span><span class="p">]</span>
        <span class="n">iinfoflag3</span> <span class="o">=</span> <span class="n">ps1_data</span><span class="p">[:,</span><span class="mi">37</span><span class="p">]</span>
        <span class="n">zinfoflag</span> <span class="o">=</span> <span class="n">ps1_data</span><span class="p">[:,</span><span class="mi">38</span><span class="p">]</span>
        <span class="n">zinfoflag2</span> <span class="o">=</span> <span class="n">ps1_data</span><span class="p">[:,</span><span class="mi">39</span><span class="p">]</span>
        <span class="n">zinfoflag3</span> <span class="o">=</span> <span class="n">ps1_data</span><span class="p">[:,</span><span class="mi">40</span><span class="p">]</span>
        <span class="n">yinfoflag</span> <span class="o">=</span> <span class="n">ps1_data</span><span class="p">[:,</span><span class="mi">41</span><span class="p">]</span>
        <span class="n">yinfoflag2</span> <span class="o">=</span> <span class="n">ps1_data</span><span class="p">[:,</span><span class="mi">42</span><span class="p">]</span>
        <span class="n">yinfoflag3</span> <span class="o">=</span> <span class="n">ps1_data</span><span class="p">[:,</span><span class="mi">43</span><span class="p">]</span>

        <span class="n">ps1_data</span> <span class="o">=</span> <span class="n">ps1_objid</span><span class="p">,</span> <span class="n">ps_ra</span><span class="p">,</span> <span class="n">err_ps_ra</span><span class="p">,</span> <span class="n">ps_dec</span><span class="p">,</span> <span class="n">err_ps_dec</span><span class="p">,</span> <span class="n">gmag</span><span class="p">,</span>\
            <span class="n">e_gmag</span><span class="p">,</span> <span class="n">gkron</span><span class="p">,</span> <span class="n">e_gkron</span><span class="p">,</span> <span class="n">rmag</span><span class="p">,</span> <span class="n">e_rmag</span><span class="p">,</span> <span class="n">rkron</span><span class="p">,</span> <span class="n">e_rkron</span><span class="p">,</span> <span class="n">imag</span><span class="p">,</span>\
            <span class="n">e_imag</span><span class="p">,</span> <span class="n">ikron</span><span class="p">,</span> <span class="n">e_ikron</span><span class="p">,</span> <span class="n">zmag</span><span class="p">,</span> <span class="n">e_zmag</span><span class="p">,</span> <span class="n">zkron</span><span class="p">,</span> <span class="n">e_zkron</span><span class="p">,</span> <span class="n">ymag</span><span class="p">,</span>\
            <span class="n">e_ymag</span><span class="p">,</span> <span class="n">ykron</span><span class="p">,</span> <span class="n">e_ykron</span><span class="p">,</span> <span class="n">objinfoflag</span><span class="p">,</span> <span class="n">qualityflag</span><span class="p">,</span> <span class="n">ndetections</span><span class="p">,</span>\
            <span class="n">nstackdetections</span><span class="p">,</span> <span class="n">ginfoflag</span><span class="p">,</span> <span class="n">ginfoflag2</span><span class="p">,</span> <span class="n">ginfoflag3</span><span class="p">,</span> <span class="n">rinfoflag</span><span class="p">,</span>\
            <span class="n">rinfoflag2</span><span class="p">,</span> <span class="n">rinfoflag3</span><span class="p">,</span> <span class="n">iinfoflag</span><span class="p">,</span> <span class="n">iinfoflag2</span><span class="p">,</span> <span class="n">iinfoflag3</span><span class="p">,</span>\
            <span class="n">zinfoflag</span><span class="p">,</span> <span class="n">zinfoflag2</span><span class="p">,</span> <span class="n">zinfoflag3</span><span class="p">,</span> <span class="n">yinfoflag</span><span class="p">,</span> <span class="n">yinfoflag2</span><span class="p">,</span>\
            <span class="n">yinfoflag3</span>

        <span class="nb">print</span><span class="p">(</span><span class="s1">'Number of rows in the PANSTARRS file:'</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">ps1_objid</span><span class="p">))</span>

        <span class="n">oid1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">ps1_objid</span><span class="p">))])[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">oid1</span> <span class="o">=</span> <span class="p">[</span><span class="o">*</span><span class="nb">set</span><span class="p">(</span><span class="n">ps1_objid</span><span class="p">)]</span>
        <span class="n">ptsf</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">oid1</span><span class="p">)):</span>
            <span class="n">ptsi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">oid1</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">==</span><span class="n">ps1_objid</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">ptsi</span><span class="p">)</span><span class="o">&gt;</span><span class="mf">1.0</span><span class="p">:</span>
                <span class="n">ptsi</span> <span class="o">=</span> <span class="n">ptsi</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">ptsf</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ptsf</span><span class="p">,</span> <span class="n">ptsi</span><span class="p">)</span>
                <span class="n">ptsf</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">int64</span><span class="p">(</span><span class="n">ptsf</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                 <span class="n">ptsf</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ptsf</span><span class="p">,</span> <span class="n">ptsi</span><span class="p">)</span>

        <span class="n">ps1_objid</span> <span class="o">=</span> <span class="n">ps1_objid</span><span class="p">[</span><span class="n">ptsf</span><span class="p">]</span>
        <span class="n">ps_ra</span> <span class="o">=</span> <span class="n">ps_ra</span><span class="p">[</span><span class="n">ptsf</span><span class="p">]</span>
        <span class="n">ps_dec</span> <span class="o">=</span> <span class="n">ps_dec</span><span class="p">[</span><span class="n">ptsf</span><span class="p">]</span>
        <span class="n">err_ps_ra</span> <span class="o">=</span> <span class="n">err_ps_ra</span><span class="p">[</span><span class="n">ptsf</span><span class="p">]</span>
        <span class="n">err_ps_dec</span> <span class="o">=</span> <span class="n">err_ps_dec</span><span class="p">[</span><span class="n">ptsf</span><span class="p">]</span>
        <span class="n">gmag</span> <span class="o">=</span> <span class="n">gmag</span><span class="p">[</span><span class="n">ptsf</span><span class="p">]</span>
        <span class="n">gkron</span> <span class="o">=</span> <span class="n">gkron</span><span class="p">[</span><span class="n">ptsf</span><span class="p">]</span>
        <span class="n">e_gmag</span> <span class="o">=</span> <span class="n">e_gmag</span><span class="p">[</span><span class="n">ptsf</span><span class="p">]</span>
        <span class="n">e_gkron</span> <span class="o">=</span> <span class="n">e_gkron</span><span class="p">[</span><span class="n">ptsf</span><span class="p">]</span>
        <span class="n">rmag</span> <span class="o">=</span> <span class="n">rmag</span><span class="p">[</span><span class="n">ptsf</span><span class="p">]</span>
        <span class="n">rkron</span> <span class="o">=</span> <span class="n">rkron</span><span class="p">[</span><span class="n">ptsf</span><span class="p">]</span>
        <span class="n">e_rmag</span> <span class="o">=</span> <span class="n">e_rmag</span><span class="p">[</span><span class="n">ptsf</span><span class="p">]</span>
        <span class="n">e_rkron</span> <span class="o">=</span> <span class="n">e_rkron</span><span class="p">[</span><span class="n">ptsf</span><span class="p">]</span>
        <span class="n">imag</span> <span class="o">=</span> <span class="n">imag</span><span class="p">[</span><span class="n">ptsf</span><span class="p">]</span>
        <span class="n">ikron</span> <span class="o">=</span> <span class="n">ikron</span><span class="p">[</span><span class="n">ptsf</span><span class="p">]</span>
        <span class="n">e_imag</span> <span class="o">=</span> <span class="n">e_imag</span><span class="p">[</span><span class="n">ptsf</span><span class="p">]</span>
        <span class="n">e_ikron</span> <span class="o">=</span> <span class="n">e_ikron</span><span class="p">[</span><span class="n">ptsf</span><span class="p">]</span>
        <span class="n">zmag</span> <span class="o">=</span> <span class="n">zmag</span><span class="p">[</span><span class="n">ptsf</span><span class="p">]</span>
        <span class="n">zkron</span> <span class="o">=</span> <span class="n">zkron</span><span class="p">[</span><span class="n">ptsf</span><span class="p">]</span>
        <span class="n">e_zmag</span> <span class="o">=</span> <span class="n">e_zmag</span><span class="p">[</span><span class="n">ptsf</span><span class="p">]</span>
        <span class="n">e_zkron</span> <span class="o">=</span> <span class="n">e_zkron</span><span class="p">[</span><span class="n">ptsf</span><span class="p">]</span>
        <span class="n">ymag</span> <span class="o">=</span> <span class="n">ymag</span><span class="p">[</span><span class="n">ptsf</span><span class="p">]</span>
        <span class="n">ykron</span> <span class="o">=</span> <span class="n">ykron</span><span class="p">[</span><span class="n">ptsf</span><span class="p">]</span>
        <span class="n">e_ymag</span> <span class="o">=</span> <span class="n">e_ymag</span><span class="p">[</span><span class="n">ptsf</span><span class="p">]</span>
        <span class="n">e_ykron</span> <span class="o">=</span> <span class="n">e_ykron</span><span class="p">[</span><span class="n">ptsf</span><span class="p">]</span>
        <span class="n">objinfoflag</span> <span class="o">=</span> <span class="n">objinfoflag</span><span class="p">[</span><span class="n">ptsf</span><span class="p">]</span>
        <span class="n">qualityflag</span> <span class="o">=</span> <span class="n">qualityflag</span><span class="p">[</span><span class="n">ptsf</span><span class="p">]</span>
        <span class="n">ndetections</span> <span class="o">=</span> <span class="n">ndetections</span><span class="p">[</span><span class="n">ptsf</span><span class="p">]</span>
        <span class="n">nstackdetections</span> <span class="o">=</span> <span class="n">nstackdetections</span><span class="p">[</span><span class="n">ptsf</span><span class="p">]</span>
        <span class="n">ginfoflag</span> <span class="o">=</span> <span class="n">ginfoflag</span><span class="p">[</span><span class="n">ptsf</span><span class="p">]</span>
        <span class="n">ginfoflag2</span> <span class="o">=</span> <span class="n">ginfoflag2</span><span class="p">[</span><span class="n">ptsf</span><span class="p">]</span>
        <span class="n">ginfoflag3</span> <span class="o">=</span> <span class="n">ginfoflag3</span><span class="p">[</span><span class="n">ptsf</span><span class="p">]</span>
        <span class="n">rinfoflag</span> <span class="o">=</span> <span class="n">rinfoflag</span><span class="p">[</span><span class="n">ptsf</span><span class="p">]</span>
        <span class="n">rinfoflag2</span> <span class="o">=</span> <span class="n">rinfoflag2</span><span class="p">[</span><span class="n">ptsf</span><span class="p">]</span>
        <span class="n">rinfoflag3</span> <span class="o">=</span> <span class="n">rinfoflag3</span><span class="p">[</span><span class="n">ptsf</span><span class="p">]</span>
        <span class="n">iinfoflag</span> <span class="o">=</span> <span class="n">iinfoflag</span><span class="p">[</span><span class="n">ptsf</span><span class="p">]</span>
        <span class="n">iinfoflag2</span> <span class="o">=</span> <span class="n">iinfoflag2</span><span class="p">[</span><span class="n">ptsf</span><span class="p">]</span>
        <span class="n">iinfoflag3</span> <span class="o">=</span> <span class="n">iinfoflag3</span><span class="p">[</span><span class="n">ptsf</span><span class="p">]</span>
        <span class="n">zinfoflag</span> <span class="o">=</span> <span class="n">zinfoflag</span><span class="p">[</span><span class="n">ptsf</span><span class="p">]</span>
        <span class="n">zinfoflag2</span> <span class="o">=</span> <span class="n">zinfoflag2</span><span class="p">[</span><span class="n">ptsf</span><span class="p">]</span>
        <span class="n">zinfoflag3</span> <span class="o">=</span> <span class="n">zinfoflag3</span><span class="p">[</span><span class="n">ptsf</span><span class="p">]</span>
        <span class="n">yinfoflag</span> <span class="o">=</span> <span class="n">yinfoflag</span><span class="p">[</span><span class="n">ptsf</span><span class="p">]</span>
        <span class="n">yinfoflag2</span> <span class="o">=</span> <span class="n">yinfoflag2</span><span class="p">[</span><span class="n">ptsf</span><span class="p">]</span>
        <span class="n">yinfoflag3</span> <span class="o">=</span> <span class="n">yinfoflag3</span><span class="p">[</span><span class="n">ptsf</span><span class="p">]</span>

        <span class="nb">print</span><span class="p">(</span><span class="s2">""</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">'Now filtering the optical data for nan values'</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">""</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">'Number of sources in the PANSTARRS data:'</span><span class="p">,</span>\
              <span class="nb">len</span><span class="p">(</span><span class="n">ps1_objid</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">""</span><span class="p">)</span>

        <span class="n">indices_only_ifilered</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">imag</span><span class="o">!=</span> <span class="o">-</span><span class="mi">999</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">binwidth</span><span class="o">=</span><span class="mf">0.5</span>
        <span class="n">bins</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">imag</span><span class="p">[</span><span class="n">indices_only_ifilered</span><span class="p">]),</span>\
                         <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">imag</span><span class="p">[</span><span class="n">indices_only_ifilered</span><span class="p">])</span> <span class="o">+</span>\
                            <span class="n">binwidth</span><span class="p">,</span> <span class="n">binwidth</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">clf</span><span class="p">()</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">imag</span><span class="p">[</span><span class="n">indices_only_ifilered</span><span class="p">],</span> <span class="n">bins</span><span class="o">=</span><span class="n">bins</span><span class="p">,</span>\
                 <span class="n">facecolor</span><span class="o">=</span><span class="s1">'white'</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">'red'</span><span class="p">,</span>\
                    <span class="n">linestyle</span><span class="o">=</span><span class="s1">'--'</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">'$i_</span><span class="si">{mag}</span><span class="s1">$'</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">'Only $i_</span><span class="si">{mag}</span><span class="s1">$ observations'</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">'best'</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">'hist_only_imag_in_panstarrs_data.png'</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">clf</span><span class="p">()</span>

        <span class="n">indices_all_filtered</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">((</span><span class="n">gmag</span><span class="o">!=</span> <span class="o">-</span><span class="mi">999</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">imag</span><span class="o">!=</span> <span class="o">-</span><span class="mi">999</span><span class="p">)</span> <span class="o">&amp;</span>\
                                        <span class="p">(</span><span class="n">rmag</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">999</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">zmag</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">999</span><span class="p">)</span> <span class="o">&amp;</span>\
                                        <span class="p">(</span><span class="n">ymag</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">999</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">e_gmag</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">999</span><span class="p">)</span> <span class="o">&amp;</span>\
                                        <span class="p">(</span><span class="n">e_rmag</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">999</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">e_imag</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">999</span><span class="p">)</span> <span class="o">&amp;</span>\
                                        <span class="p">(</span><span class="n">e_zmag</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">999</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">e_ymag</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">999</span><span class="p">)</span> <span class="o">&amp;</span>\
                                        <span class="p">(</span><span class="n">gkron</span><span class="o">!=</span> <span class="o">-</span><span class="mi">999</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">ikron</span><span class="o">!=</span> <span class="o">-</span><span class="mi">999</span><span class="p">)</span> <span class="o">&amp;</span>\
                                        <span class="p">(</span><span class="n">zkron</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">999</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">ykron</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">999</span><span class="p">)</span> <span class="o">&amp;</span>\
                                        <span class="p">(</span><span class="n">rkron</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">999</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">e_gmag</span> <span class="o">&lt;</span> <span class="mf">0.2</span><span class="p">)</span> <span class="o">&amp;</span>\
                                        <span class="p">(</span><span class="n">e_rmag</span> <span class="o">&lt;</span> <span class="mf">0.2</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">e_imag</span> <span class="o">&lt;</span> <span class="mf">0.2</span><span class="p">)</span> <span class="o">&amp;</span>\
                                        <span class="p">(</span><span class="n">e_zmag</span> <span class="o">&lt;</span> <span class="mf">0.2</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">e_ymag</span> <span class="o">&lt;</span> <span class="mf">0.2</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>

        <span class="nb">print</span><span class="p">(</span><span class="s1">'Number of sources having detections in five optical bands='</span><span class="p">,</span>\
              <span class="nb">len</span><span class="p">(</span><span class="n">indices_all_filtered</span><span class="p">))</span>

        <span class="n">binwidth</span><span class="o">=</span><span class="mf">0.5</span>
        <span class="n">bins_g</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">gmag</span><span class="p">[</span><span class="n">indices_all_filtered</span><span class="p">]),</span>\
                           <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">gmag</span><span class="p">[</span><span class="n">indices_all_filtered</span><span class="p">])</span> <span class="o">+</span>\
                            <span class="n">binwidth</span><span class="p">,</span> <span class="n">binwidth</span><span class="p">)</span>
        <span class="n">bins_r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">rmag</span><span class="p">[</span><span class="n">indices_all_filtered</span><span class="p">]),</span>\
                           <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">rmag</span><span class="p">[</span><span class="n">indices_all_filtered</span><span class="p">])</span> <span class="o">+</span>\
                            <span class="n">binwidth</span><span class="p">,</span> <span class="n">binwidth</span><span class="p">)</span>
        <span class="n">bins_i</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">imag</span><span class="p">[</span><span class="n">indices_all_filtered</span><span class="p">]),</span>\
                           <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">imag</span><span class="p">[</span><span class="n">indices_all_filtered</span><span class="p">])</span> <span class="o">+</span>\
                            <span class="n">binwidth</span><span class="p">,</span> <span class="n">binwidth</span><span class="p">)</span>
        <span class="n">bins_z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">zmag</span><span class="p">[</span><span class="n">indices_all_filtered</span><span class="p">]),</span>\
                           <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">zmag</span><span class="p">[</span><span class="n">indices_all_filtered</span><span class="p">])</span> <span class="o">+</span>\
                            <span class="n">binwidth</span><span class="p">,</span> <span class="n">binwidth</span><span class="p">)</span>
        <span class="n">bins_y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">ymag</span><span class="p">[</span><span class="n">indices_all_filtered</span><span class="p">]),</span>\
                           <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">ymag</span><span class="p">[</span><span class="n">indices_all_filtered</span><span class="p">])</span> <span class="o">+</span>\
                            <span class="n">binwidth</span><span class="p">,</span> <span class="n">binwidth</span><span class="p">)</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">clf</span><span class="p">()</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">gmag</span><span class="p">[</span><span class="n">indices_all_filtered</span><span class="p">],</span> <span class="n">bins</span><span class="o">=</span><span class="n">bins_g</span><span class="p">,</span>\
                 <span class="n">facecolor</span><span class="o">=</span><span class="s1">'white'</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">'red'</span><span class="p">,</span>\
                <span class="n">linestyle</span><span class="o">=</span><span class="s1">'--'</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">'$g_</span><span class="si">{mag}</span><span class="s1">$'</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">rmag</span><span class="p">[</span><span class="n">indices_all_filtered</span><span class="p">],</span> <span class="n">bins</span><span class="o">=</span><span class="n">bins_r</span><span class="p">,</span>\
                 <span class="n">facecolor</span><span class="o">=</span><span class="s1">'white'</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">'blue'</span><span class="p">,</span>\
                <span class="n">linestyle</span><span class="o">=</span><span class="s1">'--'</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">'$r_</span><span class="si">{mag}</span><span class="s1">$'</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">imag</span><span class="p">[</span><span class="n">indices_all_filtered</span><span class="p">],</span> <span class="n">bins</span><span class="o">=</span><span class="n">bins_i</span><span class="p">,</span>\
                 <span class="n">facecolor</span><span class="o">=</span><span class="s1">'white'</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">'green'</span><span class="p">,</span>\
                <span class="n">linestyle</span><span class="o">=</span><span class="s1">'--'</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">'$i_</span><span class="si">{mag}</span><span class="s1">$'</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">zmag</span><span class="p">[</span><span class="n">indices_all_filtered</span><span class="p">],</span> <span class="n">bins</span><span class="o">=</span><span class="n">bins_z</span><span class="p">,</span>\
                 <span class="n">facecolor</span><span class="o">=</span><span class="s1">'white'</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">'orange'</span><span class="p">,</span>\
                    <span class="n">linestyle</span><span class="o">=</span><span class="s1">'--'</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">'$z_</span><span class="si">{mag}</span><span class="s1">$'</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">ymag</span><span class="p">[</span><span class="n">indices_all_filtered</span><span class="p">],</span> <span class="n">bins</span><span class="o">=</span><span class="n">bins_y</span><span class="p">,</span>\
                 <span class="n">facecolor</span><span class="o">=</span><span class="s1">'white'</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">'purple'</span><span class="p">,</span>\
                    <span class="n">linestyle</span><span class="o">=</span><span class="s1">'--'</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">'$y_</span><span class="si">{mag}</span><span class="s1">$'</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">'PANSTARRS observed data'</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">'best'</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">'hist_panstarrs_data.png'</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">clf</span><span class="p">()</span>

        <span class="n">filtered_optical_data</span> <span class="o">=</span> <span class="n">ps1_objid</span><span class="p">[</span><span class="n">indices_all_filtered</span><span class="p">],</span>\
            <span class="n">ps_ra</span><span class="p">[</span><span class="n">indices_all_filtered</span><span class="p">],</span> <span class="n">err_ps_ra</span><span class="p">[</span><span class="n">indices_all_filtered</span><span class="p">],</span>\
            <span class="n">ps_dec</span><span class="p">[</span><span class="n">indices_all_filtered</span><span class="p">],</span> <span class="n">err_ps_dec</span><span class="p">[</span><span class="n">indices_all_filtered</span><span class="p">],</span>\
            <span class="n">gmag</span><span class="p">[</span><span class="n">indices_all_filtered</span><span class="p">],</span> <span class="n">e_gmag</span><span class="p">[</span><span class="n">indices_all_filtered</span><span class="p">],</span>\
            <span class="n">gkron</span><span class="p">[</span><span class="n">indices_all_filtered</span><span class="p">],</span> <span class="n">e_gkron</span><span class="p">[</span><span class="n">indices_all_filtered</span><span class="p">],</span>\
            <span class="n">rmag</span><span class="p">[</span><span class="n">indices_all_filtered</span><span class="p">],</span> <span class="n">e_rmag</span><span class="p">[</span><span class="n">indices_all_filtered</span><span class="p">],</span>\
            <span class="n">rkron</span><span class="p">[</span><span class="n">indices_all_filtered</span><span class="p">],</span> <span class="n">e_rkron</span><span class="p">[</span><span class="n">indices_all_filtered</span><span class="p">],</span>\
            <span class="n">imag</span><span class="p">[</span><span class="n">indices_all_filtered</span><span class="p">],</span> <span class="n">e_imag</span><span class="p">[</span><span class="n">indices_all_filtered</span><span class="p">],</span>\
            <span class="n">ikron</span><span class="p">[</span><span class="n">indices_all_filtered</span><span class="p">],</span> <span class="n">e_ikron</span><span class="p">[</span><span class="n">indices_all_filtered</span><span class="p">],</span>\
            <span class="n">zmag</span><span class="p">[</span><span class="n">indices_all_filtered</span><span class="p">],</span> <span class="n">e_zmag</span><span class="p">[</span><span class="n">indices_all_filtered</span><span class="p">],</span>\
            <span class="n">zkron</span><span class="p">[</span><span class="n">indices_all_filtered</span><span class="p">],</span> <span class="n">e_zkron</span><span class="p">[</span><span class="n">indices_all_filtered</span><span class="p">],</span>\
            <span class="n">ymag</span><span class="p">[</span><span class="n">indices_all_filtered</span><span class="p">],</span> <span class="n">e_ymag</span><span class="p">[</span><span class="n">indices_all_filtered</span><span class="p">],</span>\
            <span class="n">ykron</span><span class="p">[</span><span class="n">indices_all_filtered</span><span class="p">],</span> <span class="n">e_ykron</span><span class="p">[</span><span class="n">indices_all_filtered</span><span class="p">],</span>\
            <span class="n">objinfoflag</span><span class="p">[</span><span class="n">indices_all_filtered</span><span class="p">],</span> <span class="n">qualityflag</span><span class="p">[</span><span class="n">indices_all_filtered</span><span class="p">],</span>\
            <span class="n">ndetections</span><span class="p">[</span><span class="n">indices_all_filtered</span><span class="p">],</span> <span class="n">nstackdetections</span><span class="p">[</span><span class="n">indices_all_filtered</span><span class="p">],</span>\
            <span class="n">ginfoflag</span><span class="p">[</span><span class="n">indices_all_filtered</span><span class="p">],</span> <span class="n">ginfoflag2</span><span class="p">[</span><span class="n">indices_all_filtered</span><span class="p">],</span>\
            <span class="n">ginfoflag3</span><span class="p">[</span><span class="n">indices_all_filtered</span><span class="p">],</span> <span class="n">rinfoflag</span><span class="p">[</span><span class="n">indices_all_filtered</span><span class="p">],</span>\
            <span class="n">rinfoflag2</span><span class="p">[</span><span class="n">indices_all_filtered</span><span class="p">],</span> <span class="n">rinfoflag3</span><span class="p">[</span><span class="n">indices_all_filtered</span><span class="p">],</span>\
            <span class="n">iinfoflag</span><span class="p">[</span><span class="n">indices_all_filtered</span><span class="p">],</span> <span class="n">iinfoflag2</span><span class="p">[</span><span class="n">indices_all_filtered</span><span class="p">],</span>\
            <span class="n">iinfoflag3</span><span class="p">[</span><span class="n">indices_all_filtered</span><span class="p">],</span> <span class="n">zinfoflag</span><span class="p">[</span><span class="n">indices_all_filtered</span><span class="p">],</span>\
            <span class="n">zinfoflag2</span><span class="p">[</span><span class="n">indices_all_filtered</span><span class="p">],</span> <span class="n">zinfoflag3</span><span class="p">[</span><span class="n">indices_all_filtered</span><span class="p">],</span>\
            <span class="n">yinfoflag</span><span class="p">[</span><span class="n">indices_all_filtered</span><span class="p">],</span> <span class="n">yinfoflag2</span><span class="p">[</span><span class="n">indices_all_filtered</span><span class="p">],</span>\
            <span class="n">yinfoflag3</span><span class="p">[</span><span class="n">indices_all_filtered</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">filtered_optical_data</span>

    <span class="k">def</span> <span class="nf">read_nir_data</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""</span>
<span class="sd">        Reads the input UKIDSS NIR data. The number of columns are 8.</span>

<span class="sd">        Returns the input optical data with nan values removed (if present)</span>
<span class="sd">        and restricts the data to the sources having SNR &gt;= 5.</span>

<span class="sd">        Some regions do not have J or H band data especially DXS or GCS</span>
<span class="sd">        surveys. For these regions, only K band data is imported.</span>
<span class="sd">        """</span>

        <span class="n">ra_name</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ra</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">'.'</span><span class="p">,</span><span class="s1">'_'</span><span class="p">)</span>
        <span class="n">dec_name</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dec</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">'.'</span><span class="p">,</span> <span class="s1">'_'</span><span class="p">)</span>
        <span class="n">file_name</span> <span class="o">=</span> <span class="s1">'UKIDSS'</span> <span class="o">+</span> <span class="s1">'_'</span> <span class="o">+</span> <span class="s1">'RA'</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ra_name</span><span class="p">)</span> <span class="o">+</span> <span class="s1">'DEC'</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">dec_name</span><span class="p">)</span> <span class="o">+</span> <span class="s1">'.csv'</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">'UKIDSS file name='</span><span class="p">,</span> <span class="n">file_name</span><span class="p">)</span>
        <span class="n">file_exists</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">file_name</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">""</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">'Does UKIDSS observed NIR data file exist?'</span><span class="p">,</span> <span class="n">file_exists</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">""</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">file_exists</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">'Validated catalogue does not exist'</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">""</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">'############################################'</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">'Generating observed UKIDSS NIR data file...'</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">""</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">gd</span><span class="o">.</span><span class="n">get_ukidss_data</span><span class="p">()</span>
            <span class="n">ukidss_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">genfromtxt</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">file_name</span><span class="p">),</span> <span class="n">delimiter</span><span class="o">=</span><span class="s1">','</span><span class="p">,</span> <span class="n">skip_header</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">ukidss_data</span><span class="p">)</span><span class="o">&lt;</span><span class="mf">9.0</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">'No observations in UKIDSS'</span><span class="p">)</span>
                <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
            <span class="n">petro_j</span> <span class="o">=</span> <span class="n">ukidss_data</span><span class="p">[:,</span><span class="mi">2</span><span class="p">];</span> <span class="n">e_petro_j</span> <span class="o">=</span> <span class="n">ukidss_data</span><span class="p">[:,</span><span class="mi">3</span><span class="p">]</span>
            <span class="n">petro_h</span> <span class="o">=</span> <span class="n">ukidss_data</span><span class="p">[:,</span><span class="mi">4</span><span class="p">];</span> <span class="n">e_petro_h</span> <span class="o">=</span> <span class="n">ukidss_data</span><span class="p">[:,</span><span class="mi">5</span><span class="p">]</span>
            <span class="n">petro_k</span> <span class="o">=</span> <span class="n">ukidss_data</span><span class="p">[:,</span><span class="mi">6</span><span class="p">];</span> <span class="n">e_petro_k</span> <span class="o">=</span> <span class="n">ukidss_data</span><span class="p">[:,</span><span class="mi">7</span><span class="p">]</span>
            <span class="n">ukidss_ra</span> <span class="o">=</span> <span class="n">ukidss_data</span><span class="p">[:,</span><span class="mi">0</span><span class="p">];</span> <span class="n">ukidss_dec</span> <span class="o">=</span> <span class="n">ukidss_data</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span>

            <span class="n">nir_filter_index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">((</span><span class="n">petro_j</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">999999488</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">e_petro_j</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">999999488</span><span class="p">)</span> <span class="o">&amp;</span>\
                    <span class="p">(</span><span class="n">petro_h</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">999999488</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">e_petro_h</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">999999488</span><span class="p">)</span> <span class="o">&amp;</span>\
                        <span class="p">(</span><span class="n">petro_k</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">999999488</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">e_petro_k</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">999999488</span><span class="p">)</span> <span class="o">&amp;</span>\
                            <span class="p">(</span><span class="n">e_petro_j</span> <span class="o">&lt;</span> <span class="mf">0.2</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">e_petro_h</span> <span class="o">&lt;</span> <span class="mf">0.2</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">e_petro_k</span> <span class="o">&lt;</span> <span class="mf">0.2</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>

            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">nir_filter_index</span><span class="p">)</span> <span class="o">==</span> <span class="mf">0.0</span><span class="p">:</span>

                    <span class="n">new_nir_filter_index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">((</span><span class="n">petro_j</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">999999488</span><span class="p">)</span>\
                                <span class="o">&amp;</span> <span class="p">(</span><span class="n">petro_k</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">999999488</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">petro_h</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">999999488</span><span class="p">)</span> <span class="o">&amp;</span>\
                                <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">e_petro_j</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">0.2</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">e_petro_h</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">0.2</span><span class="p">)</span>\
                                <span class="o">&amp;</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">e_petro_k</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">0.2</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>

                    <span class="n">e_petro_j</span> <span class="o">=</span> <span class="mf">0.005</span><span class="o">*</span><span class="n">petro_j</span><span class="p">[</span><span class="n">new_nir_filter_index</span><span class="p">]</span>
                    <span class="n">e_petro_h</span> <span class="o">=</span> <span class="mf">0.05</span><span class="o">*</span><span class="n">petro_h</span><span class="p">[</span><span class="n">new_nir_filter_index</span><span class="p">]</span>
                    <span class="n">e_petro_k</span> <span class="o">=</span> <span class="mf">0.05</span><span class="o">*</span><span class="n">petro_k</span><span class="p">[</span><span class="n">new_nir_filter_index</span><span class="p">]</span>

                    <span class="nb">print</span><span class="p">(</span><span class="s2">""</span><span class="p">)</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s1">'Number of sources in the NIR data = '</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">new_nir_filter_index</span><span class="p">))</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s2">""</span><span class="p">)</span>

                    <span class="n">filtered_petro_j</span> <span class="o">=</span> <span class="n">petro_j</span><span class="p">[</span><span class="n">new_nir_filter_index</span><span class="p">]</span>
                    <span class="n">filtered_petro_h</span> <span class="o">=</span> <span class="n">petro_h</span><span class="p">[</span><span class="n">new_nir_filter_index</span><span class="p">]</span>
                    <span class="n">filtered_petro_k</span> <span class="o">=</span> <span class="n">petro_k</span><span class="p">[</span><span class="n">new_nir_filter_index</span><span class="p">]</span>
                    <span class="n">filtered_ukidss_ra</span> <span class="o">=</span> <span class="n">ukidss_ra</span><span class="p">[</span><span class="n">new_nir_filter_index</span><span class="p">]</span>
                    <span class="n">filtered_ukidss_dec</span> <span class="o">=</span> <span class="n">ukidss_dec</span><span class="p">[</span><span class="n">new_nir_filter_index</span><span class="p">]</span>

                    <span class="n">binwidth</span><span class="o">=</span><span class="mf">0.5</span>
                    <span class="n">binsj</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">filtered_petro_j</span><span class="p">),</span>\
                                      <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">filtered_petro_j</span><span class="p">)</span>\
                                        <span class="o">+</span> <span class="n">binwidth</span><span class="p">,</span> <span class="n">binwidth</span><span class="p">)</span>
                    <span class="n">binsh</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">filtered_petro_h</span><span class="p">),</span>\
                                      <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">filtered_petro_h</span><span class="p">)</span>\
                                      <span class="o">+</span> <span class="n">binwidth</span><span class="p">,</span> <span class="n">binwidth</span><span class="p">)</span>
                    <span class="n">binsk</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">filtered_petro_k</span><span class="p">),</span>\
                                      <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">filtered_petro_k</span><span class="p">)</span>\
                                      <span class="o">+</span> <span class="n">binwidth</span><span class="p">,</span> <span class="n">binwidth</span><span class="p">)</span>

                    <span class="n">plt</span><span class="o">.</span><span class="n">clf</span><span class="p">()</span>
                    <span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">filtered_petro_j</span><span class="p">,</span> <span class="n">bins</span> <span class="o">=</span> <span class="n">binsj</span><span class="p">,</span>\
                             <span class="n">facecolor</span><span class="o">=</span><span class="s1">'white'</span><span class="p">,</span> <span class="n">edgecolor</span> <span class="o">=</span> <span class="s1">'red'</span><span class="p">,</span>\
                            <span class="n">linestyle</span><span class="o">=</span><span class="s1">'--'</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">'Observed J'</span><span class="p">)</span>
                    <span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">filtered_petro_h</span><span class="p">,</span> <span class="n">bins</span> <span class="o">=</span> <span class="n">binsh</span><span class="p">,</span>\
                             <span class="n">facecolor</span><span class="o">=</span><span class="s1">'white'</span><span class="p">,</span> <span class="n">edgecolor</span> <span class="o">=</span> <span class="s1">'blue'</span><span class="p">,</span>\
                            <span class="n">linestyle</span><span class="o">=</span><span class="s1">'--'</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">'Observed H'</span><span class="p">)</span>
                    <span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">filtered_petro_k</span><span class="p">,</span> <span class="n">bins</span> <span class="o">=</span> <span class="n">binsk</span><span class="p">,</span>\
                             <span class="n">facecolor</span><span class="o">=</span><span class="s1">'white'</span><span class="p">,</span><span class="n">edgecolor</span> <span class="o">=</span> <span class="s1">'green'</span><span class="p">,</span>\
                            <span class="n">linestyle</span><span class="o">=</span><span class="s1">'--'</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">'Observed K'</span><span class="p">)</span>
                    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">'petro magnitudes'</span><span class="p">)</span>
                    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">'Bins'</span><span class="p">)</span>
                    <span class="n">plt</span><span class="o">.</span><span class="n">gird</span><span class="p">()</span>
                    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">'best'</span><span class="p">)</span>
                    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">'hist_ukidss_nir.png'</span><span class="p">)</span>
                    <span class="n">plt</span><span class="o">.</span><span class="n">clf</span><span class="p">()</span>

                    <span class="n">nir_data</span> <span class="o">=</span>  <span class="n">filtered_petro_j</span><span class="p">,</span> <span class="n">filtered_petro_h</span><span class="p">,</span> <span class="n">filtered_petro_k</span><span class="p">,</span>\
                        <span class="n">e_petro_j</span><span class="p">,</span> <span class="n">e_petro_h</span><span class="p">,</span> <span class="n">e_petro_k</span><span class="p">,</span> <span class="n">filtered_ukidss_ra</span><span class="p">,</span> <span class="n">filtered_ukidss_dec</span>
            <span class="k">else</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s2">""</span><span class="p">)</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s1">'Number of sources in the NIR data = '</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">nir_filter_index</span><span class="p">))</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s2">""</span><span class="p">)</span>

                    <span class="n">filtered_petro_j</span> <span class="o">=</span> <span class="n">petro_j</span><span class="p">[</span><span class="n">nir_filter_index</span><span class="p">]</span>
                    <span class="n">e_petro_h</span> <span class="o">=</span> <span class="n">e_petro_h</span><span class="p">[</span><span class="n">nir_filter_index</span><span class="p">]</span>
                    <span class="n">filtered_petro_h</span> <span class="o">=</span> <span class="n">petro_h</span><span class="p">[</span><span class="n">nir_filter_index</span><span class="p">]</span>
                    <span class="n">e_petro_k</span> <span class="o">=</span> <span class="n">e_petro_k</span><span class="p">[</span><span class="n">nir_filter_index</span><span class="p">]</span>
                    <span class="n">filtered_petro_k</span> <span class="o">=</span> <span class="n">petro_k</span><span class="p">[</span><span class="n">nir_filter_index</span><span class="p">]</span>
                    <span class="n">e_petro_j</span> <span class="o">=</span> <span class="n">e_petro_j</span><span class="p">[</span><span class="n">nir_filter_index</span><span class="p">]</span>
                    <span class="n">filtered_ukidss_ra</span> <span class="o">=</span> <span class="n">ukidss_ra</span><span class="p">[</span><span class="n">nir_filter_index</span><span class="p">]</span>
                    <span class="n">filtered_ukidss_dec</span> <span class="o">=</span> <span class="n">ukidss_dec</span><span class="p">[</span><span class="n">nir_filter_index</span><span class="p">]</span>

                    <span class="n">binwidth</span><span class="o">=</span><span class="mf">0.5</span>
                    <span class="n">binsj</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">filtered_petro_j</span><span class="p">),</span>\
                                      <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">filtered_petro_j</span><span class="p">)</span>\
                                        <span class="o">+</span> <span class="n">binwidth</span><span class="p">,</span> <span class="n">binwidth</span><span class="p">)</span>
                    <span class="n">binsh</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">filtered_petro_h</span><span class="p">),</span>\
                                      <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">filtered_petro_h</span><span class="p">)</span>\
                                      <span class="o">+</span> <span class="n">binwidth</span><span class="p">,</span> <span class="n">binwidth</span><span class="p">)</span>
                    <span class="n">binsk</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">filtered_petro_k</span><span class="p">),</span>\
                                      <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">filtered_petro_k</span><span class="p">)</span>\
                                      <span class="o">+</span> <span class="n">binwidth</span><span class="p">,</span> <span class="n">binwidth</span><span class="p">)</span>

                    <span class="n">plt</span><span class="o">.</span><span class="n">clf</span><span class="p">()</span>
                    <span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">filtered_petro_j</span><span class="p">,</span> <span class="n">bins</span> <span class="o">=</span> <span class="n">binsj</span><span class="p">,</span>\
                             <span class="n">facecolor</span><span class="o">=</span><span class="s1">'white'</span><span class="p">,</span> <span class="n">edgecolor</span> <span class="o">=</span> <span class="s1">'red'</span><span class="p">,</span>\
                            <span class="n">linestyle</span><span class="o">=</span><span class="s1">'--'</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">'Observed J'</span><span class="p">)</span>
                    <span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">filtered_petro_h</span><span class="p">,</span> <span class="n">bins</span> <span class="o">=</span> <span class="n">binsh</span><span class="p">,</span>\
                             <span class="n">facecolor</span><span class="o">=</span><span class="s1">'white'</span><span class="p">,</span> <span class="n">edgecolor</span> <span class="o">=</span> <span class="s1">'blue'</span><span class="p">,</span>\
                            <span class="n">linestyle</span><span class="o">=</span><span class="s1">'--'</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">'Observed H'</span><span class="p">)</span>
                    <span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">filtered_petro_k</span><span class="p">,</span> <span class="n">bins</span> <span class="o">=</span> <span class="n">binsk</span><span class="p">,</span>\
                             <span class="n">facecolor</span><span class="o">=</span><span class="s1">'white'</span><span class="p">,</span><span class="n">edgecolor</span> <span class="o">=</span> <span class="s1">'green'</span><span class="p">,</span>\
                            <span class="n">linestyle</span><span class="o">=</span><span class="s1">'--'</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">'Observed K'</span><span class="p">)</span>
                    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">'petro magnitudes'</span><span class="p">)</span>
                    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">'Bins'</span><span class="p">)</span>
                    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
                    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">'best'</span><span class="p">)</span>
                    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">'hist_ukidss_nir.png'</span><span class="p">)</span>
                    <span class="n">plt</span><span class="o">.</span><span class="n">clf</span><span class="p">()</span>

                    <span class="n">nir_data</span> <span class="o">=</span>  <span class="n">filtered_petro_j</span><span class="p">,</span> <span class="n">filtered_petro_h</span><span class="p">,</span> <span class="n">filtered_petro_k</span><span class="p">,</span>\
                        <span class="n">e_petro_j</span><span class="p">,</span> <span class="n">e_petro_h</span><span class="p">,</span> <span class="n">e_petro_k</span><span class="p">,</span> <span class="n">filtered_ukidss_ra</span><span class="p">,</span> <span class="n">filtered_ukidss_dec</span>

        <span class="k">elif</span> <span class="n">file_exists</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">""</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">'Reading the validated catalogue file:'</span><span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">file_name</span><span class="p">))</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">""</span><span class="p">)</span>
                <span class="n">ukidss_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">genfromtxt</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">file_name</span><span class="p">),</span> <span class="n">delimiter</span><span class="o">=</span><span class="s1">','</span><span class="p">,</span> <span class="n">skip_header</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">ukidss_data</span><span class="p">)</span><span class="o">&lt;</span><span class="mf">9.0</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">'No observations in UKIDSS'</span><span class="p">)</span>
                    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
                <span class="n">petro_j</span> <span class="o">=</span> <span class="n">ukidss_data</span><span class="p">[:,</span><span class="mi">2</span><span class="p">];</span> <span class="n">e_petro_j</span> <span class="o">=</span> <span class="n">ukidss_data</span><span class="p">[:,</span><span class="mi">3</span><span class="p">]</span>
                <span class="n">petro_h</span> <span class="o">=</span> <span class="n">ukidss_data</span><span class="p">[:,</span><span class="mi">4</span><span class="p">];</span> <span class="n">e_petro_h</span> <span class="o">=</span> <span class="n">ukidss_data</span><span class="p">[:,</span><span class="mi">5</span><span class="p">]</span>
                <span class="n">petro_k</span> <span class="o">=</span> <span class="n">ukidss_data</span><span class="p">[:,</span><span class="mi">6</span><span class="p">];</span> <span class="n">e_petro_k</span> <span class="o">=</span> <span class="n">ukidss_data</span><span class="p">[:,</span><span class="mi">7</span><span class="p">]</span>
                <span class="n">ukidss_ra</span> <span class="o">=</span> <span class="n">ukidss_data</span><span class="p">[:,</span><span class="mi">0</span><span class="p">];</span> <span class="n">ukidss_dec</span> <span class="o">=</span> <span class="n">ukidss_data</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span>

                <span class="n">nir_filter_index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">((</span><span class="n">petro_j</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">999999488</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">e_petro_j</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">999999488</span><span class="p">)</span> <span class="o">&amp;</span>\
                    <span class="p">(</span><span class="n">petro_h</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">999999488</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">e_petro_h</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">999999488</span><span class="p">)</span> <span class="o">&amp;</span>\
                        <span class="p">(</span><span class="n">petro_k</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">999999488</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">e_petro_k</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">999999488</span><span class="p">)</span> <span class="o">&amp;</span>\
                            <span class="p">(</span><span class="n">e_petro_j</span> <span class="o">&lt;</span> <span class="mf">0.2</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">e_petro_h</span> <span class="o">&lt;</span> <span class="mf">0.2</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">e_petro_k</span> <span class="o">&lt;</span> <span class="mf">0.2</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">nir_filter_index</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>

                    <span class="n">new_nir_filter_index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">((</span><span class="n">petro_j</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">999999488</span><span class="p">)</span>\
                                        <span class="o">&amp;</span> <span class="p">(</span><span class="n">petro_k</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">999999488</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">petro_h</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">999999488</span><span class="p">)</span> <span class="o">&amp;</span>\
                                            <span class="p">(</span><span class="n">e_petro_j</span> <span class="o">&lt;</span> <span class="mf">0.2</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">e_petro_h</span> <span class="o">&lt;</span> <span class="mf">0.2</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">e_petro_k</span> <span class="o">&lt;</span> <span class="mf">0.2</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
                    <span class="n">e_petro_j</span> <span class="o">=</span> <span class="mf">0.005</span><span class="o">*</span><span class="n">petro_j</span><span class="p">[</span><span class="n">new_nir_filter_index</span><span class="p">]</span>
                    <span class="n">e_petro_h</span> <span class="o">=</span> <span class="mf">0.05</span><span class="o">*</span><span class="n">petro_h</span><span class="p">[</span><span class="n">new_nir_filter_index</span><span class="p">]</span>
                    <span class="n">e_petro_k</span> <span class="o">=</span> <span class="mf">0.05</span><span class="o">*</span><span class="n">petro_k</span><span class="p">[</span><span class="n">new_nir_filter_index</span><span class="p">]</span>

                    <span class="nb">print</span><span class="p">(</span><span class="s2">""</span><span class="p">)</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s1">'Number of sources in the NIR data = '</span><span class="p">,</span>\
                          <span class="nb">len</span><span class="p">(</span><span class="n">new_nir_filter_index</span><span class="p">))</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s2">""</span><span class="p">)</span>

                    <span class="n">filtered_petro_j</span> <span class="o">=</span> <span class="n">petro_j</span><span class="p">[</span><span class="n">new_nir_filter_index</span><span class="p">]</span>
                    <span class="n">filtered_petro_h</span> <span class="o">=</span> <span class="n">petro_h</span><span class="p">[</span><span class="n">new_nir_filter_index</span><span class="p">]</span>
                    <span class="n">filtered_petro_k</span> <span class="o">=</span> <span class="n">petro_k</span><span class="p">[</span><span class="n">new_nir_filter_index</span><span class="p">]</span>
                    <span class="n">filtered_ukidss_ra</span> <span class="o">=</span> <span class="n">ukidss_ra</span><span class="p">[</span><span class="n">new_nir_filter_index</span><span class="p">]</span>
                    <span class="n">filtered_ukidss_dec</span> <span class="o">=</span> <span class="n">ukidss_dec</span><span class="p">[</span><span class="n">new_nir_filter_index</span><span class="p">]</span>

                    <span class="n">binwidth</span><span class="o">=</span><span class="mf">0.5</span>
                    <span class="n">binsj</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">filtered_petro_j</span><span class="p">),</span>\
                                      <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">filtered_petro_j</span><span class="p">)</span>\
                                        <span class="o">+</span> <span class="n">binwidth</span><span class="p">,</span> <span class="n">binwidth</span><span class="p">)</span>
                    <span class="n">binsh</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">filtered_petro_h</span><span class="p">),</span>\
                                      <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">filtered_petro_h</span><span class="p">)</span>\
                                      <span class="o">+</span> <span class="n">binwidth</span><span class="p">,</span> <span class="n">binwidth</span><span class="p">)</span>
                    <span class="n">binsk</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">filtered_petro_k</span><span class="p">),</span>\
                                      <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">filtered_petro_k</span><span class="p">)</span>\
                                      <span class="o">+</span> <span class="n">binwidth</span><span class="p">,</span> <span class="n">binwidth</span><span class="p">)</span>

                    <span class="n">plt</span><span class="o">.</span><span class="n">clf</span><span class="p">()</span>
                    <span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">filtered_petro_j</span><span class="p">,</span> <span class="n">bins</span> <span class="o">=</span> <span class="n">binsj</span><span class="p">,</span>\
                             <span class="n">facecolor</span><span class="o">=</span><span class="s1">'white'</span><span class="p">,</span> <span class="n">edgecolor</span> <span class="o">=</span> <span class="s1">'red'</span><span class="p">,</span>\
                            <span class="n">linestyle</span><span class="o">=</span><span class="s1">'--'</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">'Observed J'</span><span class="p">)</span>
                    <span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">filtered_petro_h</span><span class="p">,</span> <span class="n">bins</span> <span class="o">=</span> <span class="n">binsh</span><span class="p">,</span>\
                             <span class="n">facecolor</span><span class="o">=</span><span class="s1">'white'</span><span class="p">,</span> <span class="n">edgecolor</span> <span class="o">=</span> <span class="s1">'blue'</span><span class="p">,</span>\
                            <span class="n">linestyle</span><span class="o">=</span><span class="s1">'--'</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">'Observed H'</span><span class="p">)</span>
                    <span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">filtered_petro_k</span><span class="p">,</span> <span class="n">bins</span> <span class="o">=</span> <span class="n">binsk</span><span class="p">,</span>\
                             <span class="n">facecolor</span><span class="o">=</span><span class="s1">'white'</span><span class="p">,</span><span class="n">edgecolor</span> <span class="o">=</span> <span class="s1">'green'</span><span class="p">,</span>\
                            <span class="n">linestyle</span><span class="o">=</span><span class="s1">'--'</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">'Observed K'</span><span class="p">)</span>
                    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">'petro magnitudes'</span><span class="p">)</span>
                    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">'Bins'</span><span class="p">)</span>
                    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
                    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">'best'</span><span class="p">)</span>
                    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">'hist_ukidss_nir.png'</span><span class="p">)</span>
                    <span class="n">plt</span><span class="o">.</span><span class="n">clf</span><span class="p">()</span>

                    <span class="n">nir_data</span> <span class="o">=</span>  <span class="n">filtered_petro_j</span><span class="p">,</span> <span class="n">filtered_petro_h</span><span class="p">,</span> <span class="n">filtered_petro_k</span><span class="p">,</span>\
                        <span class="n">e_petro_j</span><span class="p">,</span> <span class="n">e_petro_h</span><span class="p">,</span> <span class="n">e_petro_k</span><span class="p">,</span> <span class="n">filtered_ukidss_ra</span><span class="p">,</span> <span class="n">filtered_ukidss_dec</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s2">""</span><span class="p">)</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s1">'Number of sources in the NIR data = '</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">nir_filter_index</span><span class="p">))</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s2">""</span><span class="p">)</span>

                    <span class="n">filtered_petro_j</span> <span class="o">=</span> <span class="n">petro_j</span><span class="p">[</span><span class="n">nir_filter_index</span><span class="p">]</span>
                    <span class="n">e_petro_h</span> <span class="o">=</span> <span class="n">e_petro_h</span><span class="p">[</span><span class="n">nir_filter_index</span><span class="p">]</span>
                    <span class="n">filtered_petro_h</span> <span class="o">=</span> <span class="n">petro_h</span><span class="p">[</span><span class="n">nir_filter_index</span><span class="p">]</span>
                    <span class="n">e_petro_k</span> <span class="o">=</span> <span class="n">e_petro_k</span><span class="p">[</span><span class="n">nir_filter_index</span><span class="p">]</span>
                    <span class="n">filtered_petro_k</span> <span class="o">=</span> <span class="n">petro_k</span><span class="p">[</span><span class="n">nir_filter_index</span><span class="p">]</span>
                    <span class="n">e_petro_j</span> <span class="o">=</span> <span class="n">e_petro_j</span><span class="p">[</span><span class="n">nir_filter_index</span><span class="p">]</span>
                    <span class="n">filtered_ukidss_ra</span> <span class="o">=</span> <span class="n">ukidss_ra</span><span class="p">[</span><span class="n">nir_filter_index</span><span class="p">]</span>
                    <span class="n">filtered_ukidss_dec</span> <span class="o">=</span> <span class="n">ukidss_dec</span><span class="p">[</span><span class="n">nir_filter_index</span><span class="p">]</span>

                    <span class="n">binwidth</span><span class="o">=</span><span class="mf">0.5</span>
                    <span class="n">binsj</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">filtered_petro_j</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">filtered_petro_j</span><span class="p">)</span> <span class="o">+</span> <span class="n">binwidth</span><span class="p">,</span> <span class="n">binwidth</span><span class="p">)</span>
                    <span class="n">binsh</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">filtered_petro_h</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">filtered_petro_h</span><span class="p">)</span> <span class="o">+</span> <span class="n">binwidth</span><span class="p">,</span> <span class="n">binwidth</span><span class="p">)</span>
                    <span class="n">binsk</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">filtered_petro_k</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">filtered_petro_k</span><span class="p">)</span> <span class="o">+</span> <span class="n">binwidth</span><span class="p">,</span> <span class="n">binwidth</span><span class="p">)</span>

                    <span class="n">plt</span><span class="o">.</span><span class="n">clf</span><span class="p">()</span>
                    <span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">filtered_petro_j</span><span class="p">,</span> <span class="n">bins</span> <span class="o">=</span> <span class="n">binsj</span><span class="p">,</span>\
                             <span class="n">facecolor</span><span class="o">=</span><span class="s1">'white'</span><span class="p">,</span> <span class="n">edgecolor</span> <span class="o">=</span> <span class="s1">'red'</span><span class="p">,</span>\
                                <span class="n">linestyle</span><span class="o">=</span><span class="s1">'--'</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">'Observed J'</span><span class="p">)</span>
                    <span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">filtered_petro_h</span><span class="p">,</span> <span class="n">bins</span> <span class="o">=</span> <span class="n">binsh</span><span class="p">,</span>\
                             <span class="n">facecolor</span><span class="o">=</span><span class="s1">'white'</span><span class="p">,</span> <span class="n">edgecolor</span> <span class="o">=</span> <span class="s1">'blue'</span><span class="p">,</span>\
                                <span class="n">linestyle</span><span class="o">=</span><span class="s1">'--'</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">'Observed H'</span><span class="p">)</span>
                    <span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">filtered_petro_k</span><span class="p">,</span> <span class="n">bins</span> <span class="o">=</span> <span class="n">binsk</span><span class="p">,</span>\
                             <span class="n">facecolor</span><span class="o">=</span><span class="s1">'white'</span><span class="p">,</span> <span class="n">edgecolor</span> <span class="o">=</span> <span class="s1">'green'</span><span class="p">,</span>\
                                <span class="n">linestyle</span><span class="o">=</span><span class="s1">'--'</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">'Observed K'</span><span class="p">)</span>
                    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">'petro magnitudes'</span><span class="p">)</span>
                    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">'Bins'</span><span class="p">)</span>
                    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
                    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">'best'</span><span class="p">)</span>
                    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">'hist_ukidss_nir.png'</span><span class="p">)</span>
                    <span class="n">plt</span><span class="o">.</span><span class="n">clf</span><span class="p">()</span>

                    <span class="n">nir_data</span> <span class="o">=</span>  <span class="n">filtered_petro_j</span><span class="p">,</span> <span class="n">filtered_petro_h</span><span class="p">,</span> <span class="n">filtered_petro_k</span><span class="p">,</span>\
                        <span class="n">e_petro_j</span><span class="p">,</span> <span class="n">e_petro_h</span><span class="p">,</span> <span class="n">e_petro_k</span><span class="p">,</span> <span class="n">filtered_ukidss_ra</span><span class="p">,</span> <span class="n">filtered_ukidss_dec</span>
        <span class="k">return</span> <span class="n">nir_data</span>

    <span class="k">def</span> <span class="nf">read_gaia_data</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">            </span><span class="sd">"""</span>
<span class="sd">                Reads the input GAIA DR3 data. The number of columns are 12.</span>

<span class="sd">            """</span>
            <span class="n">header</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'source_id'</span><span class="p">,</span><span class="s1">'ra'</span><span class="p">,</span><span class="s1">'ra_error,dec'</span><span class="p">,</span><span class="s1">'dec_error'</span><span class="p">,</span><span class="s1">'parallax'</span><span class="p">,</span><span class="s1">'parallax_error'</span><span class="p">,</span>\
                      <span class="s1">'pm'</span><span class="p">,</span><span class="s1">'pmra'</span><span class="p">,</span><span class="s1">'pmra_error'</span><span class="p">,</span><span class="s1">'pmdec'</span><span class="p">,</span><span class="s1">'pmdec_error'</span><span class="p">,</span><span class="s1">'ruwe'</span><span class="p">]</span>

            <span class="n">ra_name</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ra</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">'.'</span><span class="p">,</span><span class="s1">'_'</span><span class="p">)</span>
            <span class="n">dec_name</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dec</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">'.'</span><span class="p">,</span> <span class="s1">'_'</span><span class="p">)</span>    
            <span class="n">file_name</span> <span class="o">=</span> <span class="s1">'GAIA'</span><span class="o">+</span><span class="s1">'_'</span><span class="o">+</span><span class="s1">'RA'</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ra_name</span><span class="p">)</span><span class="o">+</span><span class="s1">'DEC'</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">dec_name</span><span class="p">)</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">gaia_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">genfromtxt</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">file_name</span><span class="p">)</span><span class="o">+</span><span class="s1">'.csv'</span><span class="p">,</span><span class="n">delimiter</span><span class="o">=</span><span class="s1">','</span><span class="p">,</span><span class="n">skip_header</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
                <span class="n">gaia_source_id</span> <span class="o">=</span> <span class="n">gaia_data</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">gaia_ra</span> <span class="o">=</span> <span class="n">gaia_data</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span>
                <span class="n">gaia_ra_error</span> <span class="o">=</span> <span class="n">gaia_data</span><span class="p">[:,</span><span class="mi">2</span><span class="p">]</span>
                <span class="n">gaia_dec</span> <span class="o">=</span> <span class="n">gaia_data</span><span class="p">[:,</span><span class="mi">3</span><span class="p">]</span>
                <span class="n">gaia_dec_error</span> <span class="o">=</span> <span class="n">gaia_data</span><span class="p">[:,</span><span class="mi">4</span><span class="p">]</span>
                <span class="n">gaia_parallax</span> <span class="o">=</span> <span class="n">gaia_data</span><span class="p">[:,</span><span class="mi">5</span><span class="p">]</span>
                <span class="n">gaia_parallax_error</span> <span class="o">=</span> <span class="n">gaia_data</span><span class="p">[:,</span><span class="mi">6</span><span class="p">]</span>
                <span class="n">gaia_pm</span> <span class="o">=</span> <span class="n">gaia_data</span><span class="p">[:,</span><span class="mi">7</span><span class="p">]</span>
                <span class="n">gaia_pm_ra</span> <span class="o">=</span> <span class="n">gaia_data</span><span class="p">[:,</span><span class="mi">8</span><span class="p">]</span>
                <span class="n">gaia_pm_ra_error</span> <span class="o">=</span> <span class="n">gaia_data</span><span class="p">[:,</span><span class="mi">9</span><span class="p">]</span>
                <span class="n">gaia_pm_dec</span> <span class="o">=</span> <span class="n">gaia_data</span><span class="p">[:,</span><span class="mi">10</span><span class="p">]</span>
                <span class="n">gaia_pm_dec_error</span> <span class="o">=</span> <span class="n">gaia_data</span><span class="p">[:,</span><span class="mi">11</span><span class="p">]</span>
                <span class="n">gaia_ruwe</span> <span class="o">=</span> <span class="n">gaia_data</span><span class="p">[:,</span><span class="mi">12</span><span class="p">]</span>
                <span class="n">gaia_data</span> <span class="o">=</span> <span class="n">gaia_source_id</span><span class="p">,</span> <span class="n">gaia_ra</span><span class="p">,</span> <span class="n">gaia_ra_error</span><span class="p">,</span> <span class="n">gaia_dec</span><span class="p">,</span>\
                    <span class="n">gaia_dec_error</span><span class="p">,</span> <span class="n">gaia_parallax</span><span class="p">,</span> <span class="n">gaia_parallax_error</span><span class="p">,</span>\
                    <span class="n">gaia_pm</span><span class="p">,</span> <span class="n">gaia_pm_ra</span><span class="p">,</span> <span class="n">gaia_pm_ra_error</span><span class="p">,</span> <span class="n">gaia_pm_dec</span><span class="p">,</span>\
                    <span class="n">gaia_pm_dec_error</span><span class="p">,</span> <span class="n">gaia_ruwe</span>
            <span class="k">except</span> <span class="ne">FileNotFoundError</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">gd</span><span class="o">.</span><span class="n">get_gaia_data</span><span class="p">()</span>
                <span class="n">gaia_data</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">genfromtxt</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">file_name</span><span class="p">)</span><span class="o">+</span><span class="s1">'.csv'</span><span class="p">,</span><span class="n">delimiter</span><span class="o">=</span><span class="s1">','</span><span class="p">,</span>\
                                        <span class="n">skip_header</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
                <span class="n">gaia_source_id</span> <span class="o">=</span> <span class="n">gaia_data</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">gaia_ra</span> <span class="o">=</span> <span class="n">gaia_data</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span>
                <span class="n">gaia_ra_error</span> <span class="o">=</span> <span class="n">gaia_data</span><span class="p">[:,</span><span class="mi">2</span><span class="p">]</span>
                <span class="n">gaia_dec</span> <span class="o">=</span> <span class="n">gaia_data</span><span class="p">[:,</span><span class="mi">3</span><span class="p">]</span>
                <span class="n">gaia_dec_error</span> <span class="o">=</span> <span class="n">gaia_data</span><span class="p">[:,</span><span class="mi">4</span><span class="p">]</span>
                <span class="n">gaia_parallax</span> <span class="o">=</span> <span class="n">gaia_data</span><span class="p">[:,</span><span class="mi">5</span><span class="p">]</span>
                <span class="n">gaia_parallax_error</span> <span class="o">=</span> <span class="n">gaia_data</span><span class="p">[:,</span><span class="mi">6</span><span class="p">]</span>
                <span class="n">gaia_pm</span> <span class="o">=</span> <span class="n">gaia_data</span><span class="p">[:,</span><span class="mi">7</span><span class="p">]</span>
                <span class="n">gaia_pm_ra</span> <span class="o">=</span> <span class="n">gaia_data</span><span class="p">[:,</span><span class="mi">8</span><span class="p">]</span>
                <span class="n">gaia_pm_ra_error</span> <span class="o">=</span> <span class="n">gaia_data</span><span class="p">[:,</span><span class="mi">9</span><span class="p">]</span>
                <span class="n">gaia_pm_dec</span> <span class="o">=</span> <span class="n">gaia_data</span><span class="p">[:,</span><span class="mi">10</span><span class="p">]</span>
                <span class="n">gaia_pm_dec_error</span> <span class="o">=</span> <span class="n">gaia_data</span><span class="p">[:,</span><span class="mi">11</span><span class="p">]</span>
                <span class="n">gaia_ruwe</span> <span class="o">=</span> <span class="n">gaia_data</span><span class="p">[:,</span><span class="mi">12</span><span class="p">]</span>
                <span class="n">gaia_data</span> <span class="o">=</span> <span class="n">gaia_source_id</span><span class="p">,</span><span class="n">gaia_ra</span><span class="p">,</span><span class="n">gaia_ra_error</span><span class="p">,</span><span class="n">gaia_dec</span><span class="p">,</span>\
                    <span class="n">gaia_dec_error</span><span class="p">,</span> <span class="n">gaia_parallax</span><span class="p">,</span> <span class="n">gaia_parallax_error</span><span class="p">,</span>\
                    <span class="n">gaia_pm</span><span class="p">,</span> <span class="n">gaia_pm_ra</span><span class="p">,</span> <span class="n">gaia_pm_ra_error</span><span class="p">,</span> <span class="n">gaia_pm_dec</span><span class="p">,</span>\
                    <span class="n">gaia_pm_dec_error</span><span class="p">,</span> <span class="n">gaia_ruwe</span>
            <span class="k">return</span> <span class="n">gaia_data</span>
</code></pre></div></td></tr></table></div>
</details>
<div class="doc doc-children">
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="irgsctool._read_data.ReadData.read_gaia_data">
<code class="highlight language-python"><span class="n">read_gaia_data</span><span class="p">()</span></code>
</h3>
<div class="doc doc-contents">
<p>Reads the input GAIA DR3 data. The number of columns are 12.</p>
<details class="quote">
<summary>Source code in <code>irgsctool/_read_data.py</code></summary>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span>
<span class="normal">548</span>
<span class="normal">549</span>
<span class="normal">550</span>
<span class="normal">551</span>
<span class="normal">552</span>
<span class="normal">553</span>
<span class="normal">554</span>
<span class="normal">555</span>
<span class="normal">556</span>
<span class="normal">557</span>
<span class="normal">558</span>
<span class="normal">559</span>
<span class="normal">560</span>
<span class="normal">561</span>
<span class="normal">562</span>
<span class="normal">563</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">read_gaia_data</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""</span>
<span class="sd">            Reads the input GAIA DR3 data. The number of columns are 12.</span>

<span class="sd">        """</span>
        <span class="n">header</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'source_id'</span><span class="p">,</span><span class="s1">'ra'</span><span class="p">,</span><span class="s1">'ra_error,dec'</span><span class="p">,</span><span class="s1">'dec_error'</span><span class="p">,</span><span class="s1">'parallax'</span><span class="p">,</span><span class="s1">'parallax_error'</span><span class="p">,</span>\
                  <span class="s1">'pm'</span><span class="p">,</span><span class="s1">'pmra'</span><span class="p">,</span><span class="s1">'pmra_error'</span><span class="p">,</span><span class="s1">'pmdec'</span><span class="p">,</span><span class="s1">'pmdec_error'</span><span class="p">,</span><span class="s1">'ruwe'</span><span class="p">]</span>

        <span class="n">ra_name</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ra</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">'.'</span><span class="p">,</span><span class="s1">'_'</span><span class="p">)</span>
        <span class="n">dec_name</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dec</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">'.'</span><span class="p">,</span> <span class="s1">'_'</span><span class="p">)</span>    
        <span class="n">file_name</span> <span class="o">=</span> <span class="s1">'GAIA'</span><span class="o">+</span><span class="s1">'_'</span><span class="o">+</span><span class="s1">'RA'</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ra_name</span><span class="p">)</span><span class="o">+</span><span class="s1">'DEC'</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">dec_name</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">gaia_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">genfromtxt</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">file_name</span><span class="p">)</span><span class="o">+</span><span class="s1">'.csv'</span><span class="p">,</span><span class="n">delimiter</span><span class="o">=</span><span class="s1">','</span><span class="p">,</span><span class="n">skip_header</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">gaia_source_id</span> <span class="o">=</span> <span class="n">gaia_data</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">gaia_ra</span> <span class="o">=</span> <span class="n">gaia_data</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">gaia_ra_error</span> <span class="o">=</span> <span class="n">gaia_data</span><span class="p">[:,</span><span class="mi">2</span><span class="p">]</span>
            <span class="n">gaia_dec</span> <span class="o">=</span> <span class="n">gaia_data</span><span class="p">[:,</span><span class="mi">3</span><span class="p">]</span>
            <span class="n">gaia_dec_error</span> <span class="o">=</span> <span class="n">gaia_data</span><span class="p">[:,</span><span class="mi">4</span><span class="p">]</span>
            <span class="n">gaia_parallax</span> <span class="o">=</span> <span class="n">gaia_data</span><span class="p">[:,</span><span class="mi">5</span><span class="p">]</span>
            <span class="n">gaia_parallax_error</span> <span class="o">=</span> <span class="n">gaia_data</span><span class="p">[:,</span><span class="mi">6</span><span class="p">]</span>
            <span class="n">gaia_pm</span> <span class="o">=</span> <span class="n">gaia_data</span><span class="p">[:,</span><span class="mi">7</span><span class="p">]</span>
            <span class="n">gaia_pm_ra</span> <span class="o">=</span> <span class="n">gaia_data</span><span class="p">[:,</span><span class="mi">8</span><span class="p">]</span>
            <span class="n">gaia_pm_ra_error</span> <span class="o">=</span> <span class="n">gaia_data</span><span class="p">[:,</span><span class="mi">9</span><span class="p">]</span>
            <span class="n">gaia_pm_dec</span> <span class="o">=</span> <span class="n">gaia_data</span><span class="p">[:,</span><span class="mi">10</span><span class="p">]</span>
            <span class="n">gaia_pm_dec_error</span> <span class="o">=</span> <span class="n">gaia_data</span><span class="p">[:,</span><span class="mi">11</span><span class="p">]</span>
            <span class="n">gaia_ruwe</span> <span class="o">=</span> <span class="n">gaia_data</span><span class="p">[:,</span><span class="mi">12</span><span class="p">]</span>
            <span class="n">gaia_data</span> <span class="o">=</span> <span class="n">gaia_source_id</span><span class="p">,</span> <span class="n">gaia_ra</span><span class="p">,</span> <span class="n">gaia_ra_error</span><span class="p">,</span> <span class="n">gaia_dec</span><span class="p">,</span>\
                <span class="n">gaia_dec_error</span><span class="p">,</span> <span class="n">gaia_parallax</span><span class="p">,</span> <span class="n">gaia_parallax_error</span><span class="p">,</span>\
                <span class="n">gaia_pm</span><span class="p">,</span> <span class="n">gaia_pm_ra</span><span class="p">,</span> <span class="n">gaia_pm_ra_error</span><span class="p">,</span> <span class="n">gaia_pm_dec</span><span class="p">,</span>\
                <span class="n">gaia_pm_dec_error</span><span class="p">,</span> <span class="n">gaia_ruwe</span>
        <span class="k">except</span> <span class="ne">FileNotFoundError</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">gd</span><span class="o">.</span><span class="n">get_gaia_data</span><span class="p">()</span>
            <span class="n">gaia_data</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">genfromtxt</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">file_name</span><span class="p">)</span><span class="o">+</span><span class="s1">'.csv'</span><span class="p">,</span><span class="n">delimiter</span><span class="o">=</span><span class="s1">','</span><span class="p">,</span>\
                                    <span class="n">skip_header</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">gaia_source_id</span> <span class="o">=</span> <span class="n">gaia_data</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">gaia_ra</span> <span class="o">=</span> <span class="n">gaia_data</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">gaia_ra_error</span> <span class="o">=</span> <span class="n">gaia_data</span><span class="p">[:,</span><span class="mi">2</span><span class="p">]</span>
            <span class="n">gaia_dec</span> <span class="o">=</span> <span class="n">gaia_data</span><span class="p">[:,</span><span class="mi">3</span><span class="p">]</span>
            <span class="n">gaia_dec_error</span> <span class="o">=</span> <span class="n">gaia_data</span><span class="p">[:,</span><span class="mi">4</span><span class="p">]</span>
            <span class="n">gaia_parallax</span> <span class="o">=</span> <span class="n">gaia_data</span><span class="p">[:,</span><span class="mi">5</span><span class="p">]</span>
            <span class="n">gaia_parallax_error</span> <span class="o">=</span> <span class="n">gaia_data</span><span class="p">[:,</span><span class="mi">6</span><span class="p">]</span>
            <span class="n">gaia_pm</span> <span class="o">=</span> <span class="n">gaia_data</span><span class="p">[:,</span><span class="mi">7</span><span class="p">]</span>
            <span class="n">gaia_pm_ra</span> <span class="o">=</span> <span class="n">gaia_data</span><span class="p">[:,</span><span class="mi">8</span><span class="p">]</span>
            <span class="n">gaia_pm_ra_error</span> <span class="o">=</span> <span class="n">gaia_data</span><span class="p">[:,</span><span class="mi">9</span><span class="p">]</span>
            <span class="n">gaia_pm_dec</span> <span class="o">=</span> <span class="n">gaia_data</span><span class="p">[:,</span><span class="mi">10</span><span class="p">]</span>
            <span class="n">gaia_pm_dec_error</span> <span class="o">=</span> <span class="n">gaia_data</span><span class="p">[:,</span><span class="mi">11</span><span class="p">]</span>
            <span class="n">gaia_ruwe</span> <span class="o">=</span> <span class="n">gaia_data</span><span class="p">[:,</span><span class="mi">12</span><span class="p">]</span>
            <span class="n">gaia_data</span> <span class="o">=</span> <span class="n">gaia_source_id</span><span class="p">,</span><span class="n">gaia_ra</span><span class="p">,</span><span class="n">gaia_ra_error</span><span class="p">,</span><span class="n">gaia_dec</span><span class="p">,</span>\
                <span class="n">gaia_dec_error</span><span class="p">,</span> <span class="n">gaia_parallax</span><span class="p">,</span> <span class="n">gaia_parallax_error</span><span class="p">,</span>\
                <span class="n">gaia_pm</span><span class="p">,</span> <span class="n">gaia_pm_ra</span><span class="p">,</span> <span class="n">gaia_pm_ra_error</span><span class="p">,</span> <span class="n">gaia_pm_dec</span><span class="p">,</span>\
                <span class="n">gaia_pm_dec_error</span><span class="p">,</span> <span class="n">gaia_ruwe</span>
        <span class="k">return</span> <span class="n">gaia_data</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="irgsctool._read_data.ReadData.read_nir_data">
<code class="highlight language-python"><span class="n">read_nir_data</span><span class="p">()</span></code>
</h3>
<div class="doc doc-contents">
<p>Reads the input UKIDSS NIR data. The number of columns are 8.</p>
<p>Returns the input optical data with nan values removed (if present)
and restricts the data to the sources having SNR &gt;= 5.</p>
<p>Some regions do not have J or H band data especially DXS or GCS
surveys. For these regions, only K band data is imported.</p>
<details class="quote">
<summary>Source code in <code>irgsctool/_read_data.py</code></summary>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">read_nir_data</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    Reads the input UKIDSS NIR data. The number of columns are 8.</span>

<span class="sd">    Returns the input optical data with nan values removed (if present)</span>
<span class="sd">    and restricts the data to the sources having SNR &gt;= 5.</span>

<span class="sd">    Some regions do not have J or H band data especially DXS or GCS</span>
<span class="sd">    surveys. For these regions, only K band data is imported.</span>
<span class="sd">    """</span>

    <span class="n">ra_name</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ra</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">'.'</span><span class="p">,</span><span class="s1">'_'</span><span class="p">)</span>
    <span class="n">dec_name</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dec</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">'.'</span><span class="p">,</span> <span class="s1">'_'</span><span class="p">)</span>
    <span class="n">file_name</span> <span class="o">=</span> <span class="s1">'UKIDSS'</span> <span class="o">+</span> <span class="s1">'_'</span> <span class="o">+</span> <span class="s1">'RA'</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ra_name</span><span class="p">)</span> <span class="o">+</span> <span class="s1">'DEC'</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">dec_name</span><span class="p">)</span> <span class="o">+</span> <span class="s1">'.csv'</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">'UKIDSS file name='</span><span class="p">,</span> <span class="n">file_name</span><span class="p">)</span>
    <span class="n">file_exists</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">file_name</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">""</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">'Does UKIDSS observed NIR data file exist?'</span><span class="p">,</span> <span class="n">file_exists</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">""</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">file_exists</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">'Validated catalogue does not exist'</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">""</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">'############################################'</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">'Generating observed UKIDSS NIR data file...'</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">""</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gd</span><span class="o">.</span><span class="n">get_ukidss_data</span><span class="p">()</span>
        <span class="n">ukidss_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">genfromtxt</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">file_name</span><span class="p">),</span> <span class="n">delimiter</span><span class="o">=</span><span class="s1">','</span><span class="p">,</span> <span class="n">skip_header</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">ukidss_data</span><span class="p">)</span><span class="o">&lt;</span><span class="mf">9.0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">'No observations in UKIDSS'</span><span class="p">)</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">petro_j</span> <span class="o">=</span> <span class="n">ukidss_data</span><span class="p">[:,</span><span class="mi">2</span><span class="p">];</span> <span class="n">e_petro_j</span> <span class="o">=</span> <span class="n">ukidss_data</span><span class="p">[:,</span><span class="mi">3</span><span class="p">]</span>
        <span class="n">petro_h</span> <span class="o">=</span> <span class="n">ukidss_data</span><span class="p">[:,</span><span class="mi">4</span><span class="p">];</span> <span class="n">e_petro_h</span> <span class="o">=</span> <span class="n">ukidss_data</span><span class="p">[:,</span><span class="mi">5</span><span class="p">]</span>
        <span class="n">petro_k</span> <span class="o">=</span> <span class="n">ukidss_data</span><span class="p">[:,</span><span class="mi">6</span><span class="p">];</span> <span class="n">e_petro_k</span> <span class="o">=</span> <span class="n">ukidss_data</span><span class="p">[:,</span><span class="mi">7</span><span class="p">]</span>
        <span class="n">ukidss_ra</span> <span class="o">=</span> <span class="n">ukidss_data</span><span class="p">[:,</span><span class="mi">0</span><span class="p">];</span> <span class="n">ukidss_dec</span> <span class="o">=</span> <span class="n">ukidss_data</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span>

        <span class="n">nir_filter_index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">((</span><span class="n">petro_j</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">999999488</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">e_petro_j</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">999999488</span><span class="p">)</span> <span class="o">&amp;</span>\
                <span class="p">(</span><span class="n">petro_h</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">999999488</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">e_petro_h</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">999999488</span><span class="p">)</span> <span class="o">&amp;</span>\
                    <span class="p">(</span><span class="n">petro_k</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">999999488</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">e_petro_k</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">999999488</span><span class="p">)</span> <span class="o">&amp;</span>\
                        <span class="p">(</span><span class="n">e_petro_j</span> <span class="o">&lt;</span> <span class="mf">0.2</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">e_petro_h</span> <span class="o">&lt;</span> <span class="mf">0.2</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">e_petro_k</span> <span class="o">&lt;</span> <span class="mf">0.2</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">nir_filter_index</span><span class="p">)</span> <span class="o">==</span> <span class="mf">0.0</span><span class="p">:</span>

                <span class="n">new_nir_filter_index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">((</span><span class="n">petro_j</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">999999488</span><span class="p">)</span>\
                            <span class="o">&amp;</span> <span class="p">(</span><span class="n">petro_k</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">999999488</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">petro_h</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">999999488</span><span class="p">)</span> <span class="o">&amp;</span>\
                            <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">e_petro_j</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">0.2</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">e_petro_h</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">0.2</span><span class="p">)</span>\
                            <span class="o">&amp;</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">e_petro_k</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">0.2</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>

                <span class="n">e_petro_j</span> <span class="o">=</span> <span class="mf">0.005</span><span class="o">*</span><span class="n">petro_j</span><span class="p">[</span><span class="n">new_nir_filter_index</span><span class="p">]</span>
                <span class="n">e_petro_h</span> <span class="o">=</span> <span class="mf">0.05</span><span class="o">*</span><span class="n">petro_h</span><span class="p">[</span><span class="n">new_nir_filter_index</span><span class="p">]</span>
                <span class="n">e_petro_k</span> <span class="o">=</span> <span class="mf">0.05</span><span class="o">*</span><span class="n">petro_k</span><span class="p">[</span><span class="n">new_nir_filter_index</span><span class="p">]</span>

                <span class="nb">print</span><span class="p">(</span><span class="s2">""</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">'Number of sources in the NIR data = '</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">new_nir_filter_index</span><span class="p">))</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">""</span><span class="p">)</span>

                <span class="n">filtered_petro_j</span> <span class="o">=</span> <span class="n">petro_j</span><span class="p">[</span><span class="n">new_nir_filter_index</span><span class="p">]</span>
                <span class="n">filtered_petro_h</span> <span class="o">=</span> <span class="n">petro_h</span><span class="p">[</span><span class="n">new_nir_filter_index</span><span class="p">]</span>
                <span class="n">filtered_petro_k</span> <span class="o">=</span> <span class="n">petro_k</span><span class="p">[</span><span class="n">new_nir_filter_index</span><span class="p">]</span>
                <span class="n">filtered_ukidss_ra</span> <span class="o">=</span> <span class="n">ukidss_ra</span><span class="p">[</span><span class="n">new_nir_filter_index</span><span class="p">]</span>
                <span class="n">filtered_ukidss_dec</span> <span class="o">=</span> <span class="n">ukidss_dec</span><span class="p">[</span><span class="n">new_nir_filter_index</span><span class="p">]</span>

                <span class="n">binwidth</span><span class="o">=</span><span class="mf">0.5</span>
                <span class="n">binsj</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">filtered_petro_j</span><span class="p">),</span>\
                                  <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">filtered_petro_j</span><span class="p">)</span>\
                                    <span class="o">+</span> <span class="n">binwidth</span><span class="p">,</span> <span class="n">binwidth</span><span class="p">)</span>
                <span class="n">binsh</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">filtered_petro_h</span><span class="p">),</span>\
                                  <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">filtered_petro_h</span><span class="p">)</span>\
                                  <span class="o">+</span> <span class="n">binwidth</span><span class="p">,</span> <span class="n">binwidth</span><span class="p">)</span>
                <span class="n">binsk</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">filtered_petro_k</span><span class="p">),</span>\
                                  <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">filtered_petro_k</span><span class="p">)</span>\
                                  <span class="o">+</span> <span class="n">binwidth</span><span class="p">,</span> <span class="n">binwidth</span><span class="p">)</span>

                <span class="n">plt</span><span class="o">.</span><span class="n">clf</span><span class="p">()</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">filtered_petro_j</span><span class="p">,</span> <span class="n">bins</span> <span class="o">=</span> <span class="n">binsj</span><span class="p">,</span>\
                         <span class="n">facecolor</span><span class="o">=</span><span class="s1">'white'</span><span class="p">,</span> <span class="n">edgecolor</span> <span class="o">=</span> <span class="s1">'red'</span><span class="p">,</span>\
                        <span class="n">linestyle</span><span class="o">=</span><span class="s1">'--'</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">'Observed J'</span><span class="p">)</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">filtered_petro_h</span><span class="p">,</span> <span class="n">bins</span> <span class="o">=</span> <span class="n">binsh</span><span class="p">,</span>\
                         <span class="n">facecolor</span><span class="o">=</span><span class="s1">'white'</span><span class="p">,</span> <span class="n">edgecolor</span> <span class="o">=</span> <span class="s1">'blue'</span><span class="p">,</span>\
                        <span class="n">linestyle</span><span class="o">=</span><span class="s1">'--'</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">'Observed H'</span><span class="p">)</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">filtered_petro_k</span><span class="p">,</span> <span class="n">bins</span> <span class="o">=</span> <span class="n">binsk</span><span class="p">,</span>\
                         <span class="n">facecolor</span><span class="o">=</span><span class="s1">'white'</span><span class="p">,</span><span class="n">edgecolor</span> <span class="o">=</span> <span class="s1">'green'</span><span class="p">,</span>\
                        <span class="n">linestyle</span><span class="o">=</span><span class="s1">'--'</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">'Observed K'</span><span class="p">)</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">'petro magnitudes'</span><span class="p">)</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">'Bins'</span><span class="p">)</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">gird</span><span class="p">()</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">'best'</span><span class="p">)</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">'hist_ukidss_nir.png'</span><span class="p">)</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">clf</span><span class="p">()</span>

                <span class="n">nir_data</span> <span class="o">=</span>  <span class="n">filtered_petro_j</span><span class="p">,</span> <span class="n">filtered_petro_h</span><span class="p">,</span> <span class="n">filtered_petro_k</span><span class="p">,</span>\
                    <span class="n">e_petro_j</span><span class="p">,</span> <span class="n">e_petro_h</span><span class="p">,</span> <span class="n">e_petro_k</span><span class="p">,</span> <span class="n">filtered_ukidss_ra</span><span class="p">,</span> <span class="n">filtered_ukidss_dec</span>
        <span class="k">else</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">""</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">'Number of sources in the NIR data = '</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">nir_filter_index</span><span class="p">))</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">""</span><span class="p">)</span>

                <span class="n">filtered_petro_j</span> <span class="o">=</span> <span class="n">petro_j</span><span class="p">[</span><span class="n">nir_filter_index</span><span class="p">]</span>
                <span class="n">e_petro_h</span> <span class="o">=</span> <span class="n">e_petro_h</span><span class="p">[</span><span class="n">nir_filter_index</span><span class="p">]</span>
                <span class="n">filtered_petro_h</span> <span class="o">=</span> <span class="n">petro_h</span><span class="p">[</span><span class="n">nir_filter_index</span><span class="p">]</span>
                <span class="n">e_petro_k</span> <span class="o">=</span> <span class="n">e_petro_k</span><span class="p">[</span><span class="n">nir_filter_index</span><span class="p">]</span>
                <span class="n">filtered_petro_k</span> <span class="o">=</span> <span class="n">petro_k</span><span class="p">[</span><span class="n">nir_filter_index</span><span class="p">]</span>
                <span class="n">e_petro_j</span> <span class="o">=</span> <span class="n">e_petro_j</span><span class="p">[</span><span class="n">nir_filter_index</span><span class="p">]</span>
                <span class="n">filtered_ukidss_ra</span> <span class="o">=</span> <span class="n">ukidss_ra</span><span class="p">[</span><span class="n">nir_filter_index</span><span class="p">]</span>
                <span class="n">filtered_ukidss_dec</span> <span class="o">=</span> <span class="n">ukidss_dec</span><span class="p">[</span><span class="n">nir_filter_index</span><span class="p">]</span>

                <span class="n">binwidth</span><span class="o">=</span><span class="mf">0.5</span>
                <span class="n">binsj</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">filtered_petro_j</span><span class="p">),</span>\
                                  <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">filtered_petro_j</span><span class="p">)</span>\
                                    <span class="o">+</span> <span class="n">binwidth</span><span class="p">,</span> <span class="n">binwidth</span><span class="p">)</span>
                <span class="n">binsh</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">filtered_petro_h</span><span class="p">),</span>\
                                  <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">filtered_petro_h</span><span class="p">)</span>\
                                  <span class="o">+</span> <span class="n">binwidth</span><span class="p">,</span> <span class="n">binwidth</span><span class="p">)</span>
                <span class="n">binsk</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">filtered_petro_k</span><span class="p">),</span>\
                                  <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">filtered_petro_k</span><span class="p">)</span>\
                                  <span class="o">+</span> <span class="n">binwidth</span><span class="p">,</span> <span class="n">binwidth</span><span class="p">)</span>

                <span class="n">plt</span><span class="o">.</span><span class="n">clf</span><span class="p">()</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">filtered_petro_j</span><span class="p">,</span> <span class="n">bins</span> <span class="o">=</span> <span class="n">binsj</span><span class="p">,</span>\
                         <span class="n">facecolor</span><span class="o">=</span><span class="s1">'white'</span><span class="p">,</span> <span class="n">edgecolor</span> <span class="o">=</span> <span class="s1">'red'</span><span class="p">,</span>\
                        <span class="n">linestyle</span><span class="o">=</span><span class="s1">'--'</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">'Observed J'</span><span class="p">)</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">filtered_petro_h</span><span class="p">,</span> <span class="n">bins</span> <span class="o">=</span> <span class="n">binsh</span><span class="p">,</span>\
                         <span class="n">facecolor</span><span class="o">=</span><span class="s1">'white'</span><span class="p">,</span> <span class="n">edgecolor</span> <span class="o">=</span> <span class="s1">'blue'</span><span class="p">,</span>\
                        <span class="n">linestyle</span><span class="o">=</span><span class="s1">'--'</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">'Observed H'</span><span class="p">)</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">filtered_petro_k</span><span class="p">,</span> <span class="n">bins</span> <span class="o">=</span> <span class="n">binsk</span><span class="p">,</span>\
                         <span class="n">facecolor</span><span class="o">=</span><span class="s1">'white'</span><span class="p">,</span><span class="n">edgecolor</span> <span class="o">=</span> <span class="s1">'green'</span><span class="p">,</span>\
                        <span class="n">linestyle</span><span class="o">=</span><span class="s1">'--'</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">'Observed K'</span><span class="p">)</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">'petro magnitudes'</span><span class="p">)</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">'Bins'</span><span class="p">)</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">'best'</span><span class="p">)</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">'hist_ukidss_nir.png'</span><span class="p">)</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">clf</span><span class="p">()</span>

                <span class="n">nir_data</span> <span class="o">=</span>  <span class="n">filtered_petro_j</span><span class="p">,</span> <span class="n">filtered_petro_h</span><span class="p">,</span> <span class="n">filtered_petro_k</span><span class="p">,</span>\
                    <span class="n">e_petro_j</span><span class="p">,</span> <span class="n">e_petro_h</span><span class="p">,</span> <span class="n">e_petro_k</span><span class="p">,</span> <span class="n">filtered_ukidss_ra</span><span class="p">,</span> <span class="n">filtered_ukidss_dec</span>

    <span class="k">elif</span> <span class="n">file_exists</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">""</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">'Reading the validated catalogue file:'</span><span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">file_name</span><span class="p">))</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">""</span><span class="p">)</span>
            <span class="n">ukidss_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">genfromtxt</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">file_name</span><span class="p">),</span> <span class="n">delimiter</span><span class="o">=</span><span class="s1">','</span><span class="p">,</span> <span class="n">skip_header</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">ukidss_data</span><span class="p">)</span><span class="o">&lt;</span><span class="mf">9.0</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">'No observations in UKIDSS'</span><span class="p">)</span>
                <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
            <span class="n">petro_j</span> <span class="o">=</span> <span class="n">ukidss_data</span><span class="p">[:,</span><span class="mi">2</span><span class="p">];</span> <span class="n">e_petro_j</span> <span class="o">=</span> <span class="n">ukidss_data</span><span class="p">[:,</span><span class="mi">3</span><span class="p">]</span>
            <span class="n">petro_h</span> <span class="o">=</span> <span class="n">ukidss_data</span><span class="p">[:,</span><span class="mi">4</span><span class="p">];</span> <span class="n">e_petro_h</span> <span class="o">=</span> <span class="n">ukidss_data</span><span class="p">[:,</span><span class="mi">5</span><span class="p">]</span>
            <span class="n">petro_k</span> <span class="o">=</span> <span class="n">ukidss_data</span><span class="p">[:,</span><span class="mi">6</span><span class="p">];</span> <span class="n">e_petro_k</span> <span class="o">=</span> <span class="n">ukidss_data</span><span class="p">[:,</span><span class="mi">7</span><span class="p">]</span>
            <span class="n">ukidss_ra</span> <span class="o">=</span> <span class="n">ukidss_data</span><span class="p">[:,</span><span class="mi">0</span><span class="p">];</span> <span class="n">ukidss_dec</span> <span class="o">=</span> <span class="n">ukidss_data</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span>

            <span class="n">nir_filter_index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">((</span><span class="n">petro_j</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">999999488</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">e_petro_j</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">999999488</span><span class="p">)</span> <span class="o">&amp;</span>\
                <span class="p">(</span><span class="n">petro_h</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">999999488</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">e_petro_h</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">999999488</span><span class="p">)</span> <span class="o">&amp;</span>\
                    <span class="p">(</span><span class="n">petro_k</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">999999488</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">e_petro_k</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">999999488</span><span class="p">)</span> <span class="o">&amp;</span>\
                        <span class="p">(</span><span class="n">e_petro_j</span> <span class="o">&lt;</span> <span class="mf">0.2</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">e_petro_h</span> <span class="o">&lt;</span> <span class="mf">0.2</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">e_petro_k</span> <span class="o">&lt;</span> <span class="mf">0.2</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">nir_filter_index</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>

                <span class="n">new_nir_filter_index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">((</span><span class="n">petro_j</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">999999488</span><span class="p">)</span>\
                                    <span class="o">&amp;</span> <span class="p">(</span><span class="n">petro_k</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">999999488</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">petro_h</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">999999488</span><span class="p">)</span> <span class="o">&amp;</span>\
                                        <span class="p">(</span><span class="n">e_petro_j</span> <span class="o">&lt;</span> <span class="mf">0.2</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">e_petro_h</span> <span class="o">&lt;</span> <span class="mf">0.2</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">e_petro_k</span> <span class="o">&lt;</span> <span class="mf">0.2</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">e_petro_j</span> <span class="o">=</span> <span class="mf">0.005</span><span class="o">*</span><span class="n">petro_j</span><span class="p">[</span><span class="n">new_nir_filter_index</span><span class="p">]</span>
                <span class="n">e_petro_h</span> <span class="o">=</span> <span class="mf">0.05</span><span class="o">*</span><span class="n">petro_h</span><span class="p">[</span><span class="n">new_nir_filter_index</span><span class="p">]</span>
                <span class="n">e_petro_k</span> <span class="o">=</span> <span class="mf">0.05</span><span class="o">*</span><span class="n">petro_k</span><span class="p">[</span><span class="n">new_nir_filter_index</span><span class="p">]</span>

                <span class="nb">print</span><span class="p">(</span><span class="s2">""</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">'Number of sources in the NIR data = '</span><span class="p">,</span>\
                      <span class="nb">len</span><span class="p">(</span><span class="n">new_nir_filter_index</span><span class="p">))</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">""</span><span class="p">)</span>

                <span class="n">filtered_petro_j</span> <span class="o">=</span> <span class="n">petro_j</span><span class="p">[</span><span class="n">new_nir_filter_index</span><span class="p">]</span>
                <span class="n">filtered_petro_h</span> <span class="o">=</span> <span class="n">petro_h</span><span class="p">[</span><span class="n">new_nir_filter_index</span><span class="p">]</span>
                <span class="n">filtered_petro_k</span> <span class="o">=</span> <span class="n">petro_k</span><span class="p">[</span><span class="n">new_nir_filter_index</span><span class="p">]</span>
                <span class="n">filtered_ukidss_ra</span> <span class="o">=</span> <span class="n">ukidss_ra</span><span class="p">[</span><span class="n">new_nir_filter_index</span><span class="p">]</span>
                <span class="n">filtered_ukidss_dec</span> <span class="o">=</span> <span class="n">ukidss_dec</span><span class="p">[</span><span class="n">new_nir_filter_index</span><span class="p">]</span>

                <span class="n">binwidth</span><span class="o">=</span><span class="mf">0.5</span>
                <span class="n">binsj</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">filtered_petro_j</span><span class="p">),</span>\
                                  <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">filtered_petro_j</span><span class="p">)</span>\
                                    <span class="o">+</span> <span class="n">binwidth</span><span class="p">,</span> <span class="n">binwidth</span><span class="p">)</span>
                <span class="n">binsh</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">filtered_petro_h</span><span class="p">),</span>\
                                  <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">filtered_petro_h</span><span class="p">)</span>\
                                  <span class="o">+</span> <span class="n">binwidth</span><span class="p">,</span> <span class="n">binwidth</span><span class="p">)</span>
                <span class="n">binsk</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">filtered_petro_k</span><span class="p">),</span>\
                                  <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">filtered_petro_k</span><span class="p">)</span>\
                                  <span class="o">+</span> <span class="n">binwidth</span><span class="p">,</span> <span class="n">binwidth</span><span class="p">)</span>

                <span class="n">plt</span><span class="o">.</span><span class="n">clf</span><span class="p">()</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">filtered_petro_j</span><span class="p">,</span> <span class="n">bins</span> <span class="o">=</span> <span class="n">binsj</span><span class="p">,</span>\
                         <span class="n">facecolor</span><span class="o">=</span><span class="s1">'white'</span><span class="p">,</span> <span class="n">edgecolor</span> <span class="o">=</span> <span class="s1">'red'</span><span class="p">,</span>\
                        <span class="n">linestyle</span><span class="o">=</span><span class="s1">'--'</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">'Observed J'</span><span class="p">)</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">filtered_petro_h</span><span class="p">,</span> <span class="n">bins</span> <span class="o">=</span> <span class="n">binsh</span><span class="p">,</span>\
                         <span class="n">facecolor</span><span class="o">=</span><span class="s1">'white'</span><span class="p">,</span> <span class="n">edgecolor</span> <span class="o">=</span> <span class="s1">'blue'</span><span class="p">,</span>\
                        <span class="n">linestyle</span><span class="o">=</span><span class="s1">'--'</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">'Observed H'</span><span class="p">)</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">filtered_petro_k</span><span class="p">,</span> <span class="n">bins</span> <span class="o">=</span> <span class="n">binsk</span><span class="p">,</span>\
                         <span class="n">facecolor</span><span class="o">=</span><span class="s1">'white'</span><span class="p">,</span><span class="n">edgecolor</span> <span class="o">=</span> <span class="s1">'green'</span><span class="p">,</span>\
                        <span class="n">linestyle</span><span class="o">=</span><span class="s1">'--'</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">'Observed K'</span><span class="p">)</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">'petro magnitudes'</span><span class="p">)</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">'Bins'</span><span class="p">)</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">'best'</span><span class="p">)</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">'hist_ukidss_nir.png'</span><span class="p">)</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">clf</span><span class="p">()</span>

                <span class="n">nir_data</span> <span class="o">=</span>  <span class="n">filtered_petro_j</span><span class="p">,</span> <span class="n">filtered_petro_h</span><span class="p">,</span> <span class="n">filtered_petro_k</span><span class="p">,</span>\
                    <span class="n">e_petro_j</span><span class="p">,</span> <span class="n">e_petro_h</span><span class="p">,</span> <span class="n">e_petro_k</span><span class="p">,</span> <span class="n">filtered_ukidss_ra</span><span class="p">,</span> <span class="n">filtered_ukidss_dec</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">""</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">'Number of sources in the NIR data = '</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">nir_filter_index</span><span class="p">))</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">""</span><span class="p">)</span>

                <span class="n">filtered_petro_j</span> <span class="o">=</span> <span class="n">petro_j</span><span class="p">[</span><span class="n">nir_filter_index</span><span class="p">]</span>
                <span class="n">e_petro_h</span> <span class="o">=</span> <span class="n">e_petro_h</span><span class="p">[</span><span class="n">nir_filter_index</span><span class="p">]</span>
                <span class="n">filtered_petro_h</span> <span class="o">=</span> <span class="n">petro_h</span><span class="p">[</span><span class="n">nir_filter_index</span><span class="p">]</span>
                <span class="n">e_petro_k</span> <span class="o">=</span> <span class="n">e_petro_k</span><span class="p">[</span><span class="n">nir_filter_index</span><span class="p">]</span>
                <span class="n">filtered_petro_k</span> <span class="o">=</span> <span class="n">petro_k</span><span class="p">[</span><span class="n">nir_filter_index</span><span class="p">]</span>
                <span class="n">e_petro_j</span> <span class="o">=</span> <span class="n">e_petro_j</span><span class="p">[</span><span class="n">nir_filter_index</span><span class="p">]</span>
                <span class="n">filtered_ukidss_ra</span> <span class="o">=</span> <span class="n">ukidss_ra</span><span class="p">[</span><span class="n">nir_filter_index</span><span class="p">]</span>
                <span class="n">filtered_ukidss_dec</span> <span class="o">=</span> <span class="n">ukidss_dec</span><span class="p">[</span><span class="n">nir_filter_index</span><span class="p">]</span>

                <span class="n">binwidth</span><span class="o">=</span><span class="mf">0.5</span>
                <span class="n">binsj</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">filtered_petro_j</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">filtered_petro_j</span><span class="p">)</span> <span class="o">+</span> <span class="n">binwidth</span><span class="p">,</span> <span class="n">binwidth</span><span class="p">)</span>
                <span class="n">binsh</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">filtered_petro_h</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">filtered_petro_h</span><span class="p">)</span> <span class="o">+</span> <span class="n">binwidth</span><span class="p">,</span> <span class="n">binwidth</span><span class="p">)</span>
                <span class="n">binsk</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">filtered_petro_k</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">filtered_petro_k</span><span class="p">)</span> <span class="o">+</span> <span class="n">binwidth</span><span class="p">,</span> <span class="n">binwidth</span><span class="p">)</span>

                <span class="n">plt</span><span class="o">.</span><span class="n">clf</span><span class="p">()</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">filtered_petro_j</span><span class="p">,</span> <span class="n">bins</span> <span class="o">=</span> <span class="n">binsj</span><span class="p">,</span>\
                         <span class="n">facecolor</span><span class="o">=</span><span class="s1">'white'</span><span class="p">,</span> <span class="n">edgecolor</span> <span class="o">=</span> <span class="s1">'red'</span><span class="p">,</span>\
                            <span class="n">linestyle</span><span class="o">=</span><span class="s1">'--'</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">'Observed J'</span><span class="p">)</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">filtered_petro_h</span><span class="p">,</span> <span class="n">bins</span> <span class="o">=</span> <span class="n">binsh</span><span class="p">,</span>\
                         <span class="n">facecolor</span><span class="o">=</span><span class="s1">'white'</span><span class="p">,</span> <span class="n">edgecolor</span> <span class="o">=</span> <span class="s1">'blue'</span><span class="p">,</span>\
                            <span class="n">linestyle</span><span class="o">=</span><span class="s1">'--'</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">'Observed H'</span><span class="p">)</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">filtered_petro_k</span><span class="p">,</span> <span class="n">bins</span> <span class="o">=</span> <span class="n">binsk</span><span class="p">,</span>\
                         <span class="n">facecolor</span><span class="o">=</span><span class="s1">'white'</span><span class="p">,</span> <span class="n">edgecolor</span> <span class="o">=</span> <span class="s1">'green'</span><span class="p">,</span>\
                            <span class="n">linestyle</span><span class="o">=</span><span class="s1">'--'</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">'Observed K'</span><span class="p">)</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">'petro magnitudes'</span><span class="p">)</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">'Bins'</span><span class="p">)</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">'best'</span><span class="p">)</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">'hist_ukidss_nir.png'</span><span class="p">)</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">clf</span><span class="p">()</span>

                <span class="n">nir_data</span> <span class="o">=</span>  <span class="n">filtered_petro_j</span><span class="p">,</span> <span class="n">filtered_petro_h</span><span class="p">,</span> <span class="n">filtered_petro_k</span><span class="p">,</span>\
                    <span class="n">e_petro_j</span><span class="p">,</span> <span class="n">e_petro_h</span><span class="p">,</span> <span class="n">e_petro_k</span><span class="p">,</span> <span class="n">filtered_ukidss_ra</span><span class="p">,</span> <span class="n">filtered_ukidss_dec</span>
    <span class="k">return</span> <span class="n">nir_data</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="irgsctool._read_data.ReadData.read_optical_data">
<code class="highlight language-python"><span class="n">read_optical_data</span><span class="p">()</span></code>
</h3>
<div class="doc doc-contents">
<h5 id="irgsctool._read_data.ReadData.read_optical_data--irgsctoolreaddataread_optical_data"><code>irgsctool.ReadData.read_optical_data()</code></h5>
<p><justify> 
This function reads the input optical PANSTARRS data.
The number of columns in the input file are 32.
After reading the input data, this function filters it for
nan values (if present) and restricts the data to the sources having
detection in all the five bands and that have SNR atleast 5.
This data is then fed to the Star-Galaxy classification routine to
seperate stars and galaxies in the data. &lt;\justify&gt;</justify></p>
<p><strong>Raises:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<code>FileNotFoundError</code>
</td>
<td><p>if the optical input data file is not available.</p></td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>irgsctool/_read_data.py</code></summary>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">read_optical_data</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">        `irgsctool.ReadData.read_optical_data()`</span>
<span class="sd">        ------------------------------------------</span>

<span class="sd">        &lt;justify&gt; </span>
<span class="sd">        This function reads the input optical PANSTARRS data.</span>
<span class="sd">        The number of columns in the input file are 32.</span>
<span class="sd">        After reading the input data, this function filters it for</span>
<span class="sd">        nan values (if present) and restricts the data to the sources having</span>
<span class="sd">        detection in all the five bands and that have SNR atleast 5.</span>
<span class="sd">        This data is then fed to the Star-Galaxy classification routine to</span>
<span class="sd">        seperate stars and galaxies in the data. &lt;\justify&gt;</span>

<span class="sd">        Raises:</span>
<span class="sd">            FileNotFoundError: if the optical input data file is not available.</span>
<span class="sd">    """</span>
    <span class="n">ra_name</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ra</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">'.'</span><span class="p">,</span><span class="s1">'_'</span><span class="p">)</span>
    <span class="n">dec_name</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dec</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">'.'</span><span class="p">,</span> <span class="s1">'_'</span><span class="p">)</span>
    <span class="n">file_name</span> <span class="o">=</span> <span class="s1">'PS1'</span> <span class="o">+</span> <span class="s1">'_'</span> <span class="o">+</span> <span class="s1">'RA'</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ra_name</span><span class="p">)</span> <span class="o">+</span> <span class="s1">'DEC'</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">dec_name</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">ps1_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">genfromtxt</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">file_name</span><span class="p">)</span> <span class="o">+</span><span class="s1">'.csv'</span><span class="p">,</span>\
                                 <span class="n">delimiter</span><span class="o">=</span><span class="s1">','</span><span class="p">,</span> <span class="n">skip_header</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

    <span class="k">except</span> <span class="ne">FileNotFoundError</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gd</span><span class="o">.</span><span class="n">get_panstarrs_data</span><span class="p">()</span>
        <span class="n">ps1_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">genfromtxt</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">file_name</span><span class="p">)</span> <span class="o">+</span><span class="s1">'.csv'</span><span class="p">,</span>\
                                 <span class="n">delimiter</span><span class="o">=</span><span class="s1">','</span><span class="p">,</span> <span class="n">skip_header</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">ps1_objid</span> <span class="o">=</span> <span class="n">ps1_data</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">ps_ra</span> <span class="o">=</span> <span class="n">ps1_data</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">err_ps_ra</span> <span class="o">=</span> <span class="n">ps1_data</span><span class="p">[:,</span><span class="mi">2</span><span class="p">]</span>
    <span class="n">ps_dec</span> <span class="o">=</span> <span class="n">ps1_data</span><span class="p">[:,</span><span class="mi">3</span><span class="p">]</span>
    <span class="n">err_ps_dec</span> <span class="o">=</span> <span class="n">ps1_data</span><span class="p">[:,</span><span class="mi">4</span><span class="p">]</span>
    <span class="n">gmag</span> <span class="o">=</span> <span class="n">ps1_data</span><span class="p">[:,</span><span class="mi">5</span><span class="p">]</span>
    <span class="n">e_gmag</span> <span class="o">=</span> <span class="n">ps1_data</span><span class="p">[:,</span><span class="mi">6</span><span class="p">]</span>
    <span class="n">gkron</span> <span class="o">=</span> <span class="n">ps1_data</span><span class="p">[:,</span><span class="mi">7</span><span class="p">]</span>
    <span class="n">e_gkron</span> <span class="o">=</span> <span class="n">ps1_data</span><span class="p">[:,</span><span class="mi">8</span><span class="p">]</span>
    <span class="n">rmag</span> <span class="o">=</span> <span class="n">ps1_data</span><span class="p">[:,</span><span class="mi">9</span><span class="p">]</span>
    <span class="n">e_rmag</span> <span class="o">=</span> <span class="n">ps1_data</span><span class="p">[:,</span><span class="mi">10</span><span class="p">]</span>
    <span class="n">rkron</span> <span class="o">=</span> <span class="n">ps1_data</span><span class="p">[:,</span><span class="mi">11</span><span class="p">]</span>
    <span class="n">e_rkron</span> <span class="o">=</span> <span class="n">ps1_data</span><span class="p">[:,</span><span class="mi">12</span><span class="p">]</span>
    <span class="n">imag</span> <span class="o">=</span> <span class="n">ps1_data</span><span class="p">[:,</span><span class="mi">13</span><span class="p">]</span>
    <span class="n">e_imag</span> <span class="o">=</span> <span class="n">ps1_data</span><span class="p">[:,</span><span class="mi">14</span><span class="p">]</span>
    <span class="n">ikron</span> <span class="o">=</span> <span class="n">ps1_data</span><span class="p">[:,</span><span class="mi">15</span><span class="p">]</span>
    <span class="n">e_ikron</span> <span class="o">=</span> <span class="n">ps1_data</span><span class="p">[:,</span><span class="mi">16</span><span class="p">]</span>
    <span class="n">zmag</span> <span class="o">=</span> <span class="n">ps1_data</span><span class="p">[:,</span><span class="mi">17</span><span class="p">]</span>
    <span class="n">e_zmag</span> <span class="o">=</span> <span class="n">ps1_data</span><span class="p">[:,</span><span class="mi">18</span><span class="p">]</span>
    <span class="n">zkron</span> <span class="o">=</span> <span class="n">ps1_data</span><span class="p">[:,</span><span class="mi">19</span><span class="p">]</span>
    <span class="n">e_zkron</span> <span class="o">=</span> <span class="n">ps1_data</span><span class="p">[:,</span><span class="mi">20</span><span class="p">]</span>
    <span class="n">ymag</span> <span class="o">=</span> <span class="n">ps1_data</span><span class="p">[:,</span><span class="mi">21</span><span class="p">]</span>
    <span class="n">e_ymag</span> <span class="o">=</span> <span class="n">ps1_data</span><span class="p">[:,</span><span class="mi">22</span><span class="p">]</span>
    <span class="n">ykron</span> <span class="o">=</span> <span class="n">ps1_data</span><span class="p">[:,</span><span class="mi">23</span><span class="p">]</span>
    <span class="n">e_ykron</span> <span class="o">=</span> <span class="n">ps1_data</span><span class="p">[:,</span><span class="mi">24</span><span class="p">]</span>
    <span class="n">objinfoflag</span> <span class="o">=</span> <span class="n">ps1_data</span><span class="p">[:,</span><span class="mi">25</span><span class="p">]</span>
    <span class="n">qualityflag</span> <span class="o">=</span> <span class="n">ps1_data</span><span class="p">[:,</span><span class="mi">26</span><span class="p">]</span>
    <span class="n">ndetections</span> <span class="o">=</span> <span class="n">ps1_data</span><span class="p">[:,</span><span class="mi">27</span><span class="p">]</span>
    <span class="n">nstackdetections</span> <span class="o">=</span> <span class="n">ps1_data</span><span class="p">[:,</span><span class="mi">28</span><span class="p">]</span>
    <span class="n">ginfoflag</span> <span class="o">=</span> <span class="n">ps1_data</span><span class="p">[:,</span><span class="mi">29</span><span class="p">]</span>
    <span class="n">ginfoflag2</span> <span class="o">=</span> <span class="n">ps1_data</span><span class="p">[:,</span><span class="mi">30</span><span class="p">]</span>
    <span class="n">ginfoflag3</span> <span class="o">=</span> <span class="n">ps1_data</span><span class="p">[:,</span><span class="mi">31</span><span class="p">]</span>
    <span class="n">rinfoflag</span> <span class="o">=</span> <span class="n">ps1_data</span><span class="p">[:,</span><span class="mi">32</span><span class="p">]</span>
    <span class="n">rinfoflag2</span> <span class="o">=</span> <span class="n">ps1_data</span><span class="p">[:,</span><span class="mi">33</span><span class="p">]</span>
    <span class="n">rinfoflag3</span> <span class="o">=</span> <span class="n">ps1_data</span><span class="p">[:,</span><span class="mi">34</span><span class="p">]</span>
    <span class="n">iinfoflag</span> <span class="o">=</span> <span class="n">ps1_data</span><span class="p">[:,</span><span class="mi">35</span><span class="p">]</span>
    <span class="n">iinfoflag2</span> <span class="o">=</span> <span class="n">ps1_data</span><span class="p">[:,</span><span class="mi">36</span><span class="p">]</span>
    <span class="n">iinfoflag3</span> <span class="o">=</span> <span class="n">ps1_data</span><span class="p">[:,</span><span class="mi">37</span><span class="p">]</span>
    <span class="n">zinfoflag</span> <span class="o">=</span> <span class="n">ps1_data</span><span class="p">[:,</span><span class="mi">38</span><span class="p">]</span>
    <span class="n">zinfoflag2</span> <span class="o">=</span> <span class="n">ps1_data</span><span class="p">[:,</span><span class="mi">39</span><span class="p">]</span>
    <span class="n">zinfoflag3</span> <span class="o">=</span> <span class="n">ps1_data</span><span class="p">[:,</span><span class="mi">40</span><span class="p">]</span>
    <span class="n">yinfoflag</span> <span class="o">=</span> <span class="n">ps1_data</span><span class="p">[:,</span><span class="mi">41</span><span class="p">]</span>
    <span class="n">yinfoflag2</span> <span class="o">=</span> <span class="n">ps1_data</span><span class="p">[:,</span><span class="mi">42</span><span class="p">]</span>
    <span class="n">yinfoflag3</span> <span class="o">=</span> <span class="n">ps1_data</span><span class="p">[:,</span><span class="mi">43</span><span class="p">]</span>

    <span class="n">ps1_data</span> <span class="o">=</span> <span class="n">ps1_objid</span><span class="p">,</span> <span class="n">ps_ra</span><span class="p">,</span> <span class="n">err_ps_ra</span><span class="p">,</span> <span class="n">ps_dec</span><span class="p">,</span> <span class="n">err_ps_dec</span><span class="p">,</span> <span class="n">gmag</span><span class="p">,</span>\
        <span class="n">e_gmag</span><span class="p">,</span> <span class="n">gkron</span><span class="p">,</span> <span class="n">e_gkron</span><span class="p">,</span> <span class="n">rmag</span><span class="p">,</span> <span class="n">e_rmag</span><span class="p">,</span> <span class="n">rkron</span><span class="p">,</span> <span class="n">e_rkron</span><span class="p">,</span> <span class="n">imag</span><span class="p">,</span>\
        <span class="n">e_imag</span><span class="p">,</span> <span class="n">ikron</span><span class="p">,</span> <span class="n">e_ikron</span><span class="p">,</span> <span class="n">zmag</span><span class="p">,</span> <span class="n">e_zmag</span><span class="p">,</span> <span class="n">zkron</span><span class="p">,</span> <span class="n">e_zkron</span><span class="p">,</span> <span class="n">ymag</span><span class="p">,</span>\
        <span class="n">e_ymag</span><span class="p">,</span> <span class="n">ykron</span><span class="p">,</span> <span class="n">e_ykron</span><span class="p">,</span> <span class="n">objinfoflag</span><span class="p">,</span> <span class="n">qualityflag</span><span class="p">,</span> <span class="n">ndetections</span><span class="p">,</span>\
        <span class="n">nstackdetections</span><span class="p">,</span> <span class="n">ginfoflag</span><span class="p">,</span> <span class="n">ginfoflag2</span><span class="p">,</span> <span class="n">ginfoflag3</span><span class="p">,</span> <span class="n">rinfoflag</span><span class="p">,</span>\
        <span class="n">rinfoflag2</span><span class="p">,</span> <span class="n">rinfoflag3</span><span class="p">,</span> <span class="n">iinfoflag</span><span class="p">,</span> <span class="n">iinfoflag2</span><span class="p">,</span> <span class="n">iinfoflag3</span><span class="p">,</span>\
        <span class="n">zinfoflag</span><span class="p">,</span> <span class="n">zinfoflag2</span><span class="p">,</span> <span class="n">zinfoflag3</span><span class="p">,</span> <span class="n">yinfoflag</span><span class="p">,</span> <span class="n">yinfoflag2</span><span class="p">,</span>\
        <span class="n">yinfoflag3</span>

    <span class="nb">print</span><span class="p">(</span><span class="s1">'Number of rows in the PANSTARRS file:'</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">ps1_objid</span><span class="p">))</span>

    <span class="n">oid1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">ps1_objid</span><span class="p">))])[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">oid1</span> <span class="o">=</span> <span class="p">[</span><span class="o">*</span><span class="nb">set</span><span class="p">(</span><span class="n">ps1_objid</span><span class="p">)]</span>
    <span class="n">ptsf</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">oid1</span><span class="p">)):</span>
        <span class="n">ptsi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">oid1</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">==</span><span class="n">ps1_objid</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">ptsi</span><span class="p">)</span><span class="o">&gt;</span><span class="mf">1.0</span><span class="p">:</span>
            <span class="n">ptsi</span> <span class="o">=</span> <span class="n">ptsi</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">ptsf</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ptsf</span><span class="p">,</span> <span class="n">ptsi</span><span class="p">)</span>
            <span class="n">ptsf</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">int64</span><span class="p">(</span><span class="n">ptsf</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
             <span class="n">ptsf</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ptsf</span><span class="p">,</span> <span class="n">ptsi</span><span class="p">)</span>

    <span class="n">ps1_objid</span> <span class="o">=</span> <span class="n">ps1_objid</span><span class="p">[</span><span class="n">ptsf</span><span class="p">]</span>
    <span class="n">ps_ra</span> <span class="o">=</span> <span class="n">ps_ra</span><span class="p">[</span><span class="n">ptsf</span><span class="p">]</span>
    <span class="n">ps_dec</span> <span class="o">=</span> <span class="n">ps_dec</span><span class="p">[</span><span class="n">ptsf</span><span class="p">]</span>
    <span class="n">err_ps_ra</span> <span class="o">=</span> <span class="n">err_ps_ra</span><span class="p">[</span><span class="n">ptsf</span><span class="p">]</span>
    <span class="n">err_ps_dec</span> <span class="o">=</span> <span class="n">err_ps_dec</span><span class="p">[</span><span class="n">ptsf</span><span class="p">]</span>
    <span class="n">gmag</span> <span class="o">=</span> <span class="n">gmag</span><span class="p">[</span><span class="n">ptsf</span><span class="p">]</span>
    <span class="n">gkron</span> <span class="o">=</span> <span class="n">gkron</span><span class="p">[</span><span class="n">ptsf</span><span class="p">]</span>
    <span class="n">e_gmag</span> <span class="o">=</span> <span class="n">e_gmag</span><span class="p">[</span><span class="n">ptsf</span><span class="p">]</span>
    <span class="n">e_gkron</span> <span class="o">=</span> <span class="n">e_gkron</span><span class="p">[</span><span class="n">ptsf</span><span class="p">]</span>
    <span class="n">rmag</span> <span class="o">=</span> <span class="n">rmag</span><span class="p">[</span><span class="n">ptsf</span><span class="p">]</span>
    <span class="n">rkron</span> <span class="o">=</span> <span class="n">rkron</span><span class="p">[</span><span class="n">ptsf</span><span class="p">]</span>
    <span class="n">e_rmag</span> <span class="o">=</span> <span class="n">e_rmag</span><span class="p">[</span><span class="n">ptsf</span><span class="p">]</span>
    <span class="n">e_rkron</span> <span class="o">=</span> <span class="n">e_rkron</span><span class="p">[</span><span class="n">ptsf</span><span class="p">]</span>
    <span class="n">imag</span> <span class="o">=</span> <span class="n">imag</span><span class="p">[</span><span class="n">ptsf</span><span class="p">]</span>
    <span class="n">ikron</span> <span class="o">=</span> <span class="n">ikron</span><span class="p">[</span><span class="n">ptsf</span><span class="p">]</span>
    <span class="n">e_imag</span> <span class="o">=</span> <span class="n">e_imag</span><span class="p">[</span><span class="n">ptsf</span><span class="p">]</span>
    <span class="n">e_ikron</span> <span class="o">=</span> <span class="n">e_ikron</span><span class="p">[</span><span class="n">ptsf</span><span class="p">]</span>
    <span class="n">zmag</span> <span class="o">=</span> <span class="n">zmag</span><span class="p">[</span><span class="n">ptsf</span><span class="p">]</span>
    <span class="n">zkron</span> <span class="o">=</span> <span class="n">zkron</span><span class="p">[</span><span class="n">ptsf</span><span class="p">]</span>
    <span class="n">e_zmag</span> <span class="o">=</span> <span class="n">e_zmag</span><span class="p">[</span><span class="n">ptsf</span><span class="p">]</span>
    <span class="n">e_zkron</span> <span class="o">=</span> <span class="n">e_zkron</span><span class="p">[</span><span class="n">ptsf</span><span class="p">]</span>
    <span class="n">ymag</span> <span class="o">=</span> <span class="n">ymag</span><span class="p">[</span><span class="n">ptsf</span><span class="p">]</span>
    <span class="n">ykron</span> <span class="o">=</span> <span class="n">ykron</span><span class="p">[</span><span class="n">ptsf</span><span class="p">]</span>
    <span class="n">e_ymag</span> <span class="o">=</span> <span class="n">e_ymag</span><span class="p">[</span><span class="n">ptsf</span><span class="p">]</span>
    <span class="n">e_ykron</span> <span class="o">=</span> <span class="n">e_ykron</span><span class="p">[</span><span class="n">ptsf</span><span class="p">]</span>
    <span class="n">objinfoflag</span> <span class="o">=</span> <span class="n">objinfoflag</span><span class="p">[</span><span class="n">ptsf</span><span class="p">]</span>
    <span class="n">qualityflag</span> <span class="o">=</span> <span class="n">qualityflag</span><span class="p">[</span><span class="n">ptsf</span><span class="p">]</span>
    <span class="n">ndetections</span> <span class="o">=</span> <span class="n">ndetections</span><span class="p">[</span><span class="n">ptsf</span><span class="p">]</span>
    <span class="n">nstackdetections</span> <span class="o">=</span> <span class="n">nstackdetections</span><span class="p">[</span><span class="n">ptsf</span><span class="p">]</span>
    <span class="n">ginfoflag</span> <span class="o">=</span> <span class="n">ginfoflag</span><span class="p">[</span><span class="n">ptsf</span><span class="p">]</span>
    <span class="n">ginfoflag2</span> <span class="o">=</span> <span class="n">ginfoflag2</span><span class="p">[</span><span class="n">ptsf</span><span class="p">]</span>
    <span class="n">ginfoflag3</span> <span class="o">=</span> <span class="n">ginfoflag3</span><span class="p">[</span><span class="n">ptsf</span><span class="p">]</span>
    <span class="n">rinfoflag</span> <span class="o">=</span> <span class="n">rinfoflag</span><span class="p">[</span><span class="n">ptsf</span><span class="p">]</span>
    <span class="n">rinfoflag2</span> <span class="o">=</span> <span class="n">rinfoflag2</span><span class="p">[</span><span class="n">ptsf</span><span class="p">]</span>
    <span class="n">rinfoflag3</span> <span class="o">=</span> <span class="n">rinfoflag3</span><span class="p">[</span><span class="n">ptsf</span><span class="p">]</span>
    <span class="n">iinfoflag</span> <span class="o">=</span> <span class="n">iinfoflag</span><span class="p">[</span><span class="n">ptsf</span><span class="p">]</span>
    <span class="n">iinfoflag2</span> <span class="o">=</span> <span class="n">iinfoflag2</span><span class="p">[</span><span class="n">ptsf</span><span class="p">]</span>
    <span class="n">iinfoflag3</span> <span class="o">=</span> <span class="n">iinfoflag3</span><span class="p">[</span><span class="n">ptsf</span><span class="p">]</span>
    <span class="n">zinfoflag</span> <span class="o">=</span> <span class="n">zinfoflag</span><span class="p">[</span><span class="n">ptsf</span><span class="p">]</span>
    <span class="n">zinfoflag2</span> <span class="o">=</span> <span class="n">zinfoflag2</span><span class="p">[</span><span class="n">ptsf</span><span class="p">]</span>
    <span class="n">zinfoflag3</span> <span class="o">=</span> <span class="n">zinfoflag3</span><span class="p">[</span><span class="n">ptsf</span><span class="p">]</span>
    <span class="n">yinfoflag</span> <span class="o">=</span> <span class="n">yinfoflag</span><span class="p">[</span><span class="n">ptsf</span><span class="p">]</span>
    <span class="n">yinfoflag2</span> <span class="o">=</span> <span class="n">yinfoflag2</span><span class="p">[</span><span class="n">ptsf</span><span class="p">]</span>
    <span class="n">yinfoflag3</span> <span class="o">=</span> <span class="n">yinfoflag3</span><span class="p">[</span><span class="n">ptsf</span><span class="p">]</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">""</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">'Now filtering the optical data for nan values'</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">""</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">'Number of sources in the PANSTARRS data:'</span><span class="p">,</span>\
          <span class="nb">len</span><span class="p">(</span><span class="n">ps1_objid</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">""</span><span class="p">)</span>

    <span class="n">indices_only_ifilered</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">imag</span><span class="o">!=</span> <span class="o">-</span><span class="mi">999</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">binwidth</span><span class="o">=</span><span class="mf">0.5</span>
    <span class="n">bins</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">imag</span><span class="p">[</span><span class="n">indices_only_ifilered</span><span class="p">]),</span>\
                     <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">imag</span><span class="p">[</span><span class="n">indices_only_ifilered</span><span class="p">])</span> <span class="o">+</span>\
                        <span class="n">binwidth</span><span class="p">,</span> <span class="n">binwidth</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">clf</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">imag</span><span class="p">[</span><span class="n">indices_only_ifilered</span><span class="p">],</span> <span class="n">bins</span><span class="o">=</span><span class="n">bins</span><span class="p">,</span>\
             <span class="n">facecolor</span><span class="o">=</span><span class="s1">'white'</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">'red'</span><span class="p">,</span>\
                <span class="n">linestyle</span><span class="o">=</span><span class="s1">'--'</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">'$i_</span><span class="si">{mag}</span><span class="s1">$'</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">'Only $i_</span><span class="si">{mag}</span><span class="s1">$ observations'</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">'best'</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">'hist_only_imag_in_panstarrs_data.png'</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">clf</span><span class="p">()</span>

    <span class="n">indices_all_filtered</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">((</span><span class="n">gmag</span><span class="o">!=</span> <span class="o">-</span><span class="mi">999</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">imag</span><span class="o">!=</span> <span class="o">-</span><span class="mi">999</span><span class="p">)</span> <span class="o">&amp;</span>\
                                    <span class="p">(</span><span class="n">rmag</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">999</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">zmag</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">999</span><span class="p">)</span> <span class="o">&amp;</span>\
                                    <span class="p">(</span><span class="n">ymag</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">999</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">e_gmag</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">999</span><span class="p">)</span> <span class="o">&amp;</span>\
                                    <span class="p">(</span><span class="n">e_rmag</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">999</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">e_imag</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">999</span><span class="p">)</span> <span class="o">&amp;</span>\
                                    <span class="p">(</span><span class="n">e_zmag</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">999</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">e_ymag</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">999</span><span class="p">)</span> <span class="o">&amp;</span>\
                                    <span class="p">(</span><span class="n">gkron</span><span class="o">!=</span> <span class="o">-</span><span class="mi">999</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">ikron</span><span class="o">!=</span> <span class="o">-</span><span class="mi">999</span><span class="p">)</span> <span class="o">&amp;</span>\
                                    <span class="p">(</span><span class="n">zkron</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">999</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">ykron</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">999</span><span class="p">)</span> <span class="o">&amp;</span>\
                                    <span class="p">(</span><span class="n">rkron</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">999</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">e_gmag</span> <span class="o">&lt;</span> <span class="mf">0.2</span><span class="p">)</span> <span class="o">&amp;</span>\
                                    <span class="p">(</span><span class="n">e_rmag</span> <span class="o">&lt;</span> <span class="mf">0.2</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">e_imag</span> <span class="o">&lt;</span> <span class="mf">0.2</span><span class="p">)</span> <span class="o">&amp;</span>\
                                    <span class="p">(</span><span class="n">e_zmag</span> <span class="o">&lt;</span> <span class="mf">0.2</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">e_ymag</span> <span class="o">&lt;</span> <span class="mf">0.2</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>

    <span class="nb">print</span><span class="p">(</span><span class="s1">'Number of sources having detections in five optical bands='</span><span class="p">,</span>\
          <span class="nb">len</span><span class="p">(</span><span class="n">indices_all_filtered</span><span class="p">))</span>

    <span class="n">binwidth</span><span class="o">=</span><span class="mf">0.5</span>
    <span class="n">bins_g</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">gmag</span><span class="p">[</span><span class="n">indices_all_filtered</span><span class="p">]),</span>\
                       <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">gmag</span><span class="p">[</span><span class="n">indices_all_filtered</span><span class="p">])</span> <span class="o">+</span>\
                        <span class="n">binwidth</span><span class="p">,</span> <span class="n">binwidth</span><span class="p">)</span>
    <span class="n">bins_r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">rmag</span><span class="p">[</span><span class="n">indices_all_filtered</span><span class="p">]),</span>\
                       <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">rmag</span><span class="p">[</span><span class="n">indices_all_filtered</span><span class="p">])</span> <span class="o">+</span>\
                        <span class="n">binwidth</span><span class="p">,</span> <span class="n">binwidth</span><span class="p">)</span>
    <span class="n">bins_i</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">imag</span><span class="p">[</span><span class="n">indices_all_filtered</span><span class="p">]),</span>\
                       <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">imag</span><span class="p">[</span><span class="n">indices_all_filtered</span><span class="p">])</span> <span class="o">+</span>\
                        <span class="n">binwidth</span><span class="p">,</span> <span class="n">binwidth</span><span class="p">)</span>
    <span class="n">bins_z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">zmag</span><span class="p">[</span><span class="n">indices_all_filtered</span><span class="p">]),</span>\
                       <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">zmag</span><span class="p">[</span><span class="n">indices_all_filtered</span><span class="p">])</span> <span class="o">+</span>\
                        <span class="n">binwidth</span><span class="p">,</span> <span class="n">binwidth</span><span class="p">)</span>
    <span class="n">bins_y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">ymag</span><span class="p">[</span><span class="n">indices_all_filtered</span><span class="p">]),</span>\
                       <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">ymag</span><span class="p">[</span><span class="n">indices_all_filtered</span><span class="p">])</span> <span class="o">+</span>\
                        <span class="n">binwidth</span><span class="p">,</span> <span class="n">binwidth</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">clf</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">gmag</span><span class="p">[</span><span class="n">indices_all_filtered</span><span class="p">],</span> <span class="n">bins</span><span class="o">=</span><span class="n">bins_g</span><span class="p">,</span>\
             <span class="n">facecolor</span><span class="o">=</span><span class="s1">'white'</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">'red'</span><span class="p">,</span>\
            <span class="n">linestyle</span><span class="o">=</span><span class="s1">'--'</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">'$g_</span><span class="si">{mag}</span><span class="s1">$'</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">rmag</span><span class="p">[</span><span class="n">indices_all_filtered</span><span class="p">],</span> <span class="n">bins</span><span class="o">=</span><span class="n">bins_r</span><span class="p">,</span>\
             <span class="n">facecolor</span><span class="o">=</span><span class="s1">'white'</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">'blue'</span><span class="p">,</span>\
            <span class="n">linestyle</span><span class="o">=</span><span class="s1">'--'</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">'$r_</span><span class="si">{mag}</span><span class="s1">$'</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">imag</span><span class="p">[</span><span class="n">indices_all_filtered</span><span class="p">],</span> <span class="n">bins</span><span class="o">=</span><span class="n">bins_i</span><span class="p">,</span>\
             <span class="n">facecolor</span><span class="o">=</span><span class="s1">'white'</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">'green'</span><span class="p">,</span>\
            <span class="n">linestyle</span><span class="o">=</span><span class="s1">'--'</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">'$i_</span><span class="si">{mag}</span><span class="s1">$'</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">zmag</span><span class="p">[</span><span class="n">indices_all_filtered</span><span class="p">],</span> <span class="n">bins</span><span class="o">=</span><span class="n">bins_z</span><span class="p">,</span>\
             <span class="n">facecolor</span><span class="o">=</span><span class="s1">'white'</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">'orange'</span><span class="p">,</span>\
                <span class="n">linestyle</span><span class="o">=</span><span class="s1">'--'</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">'$z_</span><span class="si">{mag}</span><span class="s1">$'</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">ymag</span><span class="p">[</span><span class="n">indices_all_filtered</span><span class="p">],</span> <span class="n">bins</span><span class="o">=</span><span class="n">bins_y</span><span class="p">,</span>\
             <span class="n">facecolor</span><span class="o">=</span><span class="s1">'white'</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">'purple'</span><span class="p">,</span>\
                <span class="n">linestyle</span><span class="o">=</span><span class="s1">'--'</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">'$y_</span><span class="si">{mag}</span><span class="s1">$'</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">'PANSTARRS observed data'</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">'best'</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">'hist_panstarrs_data.png'</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">clf</span><span class="p">()</span>

    <span class="n">filtered_optical_data</span> <span class="o">=</span> <span class="n">ps1_objid</span><span class="p">[</span><span class="n">indices_all_filtered</span><span class="p">],</span>\
        <span class="n">ps_ra</span><span class="p">[</span><span class="n">indices_all_filtered</span><span class="p">],</span> <span class="n">err_ps_ra</span><span class="p">[</span><span class="n">indices_all_filtered</span><span class="p">],</span>\
        <span class="n">ps_dec</span><span class="p">[</span><span class="n">indices_all_filtered</span><span class="p">],</span> <span class="n">err_ps_dec</span><span class="p">[</span><span class="n">indices_all_filtered</span><span class="p">],</span>\
        <span class="n">gmag</span><span class="p">[</span><span class="n">indices_all_filtered</span><span class="p">],</span> <span class="n">e_gmag</span><span class="p">[</span><span class="n">indices_all_filtered</span><span class="p">],</span>\
        <span class="n">gkron</span><span class="p">[</span><span class="n">indices_all_filtered</span><span class="p">],</span> <span class="n">e_gkron</span><span class="p">[</span><span class="n">indices_all_filtered</span><span class="p">],</span>\
        <span class="n">rmag</span><span class="p">[</span><span class="n">indices_all_filtered</span><span class="p">],</span> <span class="n">e_rmag</span><span class="p">[</span><span class="n">indices_all_filtered</span><span class="p">],</span>\
        <span class="n">rkron</span><span class="p">[</span><span class="n">indices_all_filtered</span><span class="p">],</span> <span class="n">e_rkron</span><span class="p">[</span><span class="n">indices_all_filtered</span><span class="p">],</span>\
        <span class="n">imag</span><span class="p">[</span><span class="n">indices_all_filtered</span><span class="p">],</span> <span class="n">e_imag</span><span class="p">[</span><span class="n">indices_all_filtered</span><span class="p">],</span>\
        <span class="n">ikron</span><span class="p">[</span><span class="n">indices_all_filtered</span><span class="p">],</span> <span class="n">e_ikron</span><span class="p">[</span><span class="n">indices_all_filtered</span><span class="p">],</span>\
        <span class="n">zmag</span><span class="p">[</span><span class="n">indices_all_filtered</span><span class="p">],</span> <span class="n">e_zmag</span><span class="p">[</span><span class="n">indices_all_filtered</span><span class="p">],</span>\
        <span class="n">zkron</span><span class="p">[</span><span class="n">indices_all_filtered</span><span class="p">],</span> <span class="n">e_zkron</span><span class="p">[</span><span class="n">indices_all_filtered</span><span class="p">],</span>\
        <span class="n">ymag</span><span class="p">[</span><span class="n">indices_all_filtered</span><span class="p">],</span> <span class="n">e_ymag</span><span class="p">[</span><span class="n">indices_all_filtered</span><span class="p">],</span>\
        <span class="n">ykron</span><span class="p">[</span><span class="n">indices_all_filtered</span><span class="p">],</span> <span class="n">e_ykron</span><span class="p">[</span><span class="n">indices_all_filtered</span><span class="p">],</span>\
        <span class="n">objinfoflag</span><span class="p">[</span><span class="n">indices_all_filtered</span><span class="p">],</span> <span class="n">qualityflag</span><span class="p">[</span><span class="n">indices_all_filtered</span><span class="p">],</span>\
        <span class="n">ndetections</span><span class="p">[</span><span class="n">indices_all_filtered</span><span class="p">],</span> <span class="n">nstackdetections</span><span class="p">[</span><span class="n">indices_all_filtered</span><span class="p">],</span>\
        <span class="n">ginfoflag</span><span class="p">[</span><span class="n">indices_all_filtered</span><span class="p">],</span> <span class="n">ginfoflag2</span><span class="p">[</span><span class="n">indices_all_filtered</span><span class="p">],</span>\
        <span class="n">ginfoflag3</span><span class="p">[</span><span class="n">indices_all_filtered</span><span class="p">],</span> <span class="n">rinfoflag</span><span class="p">[</span><span class="n">indices_all_filtered</span><span class="p">],</span>\
        <span class="n">rinfoflag2</span><span class="p">[</span><span class="n">indices_all_filtered</span><span class="p">],</span> <span class="n">rinfoflag3</span><span class="p">[</span><span class="n">indices_all_filtered</span><span class="p">],</span>\
        <span class="n">iinfoflag</span><span class="p">[</span><span class="n">indices_all_filtered</span><span class="p">],</span> <span class="n">iinfoflag2</span><span class="p">[</span><span class="n">indices_all_filtered</span><span class="p">],</span>\
        <span class="n">iinfoflag3</span><span class="p">[</span><span class="n">indices_all_filtered</span><span class="p">],</span> <span class="n">zinfoflag</span><span class="p">[</span><span class="n">indices_all_filtered</span><span class="p">],</span>\
        <span class="n">zinfoflag2</span><span class="p">[</span><span class="n">indices_all_filtered</span><span class="p">],</span> <span class="n">zinfoflag3</span><span class="p">[</span><span class="n">indices_all_filtered</span><span class="p">],</span>\
        <span class="n">yinfoflag</span><span class="p">[</span><span class="n">indices_all_filtered</span><span class="p">],</span> <span class="n">yinfoflag2</span><span class="p">[</span><span class="n">indices_all_filtered</span><span class="p">],</span>\
        <span class="n">yinfoflag3</span><span class="p">[</span><span class="n">indices_all_filtered</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">filtered_optical_data</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="doc doc-object doc-module">
<a id="irgsctool._sgc"></a>
<div class="doc doc-contents first">
<div class="doc doc-children">
<div class="doc doc-object doc-class">
<h2 class="doc doc-heading" id="irgsctool._sgc.StarGalaxyClassification">
<code>StarGalaxyClassification</code>
</h2>
<div class="doc doc-contents">
<p><strong><em> StarGalaxyClassification class </em></strong> contains star_galaxy_classification()
method which is used to seperate the stars and galaxies in the PANSTARRS
optical data.</p>
<details class="quote">
<summary>Source code in <code>irgsctool/_sgc.py</code></summary>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 16</span>
<span class="normal"> 17</span>
<span class="normal"> 18</span>
<span class="normal"> 19</span>
<span class="normal"> 20</span>
<span class="normal"> 21</span>
<span class="normal"> 22</span>
<span class="normal"> 23</span>
<span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">StarGalaxyClassification</span><span class="p">():</span>
<span class="w">    </span><span class="sd">"""</span>

<span class="sd">        *** StarGalaxyClassification class *** contains star_galaxy_classification()</span>
<span class="sd">        method which is used to seperate the stars and galaxies in the PANSTARRS</span>
<span class="sd">        optical data.</span>

<span class="sd">    """</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ra</span><span class="p">,</span> <span class="n">dec</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ra</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dec</span> <span class="o">=</span> <span class="n">ra</span><span class="p">,</span> <span class="n">dec</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rd</span> <span class="o">=</span> <span class="n">ReadData</span><span class="p">(</span><span class="n">ra</span><span class="p">,</span> <span class="n">dec</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">star_galaxy_classification</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

<span class="w">        </span><span class="sd">"""</span>
<span class="sd">            `irgsctool.StarGalaxyClassification.star_galaxy_classification()`</span>

<span class="sd">            This method is used to seperate stars and galaxies using</span>
<span class="sd">            the condition applied to all the five optical filters:</span>

<span class="sd">            $$</span>
<span class="sd">            (psf-kron) &lt; 0.05</span>
<span class="sd">            $$</span>

<span class="sd">            This relation filters the input optical data for only probable</span>
<span class="sd">            stellar sources. The (psf-kron) diagram showing stars</span>
<span class="sd">            and galaxies in the data as well as (g-r) vs (r-i)</span>
<span class="sd">            CCD is also plotted by this method.</span>

<span class="sd">            Returns:</span>
<span class="sd">                    ndarray: PANSTARRS data containing most probable stellar sources</span>
<span class="sd">        """</span>

        <span class="nb">print</span><span class="p">(</span><span class="s2">""</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">"#######################################################################"</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">'Seperating Stars and Galaxies from the input optical PANSTARRS dataset'</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">""</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">"#######################################################################"</span><span class="p">)</span>

        <span class="n">ps_phot</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rd</span><span class="o">.</span><span class="n">read_optical_data</span><span class="p">()</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">""</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">'Using psf-kron criteria to seperate stars and galaxies'</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">""</span><span class="p">)</span>

        <span class="n">ps1_objid</span><span class="p">,</span> <span class="n">ps_ra</span><span class="p">,</span> <span class="n">e_ps_ra</span><span class="p">,</span> <span class="n">ps_dec</span><span class="p">,</span> <span class="n">e_ps_dec</span><span class="p">,</span> <span class="n">gpsf</span><span class="p">,</span> <span class="n">e_gpsf</span><span class="p">,</span> <span class="n">gkron</span><span class="p">,</span> <span class="n">e_gkron</span><span class="p">,</span> <span class="n">rpsf</span><span class="p">,</span> <span class="n">e_rpsf</span><span class="p">,</span> <span class="n">rkron</span><span class="p">,</span> <span class="n">e_rkron</span><span class="p">,</span> \
        <span class="n">ipsf</span><span class="p">,</span> <span class="n">e_ipsf</span><span class="p">,</span> <span class="n">ikron</span><span class="p">,</span> <span class="n">e_ikron</span><span class="p">,</span> <span class="n">zpsf</span><span class="p">,</span> <span class="n">e_zpsf</span><span class="p">,</span> <span class="n">zkron</span><span class="p">,</span> <span class="n">e_zkron</span><span class="p">,</span> <span class="n">ypsf</span><span class="p">,</span> <span class="n">e_ypsf</span><span class="p">,</span> <span class="n">ykron</span><span class="p">,</span> <span class="n">e_ykron</span><span class="p">,</span>\
            <span class="n">objinfoflag</span><span class="p">,</span> <span class="n">qualityflag</span><span class="p">,</span> <span class="n">ndetections</span><span class="p">,</span> <span class="n">nstackdetections</span><span class="p">,</span> <span class="n">ginfoflag</span><span class="p">,</span> <span class="n">ginfoflag2</span><span class="p">,</span> \
                <span class="n">ginfoflag3</span><span class="p">,</span> <span class="n">rinfoflag</span><span class="p">,</span> <span class="n">rinfoflag2</span><span class="p">,</span> <span class="n">rinfoflag3</span><span class="p">,</span>  <span class="n">iinfoflag</span><span class="p">,</span> <span class="n">iinfoflag2</span><span class="p">,</span> <span class="n">iinfoflag3</span><span class="p">,</span>\
                    <span class="n">zinfoflag</span><span class="p">,</span> <span class="n">zinfoflag2</span><span class="p">,</span> <span class="n">zinfoflag3</span><span class="p">,</span> <span class="n">yinfoflag</span><span class="p">,</span> <span class="n">yinfoflag2</span><span class="p">,</span> <span class="n">yinfoflag3</span> <span class="o">=</span> <span class="n">ps_phot</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">'Length of the PS1 data before SGC is:'</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">ps1_objid</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">''</span><span class="p">)</span>

        <span class="n">sgc_index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">((</span><span class="n">gpsf</span> <span class="o">-</span> <span class="n">gkron</span> <span class="o">&lt;</span> <span class="mf">0.05</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">rpsf</span> <span class="o">-</span> <span class="n">rkron</span> <span class="o">&lt;</span> <span class="mf">0.05</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">ipsf</span> <span class="o">-</span> <span class="n">ikron</span> <span class="o">&lt;</span> <span class="mf">0.05</span><span class="p">)</span> <span class="o">&amp;</span> \
                         <span class="p">(</span><span class="n">zpsf</span> <span class="o">-</span> <span class="n">zkron</span> <span class="o">&lt;</span> <span class="mf">0.05</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">ypsf</span> <span class="o">-</span> <span class="n">ykron</span> <span class="o">&lt;</span> <span class="mf">0.05</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">galaxy_index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">((</span><span class="n">gpsf</span> <span class="o">-</span> <span class="n">gkron</span> <span class="o">&gt;</span> <span class="mf">0.05</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">rpsf</span> <span class="o">-</span> <span class="n">rkron</span> <span class="o">&gt;</span> <span class="mf">0.05</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">ipsf</span> <span class="o">-</span> <span class="n">ikron</span> <span class="o">&gt;</span> <span class="mf">0.05</span><span class="p">)</span> <span class="o">&amp;</span> \
                            <span class="p">(</span><span class="n">zpsf</span> <span class="o">-</span> <span class="n">zkron</span> <span class="o">&gt;</span> <span class="mf">0.05</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">ypsf</span> <span class="o">-</span> <span class="n">ykron</span> <span class="o">&gt;</span> <span class="mf">0.05</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>

        <span class="nb">print</span><span class="p">(</span><span class="s1">'Number of probable stellar sources ='</span> <span class="o">+</span> <span class="s1">' '</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">sgc_index</span><span class="p">))</span> <span class="o">+</span> <span class="s1">' '</span> <span class="o">+</span> <span class="s1">'and number of extended sources = '</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ipsf</span><span class="p">)</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">sgc_index</span><span class="p">)))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">""</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">'Now plotting the (g-r) vs (r-i) CCD which shows stars in a locus and galaxies as random respectively'</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">""</span><span class="p">)</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">clf</span><span class="p">()</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">((</span><span class="n">gpsf</span><span class="p">[</span><span class="n">sgc_index</span><span class="p">]</span> <span class="o">-</span> <span class="n">rpsf</span><span class="p">[</span><span class="n">sgc_index</span><span class="p">]),</span> <span class="p">(</span><span class="n">rpsf</span><span class="p">[</span><span class="n">sgc_index</span><span class="p">]</span> <span class="o">-</span> <span class="n">ipsf</span><span class="p">[</span><span class="n">sgc_index</span><span class="p">]),</span> \
                <span class="n">s</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span> <span class="s1">'m'</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.3</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">'stellar sources'</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">((</span><span class="n">gpsf</span><span class="p">[</span><span class="n">galaxy_index</span><span class="p">]</span> <span class="o">-</span> <span class="n">rpsf</span><span class="p">[</span><span class="n">galaxy_index</span><span class="p">]),</span> <span class="p">(</span><span class="n">rpsf</span><span class="p">[</span><span class="n">galaxy_index</span><span class="p">]</span> <span class="o">-</span> <span class="n">ipsf</span><span class="p">[</span><span class="n">galaxy_index</span><span class="p">]),</span> \
                <span class="n">s</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">'k'</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.3</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">'extended sources'</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">'$(g-r)$'</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">'$(r-i)$'</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">'best'</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">'ccd_stars_and_galaxies_seperated.png'</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">clf</span><span class="p">()</span>

        <span class="nb">print</span><span class="p">(</span><span class="s1">'Plotting the (ipsf-ikron) vs (ikron) scatter plot which shows stars and galaxies as magenta and black points respectively'</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">""</span><span class="p">)</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">clf</span><span class="p">()</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">ipsf</span><span class="p">[</span><span class="n">sgc_index</span><span class="p">],</span> <span class="p">(</span><span class="n">ipsf</span><span class="p">[</span><span class="n">sgc_index</span><span class="p">]</span> <span class="o">-</span> <span class="n">ikron</span><span class="p">[</span><span class="n">sgc_index</span><span class="p">]),</span> <span class="n">s</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">'m'</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.3</span><span class="p">,</span>\
                    <span class="n">label</span><span class="o">=</span><span class="s1">'stellar sources'</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">ipsf</span><span class="p">[</span><span class="n">galaxy_index</span><span class="p">],</span> <span class="p">(</span><span class="n">ipsf</span><span class="p">[</span><span class="n">galaxy_index</span><span class="p">]</span> <span class="o">-</span> <span class="n">ikron</span><span class="p">[</span><span class="n">galaxy_index</span><span class="p">]),</span> <span class="n">s</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> \
                    <span class="n">color</span><span class="o">=</span><span class="s1">'k'</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.3</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">'extended sources'</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">'$i_</span><span class="si">{psf}</span><span class="s1">$'</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">'$i_</span><span class="si">{psf}</span><span class="s1">-i_</span><span class="si">{kron}</span><span class="s1">$'</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">'best'</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">'psf_vs_kron_stars_and_galaxies_seperated.png'</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">clf</span><span class="p">()</span>

        <span class="n">ps_phot</span> <span class="o">=</span> <span class="n">ps1_objid</span><span class="p">[</span><span class="n">sgc_index</span><span class="p">],</span> <span class="n">ps_ra</span><span class="p">[</span><span class="n">sgc_index</span><span class="p">],</span> <span class="n">e_ps_ra</span><span class="p">[</span><span class="n">sgc_index</span><span class="p">],</span> <span class="n">ps_dec</span><span class="p">[</span><span class="n">sgc_index</span><span class="p">],</span>\
            <span class="n">e_ps_dec</span><span class="p">[</span><span class="n">sgc_index</span><span class="p">],</span> <span class="n">gpsf</span><span class="p">[</span><span class="n">sgc_index</span><span class="p">],</span> <span class="n">e_gpsf</span><span class="p">[</span><span class="n">sgc_index</span><span class="p">],</span> <span class="n">gkron</span><span class="p">[</span><span class="n">sgc_index</span><span class="p">],</span> <span class="n">e_gkron</span><span class="p">[</span><span class="n">sgc_index</span><span class="p">],</span>\
            <span class="n">rpsf</span><span class="p">[</span><span class="n">sgc_index</span><span class="p">],</span> <span class="n">e_rpsf</span><span class="p">[</span><span class="n">sgc_index</span><span class="p">],</span> <span class="n">rkron</span><span class="p">[</span><span class="n">sgc_index</span><span class="p">],</span> <span class="n">e_rkron</span><span class="p">[</span><span class="n">sgc_index</span><span class="p">],</span> <span class="n">ipsf</span><span class="p">[</span><span class="n">sgc_index</span><span class="p">],</span>\
                <span class="n">e_ipsf</span><span class="p">[</span><span class="n">sgc_index</span><span class="p">],</span> <span class="n">ikron</span><span class="p">[</span><span class="n">sgc_index</span><span class="p">],</span> <span class="n">e_ikron</span><span class="p">[</span><span class="n">sgc_index</span><span class="p">],</span> <span class="n">zpsf</span><span class="p">[</span><span class="n">sgc_index</span><span class="p">],</span> <span class="n">e_zpsf</span><span class="p">[</span><span class="n">sgc_index</span><span class="p">],</span>\
                    <span class="n">zkron</span><span class="p">[</span><span class="n">sgc_index</span><span class="p">],</span> <span class="n">e_zkron</span><span class="p">[</span><span class="n">sgc_index</span><span class="p">],</span> <span class="n">ypsf</span><span class="p">[</span><span class="n">sgc_index</span><span class="p">],</span> <span class="n">e_ypsf</span><span class="p">[</span><span class="n">sgc_index</span><span class="p">],</span> <span class="n">ykron</span><span class="p">[</span><span class="n">sgc_index</span><span class="p">],</span>\
                        <span class="n">e_ykron</span><span class="p">[</span><span class="n">sgc_index</span><span class="p">],</span> <span class="n">objinfoflag</span><span class="p">[</span><span class="n">sgc_index</span><span class="p">],</span> <span class="n">qualityflag</span><span class="p">[</span><span class="n">sgc_index</span><span class="p">],</span> <span class="n">ndetections</span><span class="p">[</span><span class="n">sgc_index</span><span class="p">],</span>\
                            <span class="n">nstackdetections</span><span class="p">[</span><span class="n">sgc_index</span><span class="p">],</span> <span class="n">ginfoflag</span><span class="p">[</span><span class="n">sgc_index</span><span class="p">],</span> <span class="n">ginfoflag2</span><span class="p">[</span><span class="n">sgc_index</span><span class="p">],</span>\
                                <span class="n">ginfoflag3</span><span class="p">[</span><span class="n">sgc_index</span><span class="p">],</span> <span class="n">rinfoflag</span><span class="p">[</span><span class="n">sgc_index</span><span class="p">],</span> <span class="n">rinfoflag2</span><span class="p">[</span><span class="n">sgc_index</span><span class="p">],</span> <span class="n">rinfoflag3</span><span class="p">[</span><span class="n">sgc_index</span><span class="p">],</span>\
                                    <span class="n">iinfoflag</span><span class="p">[</span><span class="n">sgc_index</span><span class="p">],</span> <span class="n">iinfoflag2</span><span class="p">[</span><span class="n">sgc_index</span><span class="p">],</span> <span class="n">iinfoflag3</span><span class="p">[</span><span class="n">sgc_index</span><span class="p">],</span>\
                                        <span class="n">zinfoflag</span><span class="p">[</span><span class="n">sgc_index</span><span class="p">],</span> <span class="n">zinfoflag2</span><span class="p">[</span><span class="n">sgc_index</span><span class="p">],</span> <span class="n">zinfoflag3</span><span class="p">[</span><span class="n">sgc_index</span><span class="p">],</span>\
                                            <span class="n">yinfoflag</span><span class="p">[</span><span class="n">sgc_index</span><span class="p">],</span> <span class="n">yinfoflag2</span><span class="p">[</span><span class="n">sgc_index</span><span class="p">],</span> <span class="n">yinfoflag3</span><span class="p">[</span><span class="n">sgc_index</span><span class="p">]</span>

        <span class="nb">print</span><span class="p">(</span><span class="s2">"#####################################################"</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">'Created an input optical catalogue of stellar sources'</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">"######################################################"</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">'Length of PS1 data before sgc is:'</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">ps1_objid</span><span class="p">[</span><span class="n">sgc_index</span><span class="p">]))</span>

        <span class="k">return</span> <span class="n">ps_phot</span>
</code></pre></div></td></tr></table></div>
</details>
<div class="doc doc-children">
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="irgsctool._sgc.StarGalaxyClassification.star_galaxy_classification">
<code class="highlight language-python"><span class="n">star_galaxy_classification</span><span class="p">()</span></code>
</h3>
<div class="doc doc-contents">
<p><code>irgsctool.StarGalaxyClassification.star_galaxy_classification()</code></p>
<p>This method is used to seperate stars and galaxies using
the condition applied to all the five optical filters:</p>
<div class="arithmatex">\[
(psf-kron) &lt; 0.05
\]</div>
<p>This relation filters the input optical data for only probable
stellar sources. The (psf-kron) diagram showing stars
and galaxies in the data as well as (g-r) vs (r-i)
CCD is also plotted by this method.</p>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Name</th> <th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>ndarray</code></td> <td>
</td>
<td><p>PANSTARRS data containing most probable stellar sources</p></td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>irgsctool/_sgc.py</code></summary>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">star_galaxy_classification</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

<span class="w">    </span><span class="sd">"""</span>
<span class="sd">        `irgsctool.StarGalaxyClassification.star_galaxy_classification()`</span>

<span class="sd">        This method is used to seperate stars and galaxies using</span>
<span class="sd">        the condition applied to all the five optical filters:</span>

<span class="sd">        $$</span>
<span class="sd">        (psf-kron) &lt; 0.05</span>
<span class="sd">        $$</span>

<span class="sd">        This relation filters the input optical data for only probable</span>
<span class="sd">        stellar sources. The (psf-kron) diagram showing stars</span>
<span class="sd">        and galaxies in the data as well as (g-r) vs (r-i)</span>
<span class="sd">        CCD is also plotted by this method.</span>

<span class="sd">        Returns:</span>
<span class="sd">                ndarray: PANSTARRS data containing most probable stellar sources</span>
<span class="sd">    """</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">""</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">"#######################################################################"</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">'Seperating Stars and Galaxies from the input optical PANSTARRS dataset'</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">""</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">"#######################################################################"</span><span class="p">)</span>

    <span class="n">ps_phot</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rd</span><span class="o">.</span><span class="n">read_optical_data</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">""</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">'Using psf-kron criteria to seperate stars and galaxies'</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">""</span><span class="p">)</span>

    <span class="n">ps1_objid</span><span class="p">,</span> <span class="n">ps_ra</span><span class="p">,</span> <span class="n">e_ps_ra</span><span class="p">,</span> <span class="n">ps_dec</span><span class="p">,</span> <span class="n">e_ps_dec</span><span class="p">,</span> <span class="n">gpsf</span><span class="p">,</span> <span class="n">e_gpsf</span><span class="p">,</span> <span class="n">gkron</span><span class="p">,</span> <span class="n">e_gkron</span><span class="p">,</span> <span class="n">rpsf</span><span class="p">,</span> <span class="n">e_rpsf</span><span class="p">,</span> <span class="n">rkron</span><span class="p">,</span> <span class="n">e_rkron</span><span class="p">,</span> \
    <span class="n">ipsf</span><span class="p">,</span> <span class="n">e_ipsf</span><span class="p">,</span> <span class="n">ikron</span><span class="p">,</span> <span class="n">e_ikron</span><span class="p">,</span> <span class="n">zpsf</span><span class="p">,</span> <span class="n">e_zpsf</span><span class="p">,</span> <span class="n">zkron</span><span class="p">,</span> <span class="n">e_zkron</span><span class="p">,</span> <span class="n">ypsf</span><span class="p">,</span> <span class="n">e_ypsf</span><span class="p">,</span> <span class="n">ykron</span><span class="p">,</span> <span class="n">e_ykron</span><span class="p">,</span>\
        <span class="n">objinfoflag</span><span class="p">,</span> <span class="n">qualityflag</span><span class="p">,</span> <span class="n">ndetections</span><span class="p">,</span> <span class="n">nstackdetections</span><span class="p">,</span> <span class="n">ginfoflag</span><span class="p">,</span> <span class="n">ginfoflag2</span><span class="p">,</span> \
            <span class="n">ginfoflag3</span><span class="p">,</span> <span class="n">rinfoflag</span><span class="p">,</span> <span class="n">rinfoflag2</span><span class="p">,</span> <span class="n">rinfoflag3</span><span class="p">,</span>  <span class="n">iinfoflag</span><span class="p">,</span> <span class="n">iinfoflag2</span><span class="p">,</span> <span class="n">iinfoflag3</span><span class="p">,</span>\
                <span class="n">zinfoflag</span><span class="p">,</span> <span class="n">zinfoflag2</span><span class="p">,</span> <span class="n">zinfoflag3</span><span class="p">,</span> <span class="n">yinfoflag</span><span class="p">,</span> <span class="n">yinfoflag2</span><span class="p">,</span> <span class="n">yinfoflag3</span> <span class="o">=</span> <span class="n">ps_phot</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">'Length of the PS1 data before SGC is:'</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">ps1_objid</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">''</span><span class="p">)</span>

    <span class="n">sgc_index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">((</span><span class="n">gpsf</span> <span class="o">-</span> <span class="n">gkron</span> <span class="o">&lt;</span> <span class="mf">0.05</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">rpsf</span> <span class="o">-</span> <span class="n">rkron</span> <span class="o">&lt;</span> <span class="mf">0.05</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">ipsf</span> <span class="o">-</span> <span class="n">ikron</span> <span class="o">&lt;</span> <span class="mf">0.05</span><span class="p">)</span> <span class="o">&amp;</span> \
                     <span class="p">(</span><span class="n">zpsf</span> <span class="o">-</span> <span class="n">zkron</span> <span class="o">&lt;</span> <span class="mf">0.05</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">ypsf</span> <span class="o">-</span> <span class="n">ykron</span> <span class="o">&lt;</span> <span class="mf">0.05</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">galaxy_index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">((</span><span class="n">gpsf</span> <span class="o">-</span> <span class="n">gkron</span> <span class="o">&gt;</span> <span class="mf">0.05</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">rpsf</span> <span class="o">-</span> <span class="n">rkron</span> <span class="o">&gt;</span> <span class="mf">0.05</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">ipsf</span> <span class="o">-</span> <span class="n">ikron</span> <span class="o">&gt;</span> <span class="mf">0.05</span><span class="p">)</span> <span class="o">&amp;</span> \
                        <span class="p">(</span><span class="n">zpsf</span> <span class="o">-</span> <span class="n">zkron</span> <span class="o">&gt;</span> <span class="mf">0.05</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">ypsf</span> <span class="o">-</span> <span class="n">ykron</span> <span class="o">&gt;</span> <span class="mf">0.05</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>

    <span class="nb">print</span><span class="p">(</span><span class="s1">'Number of probable stellar sources ='</span> <span class="o">+</span> <span class="s1">' '</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">sgc_index</span><span class="p">))</span> <span class="o">+</span> <span class="s1">' '</span> <span class="o">+</span> <span class="s1">'and number of extended sources = '</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ipsf</span><span class="p">)</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">sgc_index</span><span class="p">)))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">""</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">'Now plotting the (g-r) vs (r-i) CCD which shows stars in a locus and galaxies as random respectively'</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">""</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">clf</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">((</span><span class="n">gpsf</span><span class="p">[</span><span class="n">sgc_index</span><span class="p">]</span> <span class="o">-</span> <span class="n">rpsf</span><span class="p">[</span><span class="n">sgc_index</span><span class="p">]),</span> <span class="p">(</span><span class="n">rpsf</span><span class="p">[</span><span class="n">sgc_index</span><span class="p">]</span> <span class="o">-</span> <span class="n">ipsf</span><span class="p">[</span><span class="n">sgc_index</span><span class="p">]),</span> \
            <span class="n">s</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span> <span class="s1">'m'</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.3</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">'stellar sources'</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">((</span><span class="n">gpsf</span><span class="p">[</span><span class="n">galaxy_index</span><span class="p">]</span> <span class="o">-</span> <span class="n">rpsf</span><span class="p">[</span><span class="n">galaxy_index</span><span class="p">]),</span> <span class="p">(</span><span class="n">rpsf</span><span class="p">[</span><span class="n">galaxy_index</span><span class="p">]</span> <span class="o">-</span> <span class="n">ipsf</span><span class="p">[</span><span class="n">galaxy_index</span><span class="p">]),</span> \
            <span class="n">s</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">'k'</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.3</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">'extended sources'</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">'$(g-r)$'</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">'$(r-i)$'</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">'best'</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">'ccd_stars_and_galaxies_seperated.png'</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">clf</span><span class="p">()</span>

    <span class="nb">print</span><span class="p">(</span><span class="s1">'Plotting the (ipsf-ikron) vs (ikron) scatter plot which shows stars and galaxies as magenta and black points respectively'</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">""</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">clf</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">ipsf</span><span class="p">[</span><span class="n">sgc_index</span><span class="p">],</span> <span class="p">(</span><span class="n">ipsf</span><span class="p">[</span><span class="n">sgc_index</span><span class="p">]</span> <span class="o">-</span> <span class="n">ikron</span><span class="p">[</span><span class="n">sgc_index</span><span class="p">]),</span> <span class="n">s</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">'m'</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.3</span><span class="p">,</span>\
                <span class="n">label</span><span class="o">=</span><span class="s1">'stellar sources'</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">ipsf</span><span class="p">[</span><span class="n">galaxy_index</span><span class="p">],</span> <span class="p">(</span><span class="n">ipsf</span><span class="p">[</span><span class="n">galaxy_index</span><span class="p">]</span> <span class="o">-</span> <span class="n">ikron</span><span class="p">[</span><span class="n">galaxy_index</span><span class="p">]),</span> <span class="n">s</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> \
                <span class="n">color</span><span class="o">=</span><span class="s1">'k'</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.3</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">'extended sources'</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">'$i_</span><span class="si">{psf}</span><span class="s1">$'</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">'$i_</span><span class="si">{psf}</span><span class="s1">-i_</span><span class="si">{kron}</span><span class="s1">$'</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">'best'</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">'psf_vs_kron_stars_and_galaxies_seperated.png'</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">clf</span><span class="p">()</span>

    <span class="n">ps_phot</span> <span class="o">=</span> <span class="n">ps1_objid</span><span class="p">[</span><span class="n">sgc_index</span><span class="p">],</span> <span class="n">ps_ra</span><span class="p">[</span><span class="n">sgc_index</span><span class="p">],</span> <span class="n">e_ps_ra</span><span class="p">[</span><span class="n">sgc_index</span><span class="p">],</span> <span class="n">ps_dec</span><span class="p">[</span><span class="n">sgc_index</span><span class="p">],</span>\
        <span class="n">e_ps_dec</span><span class="p">[</span><span class="n">sgc_index</span><span class="p">],</span> <span class="n">gpsf</span><span class="p">[</span><span class="n">sgc_index</span><span class="p">],</span> <span class="n">e_gpsf</span><span class="p">[</span><span class="n">sgc_index</span><span class="p">],</span> <span class="n">gkron</span><span class="p">[</span><span class="n">sgc_index</span><span class="p">],</span> <span class="n">e_gkron</span><span class="p">[</span><span class="n">sgc_index</span><span class="p">],</span>\
        <span class="n">rpsf</span><span class="p">[</span><span class="n">sgc_index</span><span class="p">],</span> <span class="n">e_rpsf</span><span class="p">[</span><span class="n">sgc_index</span><span class="p">],</span> <span class="n">rkron</span><span class="p">[</span><span class="n">sgc_index</span><span class="p">],</span> <span class="n">e_rkron</span><span class="p">[</span><span class="n">sgc_index</span><span class="p">],</span> <span class="n">ipsf</span><span class="p">[</span><span class="n">sgc_index</span><span class="p">],</span>\
            <span class="n">e_ipsf</span><span class="p">[</span><span class="n">sgc_index</span><span class="p">],</span> <span class="n">ikron</span><span class="p">[</span><span class="n">sgc_index</span><span class="p">],</span> <span class="n">e_ikron</span><span class="p">[</span><span class="n">sgc_index</span><span class="p">],</span> <span class="n">zpsf</span><span class="p">[</span><span class="n">sgc_index</span><span class="p">],</span> <span class="n">e_zpsf</span><span class="p">[</span><span class="n">sgc_index</span><span class="p">],</span>\
                <span class="n">zkron</span><span class="p">[</span><span class="n">sgc_index</span><span class="p">],</span> <span class="n">e_zkron</span><span class="p">[</span><span class="n">sgc_index</span><span class="p">],</span> <span class="n">ypsf</span><span class="p">[</span><span class="n">sgc_index</span><span class="p">],</span> <span class="n">e_ypsf</span><span class="p">[</span><span class="n">sgc_index</span><span class="p">],</span> <span class="n">ykron</span><span class="p">[</span><span class="n">sgc_index</span><span class="p">],</span>\
                    <span class="n">e_ykron</span><span class="p">[</span><span class="n">sgc_index</span><span class="p">],</span> <span class="n">objinfoflag</span><span class="p">[</span><span class="n">sgc_index</span><span class="p">],</span> <span class="n">qualityflag</span><span class="p">[</span><span class="n">sgc_index</span><span class="p">],</span> <span class="n">ndetections</span><span class="p">[</span><span class="n">sgc_index</span><span class="p">],</span>\
                        <span class="n">nstackdetections</span><span class="p">[</span><span class="n">sgc_index</span><span class="p">],</span> <span class="n">ginfoflag</span><span class="p">[</span><span class="n">sgc_index</span><span class="p">],</span> <span class="n">ginfoflag2</span><span class="p">[</span><span class="n">sgc_index</span><span class="p">],</span>\
                            <span class="n">ginfoflag3</span><span class="p">[</span><span class="n">sgc_index</span><span class="p">],</span> <span class="n">rinfoflag</span><span class="p">[</span><span class="n">sgc_index</span><span class="p">],</span> <span class="n">rinfoflag2</span><span class="p">[</span><span class="n">sgc_index</span><span class="p">],</span> <span class="n">rinfoflag3</span><span class="p">[</span><span class="n">sgc_index</span><span class="p">],</span>\
                                <span class="n">iinfoflag</span><span class="p">[</span><span class="n">sgc_index</span><span class="p">],</span> <span class="n">iinfoflag2</span><span class="p">[</span><span class="n">sgc_index</span><span class="p">],</span> <span class="n">iinfoflag3</span><span class="p">[</span><span class="n">sgc_index</span><span class="p">],</span>\
                                    <span class="n">zinfoflag</span><span class="p">[</span><span class="n">sgc_index</span><span class="p">],</span> <span class="n">zinfoflag2</span><span class="p">[</span><span class="n">sgc_index</span><span class="p">],</span> <span class="n">zinfoflag3</span><span class="p">[</span><span class="n">sgc_index</span><span class="p">],</span>\
                                        <span class="n">yinfoflag</span><span class="p">[</span><span class="n">sgc_index</span><span class="p">],</span> <span class="n">yinfoflag2</span><span class="p">[</span><span class="n">sgc_index</span><span class="p">],</span> <span class="n">yinfoflag3</span><span class="p">[</span><span class="n">sgc_index</span><span class="p">]</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">"#####################################################"</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">'Created an input optical catalogue of stellar sources'</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">"######################################################"</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">'Length of PS1 data before sgc is:'</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">ps1_objid</span><span class="p">[</span><span class="n">sgc_index</span><span class="p">]))</span>

    <span class="k">return</span> <span class="n">ps_phot</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="doc doc-object doc-module">
<a id="irgsctool._extinction_correction"></a>
<div class="doc doc-contents first">
<div class="doc doc-children">
<div class="doc doc-object doc-class">
<h2 class="doc doc-heading" id="irgsctool._extinction_correction.ExtinctionCorrection">
<code>ExtinctionCorrection</code>
</h2>
<div class="doc doc-contents">
<p><strong><em> ExtinctionCorrection class </em></strong> has two methods; one to obtain the reddening and 
NIR extinction coefficients, while the other to correct the PANSTARRS 
data for extinction in each optical filter.</p>
<details class="quote">
<summary>Source code in <code>irgsctool/_extinction_correction.py</code></summary>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 10</span>
<span class="normal"> 11</span>
<span class="normal"> 12</span>
<span class="normal"> 13</span>
<span class="normal"> 14</span>
<span class="normal"> 15</span>
<span class="normal"> 16</span>
<span class="normal"> 17</span>
<span class="normal"> 18</span>
<span class="normal"> 19</span>
<span class="normal"> 20</span>
<span class="normal"> 21</span>
<span class="normal"> 22</span>
<span class="normal"> 23</span>
<span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">ExtinctionCorrection</span><span class="p">():</span>
<span class="w">        </span><span class="sd">"""</span>
<span class="sd">                        *** ExtinctionCorrection class *** has two methods; one to obtain the reddening and </span>
<span class="sd">                        NIR extinction coefficients, while the other to correct the PANSTARRS </span>
<span class="sd">                        data for extinction in each optical filter.</span>
<span class="sd">        """</span>
        <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ra</span><span class="p">,</span> <span class="n">dec</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ra</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dec</span> <span class="o">=</span> <span class="n">ra</span><span class="p">,</span> <span class="n">dec</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">sgc</span> <span class="o">=</span> <span class="n">sgc</span><span class="p">(</span><span class="n">ra</span><span class="p">,</span><span class="n">dec</span><span class="p">)</span>

        <span class="k">def</span> <span class="nf">get_reddening</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">                </span><span class="sd">"""</span>
<span class="sd">                        `irgsctool.ExtinctionCorrection.get_reddening()`</span>

<span class="sd">                        This method obtains the reddening value for a given set of </span>
<span class="sd">                        input coordinates from Schelgel et.al. 1998 (sfd) reddening</span>
<span class="sd">                        map. irgsctool uses Schlafly &amp; Finkbeiner 2011 (snf) reddening</span>
<span class="sd">                        map which is snf = 0.86*sfd.</span>

<span class="sd">                        Raises:</span>
<span class="sd">                                FileNotFoundError: if the sfd files are not present.</span>

<span class="sd">                        Returns:</span>
<span class="sd">                                ebv: Reddening from Schlafly &amp; Finkbeiner 2011</span>
<span class="sd">                                err_ebv: Uncertinty in reddening</span>
<span class="sd">                                aj: J-band extinction coefficient.</span>
<span class="sd">                                ah: H-band extinction coefficient.</span>
<span class="sd">                                ak: K-band extinction coefficient.</span>

<span class="sd">                """</span>
                <span class="k">try</span><span class="p">:</span>
                        <span class="n">coords</span> <span class="o">=</span> <span class="n">SkyCoord</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">ra</span><span class="p">)</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">degree</span><span class="p">,</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dec</span><span class="p">)</span>\
                                          <span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">degree</span><span class="p">,</span> <span class="n">frame</span><span class="o">=</span><span class="s1">'icrs'</span><span class="p">)</span>
                        <span class="n">sfd</span> <span class="o">=</span> <span class="n">SFDQuery</span><span class="p">()</span>
                        <span class="c1">#sfd reddening</span>
                        <span class="n">sfd_ebv</span> <span class="o">=</span> <span class="n">sfd</span><span class="p">(</span><span class="n">coords</span><span class="p">)</span>
                        <span class="c1">#s&amp;f reddening</span>
                        <span class="n">snf_ebv</span> <span class="o">=</span> <span class="n">sfd_ebv</span><span class="o">*</span><span class="mf">0.86</span>
                        <span class="n">err_snf_ebv</span> <span class="o">=</span> <span class="mf">0.001</span><span class="o">*</span><span class="n">snf_ebv</span>
                        <span class="n">aj</span> <span class="o">=</span> <span class="mf">0.709</span><span class="o">*</span><span class="n">snf_ebv</span>
                        <span class="n">ah</span> <span class="o">=</span> <span class="mf">0.449</span><span class="o">*</span><span class="n">snf_ebv</span>
                        <span class="n">ak</span> <span class="o">=</span> <span class="mf">0.302</span><span class="o">*</span><span class="n">snf_ebv</span>
                <span class="k">except</span> <span class="ne">FileNotFoundError</span><span class="p">:</span>
                        <span class="n">dustmaps</span><span class="o">.</span><span class="n">sfd</span><span class="o">.</span><span class="n">fetch</span><span class="p">()</span>
                        <span class="n">coords</span> <span class="o">=</span> <span class="n">SkyCoord</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">ra</span><span class="p">)</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">degree</span><span class="p">,</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dec</span><span class="p">)</span>\
                                          <span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">degree</span><span class="p">,</span> <span class="n">frame</span><span class="o">=</span><span class="s1">'icrs'</span><span class="p">)</span>
                        <span class="n">sfd</span> <span class="o">=</span> <span class="n">SFDQuery</span><span class="p">()</span>
                        <span class="c1">#sfd reddening</span>
                        <span class="n">sfd_ebv</span> <span class="o">=</span> <span class="n">sfd</span><span class="p">(</span><span class="n">coords</span><span class="p">)</span>
                        <span class="c1">#s&amp;f reddening</span>
                        <span class="n">snf_ebv</span> <span class="o">=</span> <span class="n">sfd_ebv</span><span class="o">*</span><span class="mf">0.86</span>
                        <span class="n">err_snf_ebv</span> <span class="o">=</span> <span class="mf">0.001</span><span class="o">*</span><span class="n">snf_ebv</span>
                        <span class="n">aj</span> <span class="o">=</span> <span class="mf">0.709</span><span class="o">*</span><span class="n">snf_ebv</span>
                        <span class="n">ah</span> <span class="o">=</span> <span class="mf">0.449</span><span class="o">*</span><span class="n">snf_ebv</span>
                        <span class="n">ak</span> <span class="o">=</span> <span class="mf">0.302</span><span class="o">*</span><span class="n">snf_ebv</span>
                <span class="k">return</span> <span class="n">snf_ebv</span><span class="p">,</span> <span class="n">err_snf_ebv</span><span class="p">,</span> <span class="n">aj</span><span class="p">,</span> <span class="n">ah</span><span class="p">,</span> <span class="n">ak</span>

        <span class="k">def</span> <span class="nf">extinction_corrected_photometry</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">                </span><span class="sd">"""</span>
<span class="sd">                        `irgsctool.ExtinctionCorrection.extinction_correctdd_photometry()`</span>

<span class="sd">                        This method corrects the input optical PANSTARRS data for reddening</span>
<span class="sd">                        and extinction along the line of site.</span>

<span class="sd">                        Returns:</span>
<span class="sd">                                ndarray: Extinction corrected PANSTARRS optical photometry.</span>

<span class="sd">                """</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">"########################################"</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">""</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">'Correcting the optical photometry of the probable stellar sources for extinction.'</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">""</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">"########################################"</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">""</span><span class="p">)</span>

                <span class="n">ebv</span><span class="p">,</span> <span class="n">err_ebv</span><span class="p">,</span><span class="n">_</span><span class="p">,</span><span class="n">_</span><span class="p">,</span><span class="n">_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_reddening</span><span class="p">()</span>
                <span class="n">ps_phot</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sgc</span><span class="o">.</span><span class="n">star_galaxy_classification</span><span class="p">()</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">''</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">'Length of PS1 data before ec is:'</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">ps_phot</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
                <span class="n">ps1_objid</span><span class="p">,</span> <span class="n">ps_ra</span><span class="p">,</span> <span class="n">err_ps_ra</span><span class="p">,</span> <span class="n">ps_dec</span><span class="p">,</span> <span class="n">err_ps_dec</span><span class="p">,</span> <span class="n">gpsf</span><span class="p">,</span> <span class="n">e_gpsf</span><span class="p">,</span> <span class="n">gkron</span><span class="p">,</span> <span class="n">e_gkron</span><span class="p">,</span>\
                <span class="n">rpsf</span><span class="p">,</span> <span class="n">e_rpsf</span><span class="p">,</span> <span class="n">rkron</span><span class="p">,</span> <span class="n">e_rkron</span><span class="p">,</span> <span class="n">ipsf</span><span class="p">,</span> <span class="n">e_ipsf</span><span class="p">,</span> <span class="n">ikron</span><span class="p">,</span> <span class="n">e_ikron</span><span class="p">,</span> <span class="n">zpsf</span><span class="p">,</span> <span class="n">e_zpsf</span><span class="p">,</span>\
                <span class="n">zkron</span><span class="p">,</span> <span class="n">e_zkron</span><span class="p">,</span> <span class="n">ypsf</span><span class="p">,</span> <span class="n">e_ypsf</span><span class="p">,</span> <span class="n">ykron</span><span class="p">,</span> <span class="n">e_ykron</span><span class="p">,</span> <span class="n">objinfoflag</span><span class="p">,</span> <span class="n">qualityflag</span><span class="p">,</span>\
                <span class="n">ndetections</span><span class="p">,</span> <span class="n">nstackdetections</span><span class="p">,</span> <span class="n">ginfoflag</span><span class="p">,</span> <span class="n">ginfoflag2</span><span class="p">,</span> <span class="n">ginfoflag3</span><span class="p">,</span> <span class="n">rinfoflag</span><span class="p">,</span>\
                <span class="n">rinfoflag2</span><span class="p">,</span> <span class="n">rinfoflag3</span><span class="p">,</span> <span class="n">iinfoflag</span><span class="p">,</span><span class="n">iinfoflag2</span><span class="p">,</span> <span class="n">iinfoflag3</span><span class="p">,</span> <span class="n">zinfoflag</span><span class="p">,</span> <span class="n">zinfoflag2</span><span class="p">,</span>\
                <span class="n">zinfoflag3</span><span class="p">,</span> <span class="n">yinfoflag</span><span class="p">,</span> <span class="n">yinfoflag2</span><span class="p">,</span> <span class="n">yinfoflag3</span> <span class="o">=</span> <span class="n">ps_phot</span>

                <span class="c1">#extinction in ps1 filters taken from Tonry et.al. 2012</span>
                <span class="n">ag</span> <span class="o">=</span> <span class="p">(</span><span class="n">ebv</span><span class="p">)</span><span class="o">*</span><span class="mf">0.88</span><span class="o">*</span><span class="p">(</span><span class="mf">3.613</span> <span class="o">-</span> <span class="mf">0.0972</span><span class="o">*</span><span class="p">(</span><span class="n">gpsf</span> <span class="o">-</span> <span class="n">ipsf</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.01</span><span class="o">*</span><span class="p">(</span><span class="n">gpsf</span> <span class="o">-</span> <span class="n">ipsf</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
                <span class="n">ar</span> <span class="o">=</span> <span class="p">(</span><span class="n">ebv</span><span class="p">)</span><span class="o">*</span><span class="mf">0.88</span><span class="o">*</span><span class="p">(</span><span class="mf">2.585</span> <span class="o">-</span> <span class="mf">0.0315</span><span class="o">*</span><span class="p">(</span><span class="n">gpsf</span> <span class="o">-</span> <span class="n">ipsf</span><span class="p">))</span>
                <span class="n">ai</span> <span class="o">=</span> <span class="p">(</span><span class="n">ebv</span><span class="p">)</span><span class="o">*</span><span class="mf">0.88</span><span class="o">*</span><span class="p">(</span><span class="mf">1.908</span> <span class="o">-</span> <span class="mf">0.0152</span><span class="o">*</span><span class="p">(</span><span class="n">gpsf</span> <span class="o">-</span> <span class="n">ipsf</span><span class="p">))</span>
                <span class="n">az</span> <span class="o">=</span> <span class="p">(</span><span class="n">ebv</span><span class="p">)</span><span class="o">*</span><span class="mf">0.88</span><span class="o">*</span><span class="p">(</span><span class="mf">1.499</span> <span class="o">-</span> <span class="mf">0.0023</span><span class="o">*</span><span class="p">(</span><span class="n">gpsf</span> <span class="o">-</span> <span class="n">ipsf</span><span class="p">))</span>
                <span class="n">ay</span> <span class="o">=</span> <span class="p">(</span><span class="n">ebv</span><span class="p">)</span><span class="o">*</span><span class="mf">0.88</span><span class="o">*</span><span class="p">(</span><span class="mf">1.251</span> <span class="o">-</span> <span class="mf">0.0027</span><span class="o">*</span><span class="p">(</span><span class="n">gpsf</span> <span class="o">-</span> <span class="n">ipsf</span><span class="p">))</span>

                <span class="n">e_gi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">e_gpsf</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">e_ipsf</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>

                <span class="c1">#error in extinction</span>
                <span class="n">e_ag</span> <span class="o">=</span> <span class="p">((</span><span class="n">err_ebv</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mf">3.613</span> <span class="o">-</span> <span class="mf">0.0972</span><span class="o">*</span><span class="p">(</span><span class="n">gpsf</span> <span class="o">-</span> <span class="n">ipsf</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.02</span><span class="o">*</span><span class="p">(</span><span class="n">gpsf</span> <span class="o">-</span> <span class="n">ipsf</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span><span class="o">+</span>\
                        <span class="p">((</span><span class="n">ebv</span><span class="p">)</span><span class="o">*</span><span class="p">((</span><span class="o">-</span><span class="mf">0.0972</span><span class="o">*</span><span class="n">e_gi</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="mf">0.02</span><span class="o">*</span><span class="p">(</span><span class="n">gpsf</span> <span class="o">-</span> <span class="n">ipsf</span><span class="p">)</span><span class="o">*</span><span class="n">e_gi</span><span class="p">)))</span>
                <span class="n">e_ar</span> <span class="o">=</span> <span class="p">(</span><span class="n">err_ebv</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mf">2.585</span> <span class="o">-</span> <span class="mf">0.0315</span><span class="o">*</span><span class="p">(</span><span class="n">gpsf</span> <span class="o">-</span> <span class="n">ipsf</span><span class="p">))</span> <span class="o">+</span> <span class="p">(</span><span class="n">ebv</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="mf">0.0315</span><span class="o">*</span><span class="n">e_gi</span><span class="p">)</span>
                <span class="n">e_ai</span> <span class="o">=</span> <span class="p">(</span><span class="n">err_ebv</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mf">1.908</span> <span class="o">-</span> <span class="mf">0.0152</span><span class="o">*</span><span class="p">(</span><span class="n">gpsf</span> <span class="o">-</span> <span class="n">ipsf</span><span class="p">))</span> <span class="o">+</span> <span class="p">(</span><span class="n">ebv</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="mf">0.0152</span><span class="o">*</span><span class="n">e_gi</span><span class="p">)</span>
                <span class="n">e_az</span> <span class="o">=</span> <span class="p">(</span><span class="n">err_ebv</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mf">1.499</span> <span class="o">-</span> <span class="mf">0.0023</span><span class="o">*</span><span class="p">(</span><span class="n">gpsf</span> <span class="o">-</span> <span class="n">ipsf</span><span class="p">))</span> <span class="o">+</span> <span class="p">(</span><span class="n">ebv</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="mf">0.0023</span><span class="o">*</span><span class="n">e_gi</span><span class="p">)</span>
                <span class="n">e_ay</span> <span class="o">=</span> <span class="p">(</span><span class="n">err_ebv</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mf">1.251</span> <span class="o">-</span> <span class="mf">0.0027</span><span class="o">*</span><span class="p">(</span><span class="n">gpsf</span> <span class="o">-</span> <span class="n">ipsf</span><span class="p">))</span> <span class="o">+</span> <span class="p">(</span><span class="n">ebv</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="mf">0.0027</span><span class="o">*</span><span class="n">e_gi</span><span class="p">)</span>

                <span class="c1">#"ec_" stands for extinction corrected magnitudes</span>

                <span class="n">ec_gmag</span> <span class="o">=</span> <span class="n">gpsf</span> <span class="o">-</span> <span class="n">ag</span>
                <span class="n">ec_rmag</span> <span class="o">=</span> <span class="n">rpsf</span> <span class="o">-</span> <span class="n">ar</span>
                <span class="n">ec_imag</span> <span class="o">=</span> <span class="n">ipsf</span> <span class="o">-</span> <span class="n">ai</span>
                <span class="n">ec_zmag</span> <span class="o">=</span> <span class="n">zpsf</span> <span class="o">-</span> <span class="n">az</span>
                <span class="n">ec_ymag</span> <span class="o">=</span> <span class="n">ypsf</span> <span class="o">-</span> <span class="n">ay</span>

                <span class="c1">#e_ec_ stands for error in extinction corrected magnitudes</span>

                <span class="n">e_ec_gmag</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="n">e_gpsf</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">e_ag</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
                <span class="n">e_ec_rmag</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="n">e_rpsf</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">e_ar</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
                <span class="n">e_ec_imag</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="n">e_ipsf</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">e_ai</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
                <span class="n">e_ec_zmag</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="n">e_zpsf</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">e_az</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
                <span class="n">e_ec_ymag</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="n">e_ypsf</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">e_ay</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>

                <span class="n">psf_phot</span> <span class="o">=</span> <span class="n">ps1_objid</span><span class="p">,</span><span class="n">ps_ra</span><span class="p">,</span><span class="n">err_ps_ra</span><span class="p">,</span><span class="n">ps_dec</span><span class="p">,</span><span class="n">err_ps_dec</span><span class="p">,</span>\
                        <span class="n">ec_gmag</span><span class="p">,</span><span class="n">e_ec_gmag</span><span class="p">,</span><span class="n">gkron</span><span class="p">,</span><span class="n">e_gkron</span><span class="p">,</span><span class="n">ec_rmag</span><span class="p">,</span><span class="n">e_ec_rmag</span><span class="p">,</span>\
                        <span class="n">rkron</span><span class="p">,</span> <span class="n">e_rkron</span><span class="p">,</span> <span class="n">ec_imag</span><span class="p">,</span> <span class="n">e_ec_imag</span><span class="p">,</span> <span class="n">ikron</span><span class="p">,</span> <span class="n">e_ikron</span><span class="p">,</span>\
                        <span class="n">ec_zmag</span><span class="p">,</span><span class="n">e_ec_zmag</span><span class="p">,</span><span class="n">zkron</span><span class="p">,</span><span class="n">e_zkron</span><span class="p">,</span><span class="n">ec_ymag</span><span class="p">,</span><span class="n">e_ec_ymag</span><span class="p">,</span>\
                        <span class="n">ykron</span><span class="p">,</span><span class="n">e_ykron</span><span class="p">,</span><span class="n">objinfoflag</span><span class="p">,</span><span class="n">qualityflag</span><span class="p">,</span><span class="n">ndetections</span><span class="p">,</span>\
                        <span class="n">nstackdetections</span><span class="p">,</span><span class="n">ginfoflag</span><span class="p">,</span><span class="n">ginfoflag2</span><span class="p">,</span><span class="n">ginfoflag3</span><span class="p">,</span>\
                        <span class="n">rinfoflag</span><span class="p">,</span><span class="n">rinfoflag2</span><span class="p">,</span><span class="n">rinfoflag3</span><span class="p">,</span><span class="n">iinfoflag</span><span class="p">,</span><span class="n">iinfoflag2</span><span class="p">,</span>\
                        <span class="n">iinfoflag3</span><span class="p">,</span><span class="n">zinfoflag</span><span class="p">,</span><span class="n">zinfoflag2</span><span class="p">,</span><span class="n">zinfoflag3</span><span class="p">,</span><span class="n">yinfoflag</span><span class="p">,</span>\
                        <span class="n">yinfoflag2</span><span class="p">,</span> <span class="n">yinfoflag3</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">'length of ps1 data after ec is:'</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">psf_phot</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
                <span class="k">return</span> <span class="n">psf_phot</span>
</code></pre></div></td></tr></table></div>
</details>
<div class="doc doc-children">
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="irgsctool._extinction_correction.ExtinctionCorrection.extinction_corrected_photometry">
<code class="highlight language-python"><span class="n">extinction_corrected_photometry</span><span class="p">()</span></code>
</h3>
<div class="doc doc-contents">
<p><code>irgsctool.ExtinctionCorrection.extinction_correctdd_photometry()</code></p>
<p>This method corrects the input optical PANSTARRS data for reddening
and extinction along the line of site.</p>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Name</th> <th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>ndarray</code></td> <td>
</td>
<td><p>Extinction corrected PANSTARRS optical photometry.</p></td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>irgsctool/_extinction_correction.py</code></summary>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">extinction_corrected_photometry</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""</span>
<span class="sd">                `irgsctool.ExtinctionCorrection.extinction_correctdd_photometry()`</span>

<span class="sd">                This method corrects the input optical PANSTARRS data for reddening</span>
<span class="sd">                and extinction along the line of site.</span>

<span class="sd">                Returns:</span>
<span class="sd">                        ndarray: Extinction corrected PANSTARRS optical photometry.</span>

<span class="sd">        """</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">"########################################"</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">""</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">'Correcting the optical photometry of the probable stellar sources for extinction.'</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">""</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">"########################################"</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">""</span><span class="p">)</span>

        <span class="n">ebv</span><span class="p">,</span> <span class="n">err_ebv</span><span class="p">,</span><span class="n">_</span><span class="p">,</span><span class="n">_</span><span class="p">,</span><span class="n">_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_reddening</span><span class="p">()</span>
        <span class="n">ps_phot</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sgc</span><span class="o">.</span><span class="n">star_galaxy_classification</span><span class="p">()</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">''</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">'Length of PS1 data before ec is:'</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">ps_phot</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
        <span class="n">ps1_objid</span><span class="p">,</span> <span class="n">ps_ra</span><span class="p">,</span> <span class="n">err_ps_ra</span><span class="p">,</span> <span class="n">ps_dec</span><span class="p">,</span> <span class="n">err_ps_dec</span><span class="p">,</span> <span class="n">gpsf</span><span class="p">,</span> <span class="n">e_gpsf</span><span class="p">,</span> <span class="n">gkron</span><span class="p">,</span> <span class="n">e_gkron</span><span class="p">,</span>\
        <span class="n">rpsf</span><span class="p">,</span> <span class="n">e_rpsf</span><span class="p">,</span> <span class="n">rkron</span><span class="p">,</span> <span class="n">e_rkron</span><span class="p">,</span> <span class="n">ipsf</span><span class="p">,</span> <span class="n">e_ipsf</span><span class="p">,</span> <span class="n">ikron</span><span class="p">,</span> <span class="n">e_ikron</span><span class="p">,</span> <span class="n">zpsf</span><span class="p">,</span> <span class="n">e_zpsf</span><span class="p">,</span>\
        <span class="n">zkron</span><span class="p">,</span> <span class="n">e_zkron</span><span class="p">,</span> <span class="n">ypsf</span><span class="p">,</span> <span class="n">e_ypsf</span><span class="p">,</span> <span class="n">ykron</span><span class="p">,</span> <span class="n">e_ykron</span><span class="p">,</span> <span class="n">objinfoflag</span><span class="p">,</span> <span class="n">qualityflag</span><span class="p">,</span>\
        <span class="n">ndetections</span><span class="p">,</span> <span class="n">nstackdetections</span><span class="p">,</span> <span class="n">ginfoflag</span><span class="p">,</span> <span class="n">ginfoflag2</span><span class="p">,</span> <span class="n">ginfoflag3</span><span class="p">,</span> <span class="n">rinfoflag</span><span class="p">,</span>\
        <span class="n">rinfoflag2</span><span class="p">,</span> <span class="n">rinfoflag3</span><span class="p">,</span> <span class="n">iinfoflag</span><span class="p">,</span><span class="n">iinfoflag2</span><span class="p">,</span> <span class="n">iinfoflag3</span><span class="p">,</span> <span class="n">zinfoflag</span><span class="p">,</span> <span class="n">zinfoflag2</span><span class="p">,</span>\
        <span class="n">zinfoflag3</span><span class="p">,</span> <span class="n">yinfoflag</span><span class="p">,</span> <span class="n">yinfoflag2</span><span class="p">,</span> <span class="n">yinfoflag3</span> <span class="o">=</span> <span class="n">ps_phot</span>

        <span class="c1">#extinction in ps1 filters taken from Tonry et.al. 2012</span>
        <span class="n">ag</span> <span class="o">=</span> <span class="p">(</span><span class="n">ebv</span><span class="p">)</span><span class="o">*</span><span class="mf">0.88</span><span class="o">*</span><span class="p">(</span><span class="mf">3.613</span> <span class="o">-</span> <span class="mf">0.0972</span><span class="o">*</span><span class="p">(</span><span class="n">gpsf</span> <span class="o">-</span> <span class="n">ipsf</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.01</span><span class="o">*</span><span class="p">(</span><span class="n">gpsf</span> <span class="o">-</span> <span class="n">ipsf</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">ar</span> <span class="o">=</span> <span class="p">(</span><span class="n">ebv</span><span class="p">)</span><span class="o">*</span><span class="mf">0.88</span><span class="o">*</span><span class="p">(</span><span class="mf">2.585</span> <span class="o">-</span> <span class="mf">0.0315</span><span class="o">*</span><span class="p">(</span><span class="n">gpsf</span> <span class="o">-</span> <span class="n">ipsf</span><span class="p">))</span>
        <span class="n">ai</span> <span class="o">=</span> <span class="p">(</span><span class="n">ebv</span><span class="p">)</span><span class="o">*</span><span class="mf">0.88</span><span class="o">*</span><span class="p">(</span><span class="mf">1.908</span> <span class="o">-</span> <span class="mf">0.0152</span><span class="o">*</span><span class="p">(</span><span class="n">gpsf</span> <span class="o">-</span> <span class="n">ipsf</span><span class="p">))</span>
        <span class="n">az</span> <span class="o">=</span> <span class="p">(</span><span class="n">ebv</span><span class="p">)</span><span class="o">*</span><span class="mf">0.88</span><span class="o">*</span><span class="p">(</span><span class="mf">1.499</span> <span class="o">-</span> <span class="mf">0.0023</span><span class="o">*</span><span class="p">(</span><span class="n">gpsf</span> <span class="o">-</span> <span class="n">ipsf</span><span class="p">))</span>
        <span class="n">ay</span> <span class="o">=</span> <span class="p">(</span><span class="n">ebv</span><span class="p">)</span><span class="o">*</span><span class="mf">0.88</span><span class="o">*</span><span class="p">(</span><span class="mf">1.251</span> <span class="o">-</span> <span class="mf">0.0027</span><span class="o">*</span><span class="p">(</span><span class="n">gpsf</span> <span class="o">-</span> <span class="n">ipsf</span><span class="p">))</span>

        <span class="n">e_gi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">e_gpsf</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">e_ipsf</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>

        <span class="c1">#error in extinction</span>
        <span class="n">e_ag</span> <span class="o">=</span> <span class="p">((</span><span class="n">err_ebv</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mf">3.613</span> <span class="o">-</span> <span class="mf">0.0972</span><span class="o">*</span><span class="p">(</span><span class="n">gpsf</span> <span class="o">-</span> <span class="n">ipsf</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.02</span><span class="o">*</span><span class="p">(</span><span class="n">gpsf</span> <span class="o">-</span> <span class="n">ipsf</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span><span class="o">+</span>\
                <span class="p">((</span><span class="n">ebv</span><span class="p">)</span><span class="o">*</span><span class="p">((</span><span class="o">-</span><span class="mf">0.0972</span><span class="o">*</span><span class="n">e_gi</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="mf">0.02</span><span class="o">*</span><span class="p">(</span><span class="n">gpsf</span> <span class="o">-</span> <span class="n">ipsf</span><span class="p">)</span><span class="o">*</span><span class="n">e_gi</span><span class="p">)))</span>
        <span class="n">e_ar</span> <span class="o">=</span> <span class="p">(</span><span class="n">err_ebv</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mf">2.585</span> <span class="o">-</span> <span class="mf">0.0315</span><span class="o">*</span><span class="p">(</span><span class="n">gpsf</span> <span class="o">-</span> <span class="n">ipsf</span><span class="p">))</span> <span class="o">+</span> <span class="p">(</span><span class="n">ebv</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="mf">0.0315</span><span class="o">*</span><span class="n">e_gi</span><span class="p">)</span>
        <span class="n">e_ai</span> <span class="o">=</span> <span class="p">(</span><span class="n">err_ebv</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mf">1.908</span> <span class="o">-</span> <span class="mf">0.0152</span><span class="o">*</span><span class="p">(</span><span class="n">gpsf</span> <span class="o">-</span> <span class="n">ipsf</span><span class="p">))</span> <span class="o">+</span> <span class="p">(</span><span class="n">ebv</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="mf">0.0152</span><span class="o">*</span><span class="n">e_gi</span><span class="p">)</span>
        <span class="n">e_az</span> <span class="o">=</span> <span class="p">(</span><span class="n">err_ebv</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mf">1.499</span> <span class="o">-</span> <span class="mf">0.0023</span><span class="o">*</span><span class="p">(</span><span class="n">gpsf</span> <span class="o">-</span> <span class="n">ipsf</span><span class="p">))</span> <span class="o">+</span> <span class="p">(</span><span class="n">ebv</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="mf">0.0023</span><span class="o">*</span><span class="n">e_gi</span><span class="p">)</span>
        <span class="n">e_ay</span> <span class="o">=</span> <span class="p">(</span><span class="n">err_ebv</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mf">1.251</span> <span class="o">-</span> <span class="mf">0.0027</span><span class="o">*</span><span class="p">(</span><span class="n">gpsf</span> <span class="o">-</span> <span class="n">ipsf</span><span class="p">))</span> <span class="o">+</span> <span class="p">(</span><span class="n">ebv</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="mf">0.0027</span><span class="o">*</span><span class="n">e_gi</span><span class="p">)</span>

        <span class="c1">#"ec_" stands for extinction corrected magnitudes</span>

        <span class="n">ec_gmag</span> <span class="o">=</span> <span class="n">gpsf</span> <span class="o">-</span> <span class="n">ag</span>
        <span class="n">ec_rmag</span> <span class="o">=</span> <span class="n">rpsf</span> <span class="o">-</span> <span class="n">ar</span>
        <span class="n">ec_imag</span> <span class="o">=</span> <span class="n">ipsf</span> <span class="o">-</span> <span class="n">ai</span>
        <span class="n">ec_zmag</span> <span class="o">=</span> <span class="n">zpsf</span> <span class="o">-</span> <span class="n">az</span>
        <span class="n">ec_ymag</span> <span class="o">=</span> <span class="n">ypsf</span> <span class="o">-</span> <span class="n">ay</span>

        <span class="c1">#e_ec_ stands for error in extinction corrected magnitudes</span>

        <span class="n">e_ec_gmag</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="n">e_gpsf</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">e_ag</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">e_ec_rmag</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="n">e_rpsf</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">e_ar</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">e_ec_imag</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="n">e_ipsf</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">e_ai</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">e_ec_zmag</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="n">e_zpsf</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">e_az</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">e_ec_ymag</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="n">e_ypsf</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">e_ay</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>

        <span class="n">psf_phot</span> <span class="o">=</span> <span class="n">ps1_objid</span><span class="p">,</span><span class="n">ps_ra</span><span class="p">,</span><span class="n">err_ps_ra</span><span class="p">,</span><span class="n">ps_dec</span><span class="p">,</span><span class="n">err_ps_dec</span><span class="p">,</span>\
                <span class="n">ec_gmag</span><span class="p">,</span><span class="n">e_ec_gmag</span><span class="p">,</span><span class="n">gkron</span><span class="p">,</span><span class="n">e_gkron</span><span class="p">,</span><span class="n">ec_rmag</span><span class="p">,</span><span class="n">e_ec_rmag</span><span class="p">,</span>\
                <span class="n">rkron</span><span class="p">,</span> <span class="n">e_rkron</span><span class="p">,</span> <span class="n">ec_imag</span><span class="p">,</span> <span class="n">e_ec_imag</span><span class="p">,</span> <span class="n">ikron</span><span class="p">,</span> <span class="n">e_ikron</span><span class="p">,</span>\
                <span class="n">ec_zmag</span><span class="p">,</span><span class="n">e_ec_zmag</span><span class="p">,</span><span class="n">zkron</span><span class="p">,</span><span class="n">e_zkron</span><span class="p">,</span><span class="n">ec_ymag</span><span class="p">,</span><span class="n">e_ec_ymag</span><span class="p">,</span>\
                <span class="n">ykron</span><span class="p">,</span><span class="n">e_ykron</span><span class="p">,</span><span class="n">objinfoflag</span><span class="p">,</span><span class="n">qualityflag</span><span class="p">,</span><span class="n">ndetections</span><span class="p">,</span>\
                <span class="n">nstackdetections</span><span class="p">,</span><span class="n">ginfoflag</span><span class="p">,</span><span class="n">ginfoflag2</span><span class="p">,</span><span class="n">ginfoflag3</span><span class="p">,</span>\
                <span class="n">rinfoflag</span><span class="p">,</span><span class="n">rinfoflag2</span><span class="p">,</span><span class="n">rinfoflag3</span><span class="p">,</span><span class="n">iinfoflag</span><span class="p">,</span><span class="n">iinfoflag2</span><span class="p">,</span>\
                <span class="n">iinfoflag3</span><span class="p">,</span><span class="n">zinfoflag</span><span class="p">,</span><span class="n">zinfoflag2</span><span class="p">,</span><span class="n">zinfoflag3</span><span class="p">,</span><span class="n">yinfoflag</span><span class="p">,</span>\
                <span class="n">yinfoflag2</span><span class="p">,</span> <span class="n">yinfoflag3</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">'length of ps1 data after ec is:'</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">psf_phot</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
        <span class="k">return</span> <span class="n">psf_phot</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="irgsctool._extinction_correction.ExtinctionCorrection.get_reddening">
<code class="highlight language-python"><span class="n">get_reddening</span><span class="p">()</span></code>
</h3>
<div class="doc doc-contents">
<p><code>irgsctool.ExtinctionCorrection.get_reddening()</code></p>
<p>This method obtains the reddening value for a given set of 
input coordinates from Schelgel et.al. 1998 (sfd) reddening
map. irgsctool uses Schlafly &amp; Finkbeiner 2011 (snf) reddening
map which is snf = 0.86*sfd.</p>
<p><strong>Raises:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<code>FileNotFoundError</code>
</td>
<td><p>if the sfd files are not present.</p></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Name</th> <th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>ebv</code></td> <td>
</td>
<td><p>Reddening from Schlafly &amp; Finkbeiner 2011</p></td>
</tr>
<tr>
<td><code>err_ebv</code></td> <td>
</td>
<td><p>Uncertinty in reddening</p></td>
</tr>
<tr>
<td><code>aj</code></td> <td>
</td>
<td><p>J-band extinction coefficient.</p></td>
</tr>
<tr>
<td><code>ah</code></td> <td>
</td>
<td><p>H-band extinction coefficient.</p></td>
</tr>
<tr>
<td><code>ak</code></td> <td>
</td>
<td><p>K-band extinction coefficient.</p></td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>irgsctool/_extinction_correction.py</code></summary>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_reddening</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""</span>
<span class="sd">                `irgsctool.ExtinctionCorrection.get_reddening()`</span>

<span class="sd">                This method obtains the reddening value for a given set of </span>
<span class="sd">                input coordinates from Schelgel et.al. 1998 (sfd) reddening</span>
<span class="sd">                map. irgsctool uses Schlafly &amp; Finkbeiner 2011 (snf) reddening</span>
<span class="sd">                map which is snf = 0.86*sfd.</span>

<span class="sd">                Raises:</span>
<span class="sd">                        FileNotFoundError: if the sfd files are not present.</span>

<span class="sd">                Returns:</span>
<span class="sd">                        ebv: Reddening from Schlafly &amp; Finkbeiner 2011</span>
<span class="sd">                        err_ebv: Uncertinty in reddening</span>
<span class="sd">                        aj: J-band extinction coefficient.</span>
<span class="sd">                        ah: H-band extinction coefficient.</span>
<span class="sd">                        ak: K-band extinction coefficient.</span>

<span class="sd">        """</span>
        <span class="k">try</span><span class="p">:</span>
                <span class="n">coords</span> <span class="o">=</span> <span class="n">SkyCoord</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">ra</span><span class="p">)</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">degree</span><span class="p">,</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dec</span><span class="p">)</span>\
                                  <span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">degree</span><span class="p">,</span> <span class="n">frame</span><span class="o">=</span><span class="s1">'icrs'</span><span class="p">)</span>
                <span class="n">sfd</span> <span class="o">=</span> <span class="n">SFDQuery</span><span class="p">()</span>
                <span class="c1">#sfd reddening</span>
                <span class="n">sfd_ebv</span> <span class="o">=</span> <span class="n">sfd</span><span class="p">(</span><span class="n">coords</span><span class="p">)</span>
                <span class="c1">#s&amp;f reddening</span>
                <span class="n">snf_ebv</span> <span class="o">=</span> <span class="n">sfd_ebv</span><span class="o">*</span><span class="mf">0.86</span>
                <span class="n">err_snf_ebv</span> <span class="o">=</span> <span class="mf">0.001</span><span class="o">*</span><span class="n">snf_ebv</span>
                <span class="n">aj</span> <span class="o">=</span> <span class="mf">0.709</span><span class="o">*</span><span class="n">snf_ebv</span>
                <span class="n">ah</span> <span class="o">=</span> <span class="mf">0.449</span><span class="o">*</span><span class="n">snf_ebv</span>
                <span class="n">ak</span> <span class="o">=</span> <span class="mf">0.302</span><span class="o">*</span><span class="n">snf_ebv</span>
        <span class="k">except</span> <span class="ne">FileNotFoundError</span><span class="p">:</span>
                <span class="n">dustmaps</span><span class="o">.</span><span class="n">sfd</span><span class="o">.</span><span class="n">fetch</span><span class="p">()</span>
                <span class="n">coords</span> <span class="o">=</span> <span class="n">SkyCoord</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">ra</span><span class="p">)</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">degree</span><span class="p">,</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dec</span><span class="p">)</span>\
                                  <span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">degree</span><span class="p">,</span> <span class="n">frame</span><span class="o">=</span><span class="s1">'icrs'</span><span class="p">)</span>
                <span class="n">sfd</span> <span class="o">=</span> <span class="n">SFDQuery</span><span class="p">()</span>
                <span class="c1">#sfd reddening</span>
                <span class="n">sfd_ebv</span> <span class="o">=</span> <span class="n">sfd</span><span class="p">(</span><span class="n">coords</span><span class="p">)</span>
                <span class="c1">#s&amp;f reddening</span>
                <span class="n">snf_ebv</span> <span class="o">=</span> <span class="n">sfd_ebv</span><span class="o">*</span><span class="mf">0.86</span>
                <span class="n">err_snf_ebv</span> <span class="o">=</span> <span class="mf">0.001</span><span class="o">*</span><span class="n">snf_ebv</span>
                <span class="n">aj</span> <span class="o">=</span> <span class="mf">0.709</span><span class="o">*</span><span class="n">snf_ebv</span>
                <span class="n">ah</span> <span class="o">=</span> <span class="mf">0.449</span><span class="o">*</span><span class="n">snf_ebv</span>
                <span class="n">ak</span> <span class="o">=</span> <span class="mf">0.302</span><span class="o">*</span><span class="n">snf_ebv</span>
        <span class="k">return</span> <span class="n">snf_ebv</span><span class="p">,</span> <span class="n">err_snf_ebv</span><span class="p">,</span> <span class="n">aj</span><span class="p">,</span> <span class="n">ah</span><span class="p">,</span> <span class="n">ak</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="doc doc-object doc-module">
<a id="irgsctool._sam"></a>
<div class="doc doc-contents first">
<div class="doc doc-children">
<div class="doc doc-object doc-class">
<h2 class="doc doc-heading" id="irgsctool._sam.Models">
<code>Models</code>
</h2>
<div class="doc doc-contents">
<p><strong><em>Models</em></strong> class reads and selects the required
Kurucz and Phoenix stellar atmospheric models in the
generation of IRGSC.</p>
<details class="quote">
<summary>Source code in <code>irgsctool/_sam.py</code></summary>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">  8</span>
<span class="normal">  9</span>
<span class="normal"> 10</span>
<span class="normal"> 11</span>
<span class="normal"> 12</span>
<span class="normal"> 13</span>
<span class="normal"> 14</span>
<span class="normal"> 15</span>
<span class="normal"> 16</span>
<span class="normal"> 17</span>
<span class="normal"> 18</span>
<span class="normal"> 19</span>
<span class="normal"> 20</span>
<span class="normal"> 21</span>
<span class="normal"> 22</span>
<span class="normal"> 23</span>
<span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">Models</span><span class="p">():</span>
<span class="w">        </span><span class="sd">"""</span>

<span class="sd">                ***Models*** class reads and selects the required</span>
<span class="sd">                Kurucz and Phoenix stellar atmospheric models in the</span>
<span class="sd">                generation of IRGSC.</span>

<span class="sd">        """</span>
        <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">use_sam</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">use_sam</span> <span class="o">=</span> <span class="n">use_sam</span>


        <span class="k">def</span> <span class="nf">read_sam_file</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">use_sam</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">                </span><span class="sd">"""</span>
<span class="sd">                        `irgsctool.Models.read_sam_file(use_sam=None)`</span>

<span class="sd">                        &lt;justify&gt; </span>
<span class="sd">                        This method reads the model parameters and results from the</span>
<span class="sd">                        interpolated Kurucz or the Phoenix model files. use_sam is </span>
<span class="sd">                        bool and decides which model file to be read.</span>
<span class="sd">                        To use the interpolated Kurucz models, set ***use_sam = Kurucz ***.</span>
<span class="sd">                        Similarly, *** use_sam = Phoenix *** to use interpolated Phoenix models.&lt;/justify&gt;</span>

<span class="sd">                        Raises:</span>
<span class="sd">                                AttributeError: if use_sam is None.</span>
<span class="sd">                                FileNotFoundError: if the model files are not found.</span>

<span class="sd">                """</span>
                <span class="k">if</span> <span class="n">use_sam</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
                        <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span><span class="s1">'Input on which Stellar Atmospheric Model to be use not given'</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">use_sam</span> <span class="o">==</span> <span class="s1">'Kurucz'</span><span class="p">:</span>
                        <span class="nb">print</span><span class="p">(</span><span class="s2">""</span><span class="p">)</span>
                        <span class="nb">print</span><span class="p">(</span><span class="s1">'Reading Interpolated Kurucz SAMs'</span><span class="p">)</span>
                        <span class="nb">print</span><span class="p">(</span><span class="s2">""</span><span class="p">)</span>
                        <span class="nb">print</span><span class="p">(</span><span class="s1">'data_dir = '</span><span class="p">,</span> <span class="n">data_dir</span><span class="p">)</span>
                        <span class="k">try</span><span class="p">:</span>
                                <span class="n">p2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">genfromtxt</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">data_dir</span><span class="p">)</span> <span class="o">+</span><span class="s1">'/data/interpolated_kurucz.txt'</span><span class="p">)</span>
                        <span class="k">except</span><span class="p">:</span>
                                <span class="ne">FileNotFoundError</span><span class="p">(</span><span class="s1">'interpolated_kurucz.txt file not found'</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">use_sam</span> <span class="o">==</span> <span class="s1">'Phoenix'</span><span class="p">:</span>
                        <span class="nb">print</span><span class="p">(</span><span class="s2">""</span><span class="p">)</span>
                        <span class="nb">print</span><span class="p">(</span><span class="s1">'Reading Interpolated Phoenix SAMs'</span><span class="p">)</span>
                        <span class="nb">print</span><span class="p">(</span><span class="s2">""</span><span class="p">)</span>
                        <span class="nb">print</span><span class="p">(</span><span class="s1">'data_dir = '</span><span class="p">,</span> <span class="n">data_dir</span><span class="p">)</span>
                        <span class="k">try</span><span class="p">:</span>
                                <span class="n">p2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">genfromtxt</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">data_dir</span><span class="p">)</span><span class="o">+</span><span class="s1">'/data/interpolated_phoenix.txt'</span><span class="p">)</span>
                        <span class="k">except</span><span class="p">:</span>
                                <span class="ne">FileNotFoundError</span><span class="p">(</span><span class="s1">'interpolated_phoenix.txt not found'</span><span class="p">)</span>
                <span class="n">teff</span> <span class="o">=</span> <span class="n">p2</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">logg</span> <span class="o">=</span> <span class="n">p2</span><span class="p">[:,</span><span class="mi">2</span><span class="p">]</span>
                <span class="n">feh</span> <span class="o">=</span> <span class="n">p2</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span>
                <span class="n">sam_g</span> <span class="o">=</span> <span class="n">p2</span><span class="p">[:,</span><span class="mi">3</span><span class="p">]</span>
                <span class="n">sam_r</span> <span class="o">=</span> <span class="n">p2</span><span class="p">[:,</span><span class="mi">4</span><span class="p">]</span>
                <span class="n">sam_i</span> <span class="o">=</span> <span class="n">p2</span><span class="p">[:,</span><span class="mi">5</span><span class="p">]</span>
                <span class="n">sam_z</span> <span class="o">=</span> <span class="n">p2</span><span class="p">[:,</span><span class="mi">6</span><span class="p">]</span>
                <span class="n">sam_y</span> <span class="o">=</span> <span class="n">p2</span><span class="p">[:,</span><span class="mi">7</span><span class="p">]</span>
                <span class="n">sam_j</span> <span class="o">=</span> <span class="n">p2</span><span class="p">[:,</span><span class="mi">8</span><span class="p">]</span>
                <span class="n">sam_h</span> <span class="o">=</span> <span class="n">p2</span><span class="p">[:,</span><span class="mi">9</span><span class="p">]</span>
                <span class="n">sam_k</span> <span class="o">=</span> <span class="n">p2</span><span class="p">[:,</span><span class="mi">10</span><span class="p">]</span>

                <span class="n">sam_params</span> <span class="o">=</span>  <span class="n">teff</span><span class="p">,</span> <span class="n">logg</span><span class="p">,</span> <span class="n">feh</span><span class="p">,</span> <span class="n">sam_g</span><span class="p">,</span> <span class="n">sam_r</span><span class="p">,</span> <span class="n">sam_i</span><span class="p">,</span> <span class="n">sam_z</span><span class="p">,</span> <span class="n">sam_y</span><span class="p">,</span> <span class="n">sam_j</span><span class="p">,</span> <span class="n">sam_h</span><span class="p">,</span> <span class="n">sam_k</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">sam_params</span> <span class="o">=</span> <span class="n">sam_params</span>
                <span class="k">return</span> <span class="n">sam_params</span>

        <span class="k">def</span> <span class="nf">select_sam_range</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">teff_range</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">logg_range</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">feh_range</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> 
                                <span class="n">use_optimal_method</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">                </span><span class="sd">"""</span>

<span class="sd">                        `irgsctool.Models.select_sam_range(teff_range=None, logg_range=None,</span>
<span class="sd">                        feh_range=None, use_optimal_method=False)`</span>

<span class="sd">                        &lt;justify&gt; This method selects the range of the models to be</span>
<span class="sd">                        used in the generation of IRGSC.</span>

<span class="sd">                        &lt;justify&gt; If *** use_optimal_method *** is set to True, the following </span>
<span class="sd">                        range of model parameters is selected:&lt;/justify&gt;</span>

<span class="sd">                        | Model Name    |               \(T_{eff}\) (K)   |    log(g) (dex)  |    [Fe/H] (dex)|</span>
<span class="sd">                        | :-------------| :-------------------------| :----------------| :--------------|</span>
<span class="sd">                        | Phoenix (C1)  |                2800 - 5000 |    3.0 - 5.5    |     -5.0 - -1.5| </span>
<span class="sd">                        | Phoenix (C2)  |              2800 - 4000   |   0.0 - 3.0     |     -0.5 - 1.5 | </span>
<span class="sd">                        | KuruczCastelli-Kurucz (K0) |  4000 - 10000  |   ---         |       ---      |</span>

<span class="sd">                        Returns:</span>
<span class="sd">                                sam_params :type: ndarray: Selected model parameters and model </span>
<span class="sd">                                magnitudes to generate IRGSC</span>

<span class="sd">                        Raises:</span>
<span class="sd">                                TypreError: if range of parameters is not given.</span>

<span class="sd">                """</span>

                <span class="n">teff</span><span class="p">,</span> <span class="n">logg</span><span class="p">,</span> <span class="n">feh</span><span class="p">,</span> <span class="n">sam_g</span><span class="p">,</span> <span class="n">sam_r</span><span class="p">,</span> <span class="n">sam_i</span><span class="p">,</span> <span class="n">sam_z</span><span class="p">,</span> <span class="n">sam_y</span><span class="p">,</span> <span class="n">sam_j</span><span class="p">,</span> <span class="n">sam_h</span><span class="p">,</span> <span class="n">sam_k</span>\
                                        <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">read_sam_file</span><span class="p">(</span><span class="n">use_sam</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">use_sam</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">use_optimal_method</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">True</span><span class="p">:</span>
                        <span class="k">if</span> <span class="n">teff_range</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">feh_range</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">logg_range</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                                <span class="n">teff_lower_limit</span> <span class="o">=</span> <span class="n">teff_range</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span> <span class="n">teff_upper_limit</span> <span class="o">=</span> <span class="n">teff_range</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                                <span class="n">index_sam</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">((</span><span class="n">teff</span><span class="o">&gt;</span><span class="n">teff_lower_limit</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">teff</span><span class="o">&lt;</span><span class="n">teff_upper_limit</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
                        <span class="k">elif</span> <span class="n">teff_range</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">logg_range</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">feh_range</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                                <span class="k">raise</span>  <span class="ne">TypeError</span><span class="p">(</span><span class="s2">"Parameter range must be provided"</span><span class="p">)</span>
                        <span class="k">elif</span> <span class="n">teff_range</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">feh_range</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">logg_range</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                                <span class="n">teff_lower_limit</span> <span class="o">=</span> <span class="n">teff_range</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span> <span class="n">teff_upper_limit</span> <span class="o">=</span> <span class="n">teff_range</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                                <span class="n">logg_lower_limit</span> <span class="o">=</span> <span class="n">logg_range</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span> <span class="n">logg_upper_limit</span> <span class="o">=</span> <span class="n">logg_range</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                                <span class="n">feh_lower_limit</span> <span class="o">=</span> <span class="n">feh_range</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span> <span class="n">feh_upper_limit</span> <span class="o">=</span> <span class="n">feh_range</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                                <span class="n">index_sam</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">((</span><span class="n">teff</span><span class="o">&gt;</span><span class="n">teff_lower_limit</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">teff</span><span class="o">&lt;</span><span class="n">teff_upper_limit</span><span class="p">)</span>\
                                   <span class="o">&amp;</span> <span class="p">(</span><span class="n">feh</span><span class="o">&gt;</span><span class="n">feh_lower_limit</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">feh</span><span class="o">&lt;</span><span class="n">feh_upper_limit</span><span class="p">)</span>\
                                        <span class="o">&amp;</span> <span class="p">(</span><span class="n">logg</span><span class="o">&gt;</span><span class="n">logg_lower_limit</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">logg</span><span class="o">&lt;</span><span class="n">logg_upper_limit</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
                <span class="k">elif</span> <span class="n">use_optimal_method</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
                        <span class="n">teff_lower_limit</span> <span class="o">=</span> <span class="n">teff_range</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span> <span class="n">teff_upper_limit</span> <span class="o">=</span> <span class="n">teff_range</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                        <span class="n">logg_lower_limit</span> <span class="o">=</span> <span class="n">logg_range</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span> <span class="n">logg_upper_limit</span> <span class="o">=</span> <span class="n">logg_range</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                        <span class="n">feh_lower_limit</span> <span class="o">=</span> <span class="n">feh_range</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span> <span class="n">feh_upper_limit</span> <span class="o">=</span> <span class="n">feh_range</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

                        <span class="n">index_sam</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">((</span><span class="n">teff</span><span class="o">&gt;</span><span class="n">teff_lower_limit</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">teff</span><span class="o">&lt;</span><span class="n">teff_upper_limit</span><span class="p">)</span>\
                                   <span class="o">&amp;</span> <span class="p">(</span><span class="n">feh</span><span class="o">&gt;</span><span class="n">feh_lower_limit</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">feh</span><span class="o">&lt;</span><span class="n">feh_upper_limit</span><span class="p">)</span>\
                                        <span class="o">&amp;</span> <span class="p">(</span><span class="n">logg</span><span class="o">&gt;</span><span class="n">logg_lower_limit</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">logg</span><span class="o">&lt;</span><span class="n">logg_upper_limit</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>

                <span class="n">sam_params</span> <span class="o">=</span>  <span class="n">teff</span><span class="p">[</span><span class="n">index_sam</span><span class="p">],</span> <span class="n">logg</span><span class="p">[</span><span class="n">index_sam</span><span class="p">],</span> <span class="n">feh</span><span class="p">[</span><span class="n">index_sam</span><span class="p">],</span> <span class="n">sam_g</span><span class="p">[</span><span class="n">index_sam</span><span class="p">],</span> <span class="n">sam_r</span><span class="p">[</span><span class="n">index_sam</span><span class="p">],</span>\
                                        <span class="n">sam_i</span><span class="p">[</span><span class="n">index_sam</span><span class="p">],</span> <span class="n">sam_z</span><span class="p">[</span><span class="n">index_sam</span><span class="p">],</span> <span class="n">sam_y</span><span class="p">[</span><span class="n">index_sam</span><span class="p">],</span> <span class="n">sam_j</span><span class="p">[</span><span class="n">index_sam</span><span class="p">],</span>\
                                        <span class="n">sam_h</span><span class="p">[</span><span class="n">index_sam</span><span class="p">],</span> <span class="n">sam_k</span><span class="p">[</span><span class="n">index_sam</span><span class="p">]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">sam_params</span> <span class="o">=</span> <span class="n">sam_params</span>
                <span class="k">return</span> <span class="n">sam_params</span>
</code></pre></div></td></tr></table></div>
</details>
<div class="doc doc-children">
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="irgsctool._sam.Models.read_sam_file">
<code class="highlight language-python"><span class="n">read_sam_file</span><span class="p">(</span><span class="n">use_sam</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>
</h3>
<div class="doc doc-contents">
<p><code>irgsctool.Models.read_sam_file(use_sam=None)</code></p>
<p><justify> 
This method reads the model parameters and results from the
interpolated Kurucz or the Phoenix model files. use_sam is 
bool and decides which model file to be read.
To use the interpolated Kurucz models, set <strong><em>use_sam = Kurucz </em></strong>.
Similarly, <strong><em> use_sam = Phoenix </em></strong> to use interpolated Phoenix models.</justify></p>
<p><strong>Raises:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<code>AttributeError</code>
</td>
<td><p>if use_sam is None.</p></td>
</tr>
<tr>
<td>
<code>FileNotFoundError</code>
</td>
<td><p>if the model files are not found.</p></td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>irgsctool/_sam.py</code></summary>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">read_sam_file</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">use_sam</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""</span>
<span class="sd">                `irgsctool.Models.read_sam_file(use_sam=None)`</span>

<span class="sd">                &lt;justify&gt; </span>
<span class="sd">                This method reads the model parameters and results from the</span>
<span class="sd">                interpolated Kurucz or the Phoenix model files. use_sam is </span>
<span class="sd">                bool and decides which model file to be read.</span>
<span class="sd">                To use the interpolated Kurucz models, set ***use_sam = Kurucz ***.</span>
<span class="sd">                Similarly, *** use_sam = Phoenix *** to use interpolated Phoenix models.&lt;/justify&gt;</span>

<span class="sd">                Raises:</span>
<span class="sd">                        AttributeError: if use_sam is None.</span>
<span class="sd">                        FileNotFoundError: if the model files are not found.</span>

<span class="sd">        """</span>
        <span class="k">if</span> <span class="n">use_sam</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span><span class="s1">'Input on which Stellar Atmospheric Model to be use not given'</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">use_sam</span> <span class="o">==</span> <span class="s1">'Kurucz'</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">""</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">'Reading Interpolated Kurucz SAMs'</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">""</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">'data_dir = '</span><span class="p">,</span> <span class="n">data_dir</span><span class="p">)</span>
                <span class="k">try</span><span class="p">:</span>
                        <span class="n">p2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">genfromtxt</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">data_dir</span><span class="p">)</span> <span class="o">+</span><span class="s1">'/data/interpolated_kurucz.txt'</span><span class="p">)</span>
                <span class="k">except</span><span class="p">:</span>
                        <span class="ne">FileNotFoundError</span><span class="p">(</span><span class="s1">'interpolated_kurucz.txt file not found'</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">use_sam</span> <span class="o">==</span> <span class="s1">'Phoenix'</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">""</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">'Reading Interpolated Phoenix SAMs'</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">""</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">'data_dir = '</span><span class="p">,</span> <span class="n">data_dir</span><span class="p">)</span>
                <span class="k">try</span><span class="p">:</span>
                        <span class="n">p2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">genfromtxt</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">data_dir</span><span class="p">)</span><span class="o">+</span><span class="s1">'/data/interpolated_phoenix.txt'</span><span class="p">)</span>
                <span class="k">except</span><span class="p">:</span>
                        <span class="ne">FileNotFoundError</span><span class="p">(</span><span class="s1">'interpolated_phoenix.txt not found'</span><span class="p">)</span>
        <span class="n">teff</span> <span class="o">=</span> <span class="n">p2</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">logg</span> <span class="o">=</span> <span class="n">p2</span><span class="p">[:,</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">feh</span> <span class="o">=</span> <span class="n">p2</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">sam_g</span> <span class="o">=</span> <span class="n">p2</span><span class="p">[:,</span><span class="mi">3</span><span class="p">]</span>
        <span class="n">sam_r</span> <span class="o">=</span> <span class="n">p2</span><span class="p">[:,</span><span class="mi">4</span><span class="p">]</span>
        <span class="n">sam_i</span> <span class="o">=</span> <span class="n">p2</span><span class="p">[:,</span><span class="mi">5</span><span class="p">]</span>
        <span class="n">sam_z</span> <span class="o">=</span> <span class="n">p2</span><span class="p">[:,</span><span class="mi">6</span><span class="p">]</span>
        <span class="n">sam_y</span> <span class="o">=</span> <span class="n">p2</span><span class="p">[:,</span><span class="mi">7</span><span class="p">]</span>
        <span class="n">sam_j</span> <span class="o">=</span> <span class="n">p2</span><span class="p">[:,</span><span class="mi">8</span><span class="p">]</span>
        <span class="n">sam_h</span> <span class="o">=</span> <span class="n">p2</span><span class="p">[:,</span><span class="mi">9</span><span class="p">]</span>
        <span class="n">sam_k</span> <span class="o">=</span> <span class="n">p2</span><span class="p">[:,</span><span class="mi">10</span><span class="p">]</span>

        <span class="n">sam_params</span> <span class="o">=</span>  <span class="n">teff</span><span class="p">,</span> <span class="n">logg</span><span class="p">,</span> <span class="n">feh</span><span class="p">,</span> <span class="n">sam_g</span><span class="p">,</span> <span class="n">sam_r</span><span class="p">,</span> <span class="n">sam_i</span><span class="p">,</span> <span class="n">sam_z</span><span class="p">,</span> <span class="n">sam_y</span><span class="p">,</span> <span class="n">sam_j</span><span class="p">,</span> <span class="n">sam_h</span><span class="p">,</span> <span class="n">sam_k</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sam_params</span> <span class="o">=</span> <span class="n">sam_params</span>
        <span class="k">return</span> <span class="n">sam_params</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="irgsctool._sam.Models.select_sam_range">
<code class="highlight language-python"><span class="n">select_sam_range</span><span class="p">(</span><span class="n">teff_range</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">logg_range</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">feh_range</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">use_optimal_method</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>
</h3>
<div class="doc doc-contents">
<p><code>irgsctool.Models.select_sam_range(teff_range=None, logg_range=None,
feh_range=None, use_optimal_method=False)</code></p>
<p><justify> This method selects the range of the models to be
used in the generation of IRGSC.</justify></p>
<p><justify> If <strong><em> use_optimal_method </em></strong> is set to True, the following 
range of model parameters is selected:</justify></p>
<table>
<thead>
<tr>
<th align="left">Model Name</th>
<th align="left"><span class="arithmatex">\(T_{eff}\)</span> (K)</th>
<th align="left">log(g) (dex)</th>
<th align="left">[Fe/H] (dex)</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">Phoenix (C1)</td>
<td align="left">2800 - 5000</td>
<td align="left">3.0 - 5.5</td>
<td align="left">-5.0 - -1.5</td>
</tr>
<tr>
<td align="left">Phoenix (C2)</td>
<td align="left">2800 - 4000</td>
<td align="left">0.0 - 3.0</td>
<td align="left">-0.5 - 1.5</td>
</tr>
<tr>
<td align="left">KuruczCastelli-Kurucz (K0)</td>
<td align="left">4000 - 10000</td>
<td align="left">---</td>
<td align="left">---</td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Name</th> <th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>sam_params</code></td> <td>
</td>
<td><p>type: ndarray: Selected model parameters and model </p></td>
</tr>
<tr>
<td></td> <td>
</td>
<td><p>magnitudes to generate IRGSC</p></td>
</tr>
</tbody>
</table>
<p><strong>Raises:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<code>TypreError</code>
</td>
<td><p>if range of parameters is not given.</p></td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>irgsctool/_sam.py</code></summary>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">select_sam_range</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">teff_range</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">logg_range</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">feh_range</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> 
                        <span class="n">use_optimal_method</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""</span>

<span class="sd">                `irgsctool.Models.select_sam_range(teff_range=None, logg_range=None,</span>
<span class="sd">                feh_range=None, use_optimal_method=False)`</span>

<span class="sd">                &lt;justify&gt; This method selects the range of the models to be</span>
<span class="sd">                used in the generation of IRGSC.</span>

<span class="sd">                &lt;justify&gt; If *** use_optimal_method *** is set to True, the following </span>
<span class="sd">                range of model parameters is selected:&lt;/justify&gt;</span>

<span class="sd">                | Model Name    |               \(T_{eff}\) (K)   |    log(g) (dex)  |    [Fe/H] (dex)|</span>
<span class="sd">                | :-------------| :-------------------------| :----------------| :--------------|</span>
<span class="sd">                | Phoenix (C1)  |                2800 - 5000 |    3.0 - 5.5    |     -5.0 - -1.5| </span>
<span class="sd">                | Phoenix (C2)  |              2800 - 4000   |   0.0 - 3.0     |     -0.5 - 1.5 | </span>
<span class="sd">                | KuruczCastelli-Kurucz (K0) |  4000 - 10000  |   ---         |       ---      |</span>

<span class="sd">                Returns:</span>
<span class="sd">                        sam_params :type: ndarray: Selected model parameters and model </span>
<span class="sd">                        magnitudes to generate IRGSC</span>

<span class="sd">                Raises:</span>
<span class="sd">                        TypreError: if range of parameters is not given.</span>

<span class="sd">        """</span>

        <span class="n">teff</span><span class="p">,</span> <span class="n">logg</span><span class="p">,</span> <span class="n">feh</span><span class="p">,</span> <span class="n">sam_g</span><span class="p">,</span> <span class="n">sam_r</span><span class="p">,</span> <span class="n">sam_i</span><span class="p">,</span> <span class="n">sam_z</span><span class="p">,</span> <span class="n">sam_y</span><span class="p">,</span> <span class="n">sam_j</span><span class="p">,</span> <span class="n">sam_h</span><span class="p">,</span> <span class="n">sam_k</span>\
                                <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">read_sam_file</span><span class="p">(</span><span class="n">use_sam</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">use_sam</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">use_optimal_method</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">True</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">teff_range</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">feh_range</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">logg_range</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                        <span class="n">teff_lower_limit</span> <span class="o">=</span> <span class="n">teff_range</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span> <span class="n">teff_upper_limit</span> <span class="o">=</span> <span class="n">teff_range</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                        <span class="n">index_sam</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">((</span><span class="n">teff</span><span class="o">&gt;</span><span class="n">teff_lower_limit</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">teff</span><span class="o">&lt;</span><span class="n">teff_upper_limit</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
                <span class="k">elif</span> <span class="n">teff_range</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">logg_range</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">feh_range</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                        <span class="k">raise</span>  <span class="ne">TypeError</span><span class="p">(</span><span class="s2">"Parameter range must be provided"</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">teff_range</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">feh_range</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">logg_range</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                        <span class="n">teff_lower_limit</span> <span class="o">=</span> <span class="n">teff_range</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span> <span class="n">teff_upper_limit</span> <span class="o">=</span> <span class="n">teff_range</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                        <span class="n">logg_lower_limit</span> <span class="o">=</span> <span class="n">logg_range</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span> <span class="n">logg_upper_limit</span> <span class="o">=</span> <span class="n">logg_range</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                        <span class="n">feh_lower_limit</span> <span class="o">=</span> <span class="n">feh_range</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span> <span class="n">feh_upper_limit</span> <span class="o">=</span> <span class="n">feh_range</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                        <span class="n">index_sam</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">((</span><span class="n">teff</span><span class="o">&gt;</span><span class="n">teff_lower_limit</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">teff</span><span class="o">&lt;</span><span class="n">teff_upper_limit</span><span class="p">)</span>\
                           <span class="o">&amp;</span> <span class="p">(</span><span class="n">feh</span><span class="o">&gt;</span><span class="n">feh_lower_limit</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">feh</span><span class="o">&lt;</span><span class="n">feh_upper_limit</span><span class="p">)</span>\
                                <span class="o">&amp;</span> <span class="p">(</span><span class="n">logg</span><span class="o">&gt;</span><span class="n">logg_lower_limit</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">logg</span><span class="o">&lt;</span><span class="n">logg_upper_limit</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">elif</span> <span class="n">use_optimal_method</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
                <span class="n">teff_lower_limit</span> <span class="o">=</span> <span class="n">teff_range</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span> <span class="n">teff_upper_limit</span> <span class="o">=</span> <span class="n">teff_range</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                <span class="n">logg_lower_limit</span> <span class="o">=</span> <span class="n">logg_range</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span> <span class="n">logg_upper_limit</span> <span class="o">=</span> <span class="n">logg_range</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                <span class="n">feh_lower_limit</span> <span class="o">=</span> <span class="n">feh_range</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span> <span class="n">feh_upper_limit</span> <span class="o">=</span> <span class="n">feh_range</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

                <span class="n">index_sam</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">((</span><span class="n">teff</span><span class="o">&gt;</span><span class="n">teff_lower_limit</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">teff</span><span class="o">&lt;</span><span class="n">teff_upper_limit</span><span class="p">)</span>\
                           <span class="o">&amp;</span> <span class="p">(</span><span class="n">feh</span><span class="o">&gt;</span><span class="n">feh_lower_limit</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">feh</span><span class="o">&lt;</span><span class="n">feh_upper_limit</span><span class="p">)</span>\
                                <span class="o">&amp;</span> <span class="p">(</span><span class="n">logg</span><span class="o">&gt;</span><span class="n">logg_lower_limit</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">logg</span><span class="o">&lt;</span><span class="n">logg_upper_limit</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>

        <span class="n">sam_params</span> <span class="o">=</span>  <span class="n">teff</span><span class="p">[</span><span class="n">index_sam</span><span class="p">],</span> <span class="n">logg</span><span class="p">[</span><span class="n">index_sam</span><span class="p">],</span> <span class="n">feh</span><span class="p">[</span><span class="n">index_sam</span><span class="p">],</span> <span class="n">sam_g</span><span class="p">[</span><span class="n">index_sam</span><span class="p">],</span> <span class="n">sam_r</span><span class="p">[</span><span class="n">index_sam</span><span class="p">],</span>\
                                <span class="n">sam_i</span><span class="p">[</span><span class="n">index_sam</span><span class="p">],</span> <span class="n">sam_z</span><span class="p">[</span><span class="n">index_sam</span><span class="p">],</span> <span class="n">sam_y</span><span class="p">[</span><span class="n">index_sam</span><span class="p">],</span> <span class="n">sam_j</span><span class="p">[</span><span class="n">index_sam</span><span class="p">],</span>\
                                <span class="n">sam_h</span><span class="p">[</span><span class="n">index_sam</span><span class="p">],</span> <span class="n">sam_k</span><span class="p">[</span><span class="n">index_sam</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sam_params</span> <span class="o">=</span> <span class="n">sam_params</span>
        <span class="k">return</span> <span class="n">sam_params</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="doc doc-object doc-module">
<a id="irgsctool._fitting"></a>
<div class="doc doc-contents first">
<div class="doc doc-children">
<div class="doc doc-object doc-class">
<h2 class="doc doc-heading" id="irgsctool._fitting.GenerateIRGSC">
<code>GenerateIRGSC</code>
</h2>
<div class="doc doc-contents">
<p><justify> The <strong><em> GenerateIRGSC class </em></strong> hosts method to generate a catalog of
probable stellar sources in the PANSTARRS data with their computed magnitudes, astrometric
information from GAIA DR3 data, best fitted model parameters and flags.</justify></p>
<details class="quote">
<summary>Source code in <code>irgsctool/_fitting.py</code></summary>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">GenerateIRGSC</span><span class="p">():</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">        &lt;justify&gt; The *** GenerateIRGSC class *** hosts method to generate a catalog of</span>
<span class="sd">        probable stellar sources in the PANSTARRS data with their computed magnitudes, astrometric</span>
<span class="sd">        information from GAIA DR3 data, best fitted model parameters and flags.&lt;/justify&gt;</span>

<span class="sd">    """</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ra</span><span class="p">,</span> <span class="n">dec</span><span class="p">):</span>
         <span class="bp">self</span><span class="o">.</span><span class="n">ra</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dec</span> <span class="o">=</span> <span class="n">ra</span><span class="p">,</span> <span class="n">dec</span>
         <span class="bp">self</span><span class="o">.</span><span class="n">rd</span> <span class="o">=</span> <span class="n">ReadData</span><span class="p">(</span><span class="n">ra</span><span class="p">,</span><span class="n">dec</span><span class="p">)</span>
         <span class="bp">self</span><span class="o">.</span><span class="n">ec</span> <span class="o">=</span> <span class="n">EC</span><span class="p">(</span><span class="n">ra</span><span class="p">,</span> <span class="n">dec</span><span class="p">)</span>
         <span class="bp">self</span><span class="o">.</span><span class="n">k0</span> <span class="o">=</span> <span class="n">Models</span><span class="p">(</span><span class="n">use_sam</span><span class="o">=</span><span class="s1">'Kurucz'</span><span class="p">)</span>
         <span class="bp">self</span><span class="o">.</span><span class="n">c1</span> <span class="o">=</span> <span class="n">Models</span><span class="p">(</span><span class="n">use_sam</span><span class="o">=</span><span class="s1">'Phoenix'</span><span class="p">)</span>
         <span class="bp">self</span><span class="o">.</span><span class="n">c2</span> <span class="o">=</span> <span class="n">Models</span><span class="p">(</span><span class="n">use_sam</span><span class="o">=</span><span class="s1">'Phoenix'</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">generate_irgsc</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">use_optimal_method</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""</span>
<span class="sd">            `irgsctool.GenerateIRGSC.generate_irgsc(use_optimal_method=True)`</span>

<span class="sd">            &lt;justify&gt; This method finds </span>
<span class="sd">            the best fitting model to the observed colors of the stellar source.</span>
<span class="sd">            The best fitting model is chosen from a combination of Kurucz/Castelli-Kurucz </span>
<span class="sd">            and Phoenix synthetic spectra convolved with the PANSTARRS response function</span>
<span class="sd">            (or BANDPASS) which is integrated w.r.t. the wavelength and normalised to</span>
<span class="sd">            the product of the PANSTARRS response function and wavelength. This is also</span>
<span class="sd">            called as Effective Stimulus (ES). &lt;/justify&gt;</span>

<span class="sd">            $$</span>
<span class="sd">            ES = \\frac{\\int{F_{\\lambda}P_{\\lambda}{\\lambda}</span>
<span class="sd">            d{\\lambda}}}{\\int{P_{\\lambda}{\\lambda}d{\\lambda}}}</span>
<span class="sd">            $$</span>

<span class="sd">            The spectra is obtained from pysynphot </span>
<span class="sd">            ([More information here](https://pysynphot.readthedocs.io)).</span>

<span class="sd">            Returns:</span>
<span class="sd">                    irgsc_data: The generated IRGSC.</span>

<span class="sd">        """</span>
        <span class="k">if</span> <span class="n">use_optimal_method</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">""</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">'#########################################'</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">'Computing the NIR magnitudes for the sources using the optimal method'</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">'#########################################'</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">""</span><span class="p">)</span>

            <span class="n">ps1_objid</span><span class="p">,</span> <span class="n">ps_ra</span><span class="p">,</span> <span class="n">err_ps_ra</span><span class="p">,</span> <span class="n">ps_dec</span><span class="p">,</span> <span class="n">err_ps_dec</span><span class="p">,</span> <span class="n">ec_gmag</span><span class="p">,</span> <span class="n">e_ec_gmag</span><span class="p">,</span> <span class="n">gkron</span><span class="p">,</span> <span class="n">e_gkron</span><span class="p">,</span>\
            <span class="n">ec_rmag</span><span class="p">,</span> <span class="n">e_ec_rmag</span><span class="p">,</span> <span class="n">rkron</span><span class="p">,</span> <span class="n">e_rkron</span><span class="p">,</span> <span class="n">ec_imag</span><span class="p">,</span> <span class="n">e_ec_imag</span><span class="p">,</span> <span class="n">ikron</span><span class="p">,</span> <span class="n">e_ikron</span><span class="p">,</span> <span class="n">ec_zmag</span><span class="p">,</span>\
            <span class="n">e_ec_zmag</span><span class="p">,</span> <span class="n">zkron</span><span class="p">,</span> <span class="n">e_zkron</span><span class="p">,</span> <span class="n">ec_ymag</span><span class="p">,</span> <span class="n">e_ec_ymag</span><span class="p">,</span> <span class="n">ykron</span><span class="p">,</span> <span class="n">e_ykron</span><span class="p">,</span> <span class="n">objinfoflag</span><span class="p">,</span> <span class="n">qualityflag</span><span class="p">,</span>\
            <span class="n">ndetections</span><span class="p">,</span> <span class="n">nstackdetections</span><span class="p">,</span> <span class="n">ginfoflag</span><span class="p">,</span> <span class="n">ginfoflag2</span><span class="p">,</span> <span class="n">ginfoflag3</span><span class="p">,</span> <span class="n">rinfoflag</span><span class="p">,</span> <span class="n">rinfoflag2</span><span class="p">,</span>\
            <span class="n">rinfoflag3</span><span class="p">,</span> <span class="n">iinfoflag</span><span class="p">,</span> <span class="n">iinfoflag2</span><span class="p">,</span> <span class="n">iinfoflag3</span><span class="p">,</span> <span class="n">zinfoflag</span><span class="p">,</span> <span class="n">zinfoflag2</span><span class="p">,</span> <span class="n">zinfoflag3</span><span class="p">,</span>\
            <span class="n">yinfoflag</span><span class="p">,</span> <span class="n">yinfoflag2</span><span class="p">,</span> <span class="n">yinfoflag3</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ec</span><span class="o">.</span><span class="n">extinction_corrected_photometry</span><span class="p">()</span>
            <span class="n">_</span><span class="p">,</span><span class="n">_</span><span class="p">,</span><span class="n">aj</span><span class="p">,</span><span class="n">ah</span><span class="p">,</span><span class="n">ak</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ec</span><span class="o">.</span><span class="n">get_reddening</span><span class="p">()</span>
            <span class="n">gaia_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rd</span><span class="o">.</span><span class="n">read_gaia_data</span><span class="p">()</span>
            <span class="n">gaia_source_id</span><span class="p">,</span> <span class="n">gaia_ra</span><span class="p">,</span> <span class="n">gaia_ra_error</span><span class="p">,</span> <span class="n">gaia_dec</span><span class="p">,</span> <span class="n">gaia_dec_error</span><span class="p">,</span> <span class="n">gaia_parallax</span><span class="p">,</span>\
            <span class="n">gaia_parallax_error</span><span class="p">,</span> <span class="n">gaia_pm</span><span class="p">,</span> <span class="n">gaia_pm_ra</span><span class="p">,</span> <span class="n">gaia_pm_ra_error</span><span class="p">,</span> <span class="n">gaia_pm_dec</span><span class="p">,</span>\
            <span class="n">gaia_pm_dec_error</span><span class="p">,</span> <span class="n">gaia_ruwe</span> <span class="o">=</span> <span class="n">gaia_data</span>

            <span class="n">k0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">k0</span><span class="c1">#Models('Kurucz')</span>
            <span class="n">k0</span><span class="o">.</span><span class="n">read_sam_file</span><span class="p">(</span><span class="n">use_sam</span><span class="o">=</span><span class="s1">'Kurucz'</span><span class="p">)</span>

            <span class="n">c1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">c1</span><span class="c1">#Models('Phoenix')</span>
            <span class="n">c1</span><span class="o">.</span><span class="n">read_sam_file</span><span class="p">(</span><span class="n">use_sam</span><span class="o">=</span><span class="s1">'Phoenix'</span><span class="p">)</span>

            <span class="n">c2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">c2</span><span class="c1">#Models('Phoenix')</span>
            <span class="n">c2</span><span class="o">.</span><span class="n">read_sam_file</span><span class="p">(</span><span class="n">use_sam</span><span class="o">=</span><span class="s1">'Phoenix'</span><span class="p">)</span>

            <span class="n">model_params_k0</span> <span class="o">=</span> <span class="n">k0</span><span class="o">.</span><span class="n">select_sam_range</span><span class="p">(</span><span class="n">teff_range</span><span class="o">=</span><span class="p">[</span><span class="mi">4000</span><span class="p">,</span><span class="mi">10000</span><span class="p">],</span>
                                                <span class="n">logg_range</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">feh_range</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
            <span class="n">model_params_c1</span> <span class="o">=</span> <span class="n">c1</span><span class="o">.</span><span class="n">select_sam_range</span><span class="p">(</span><span class="n">teff_range</span><span class="o">=</span><span class="p">[</span><span class="mi">2800</span><span class="p">,</span><span class="mi">5000</span><span class="p">],</span>
                                                <span class="n">logg_range</span><span class="o">=</span><span class="p">[</span><span class="mf">3.0</span><span class="p">,</span><span class="mf">5.5</span><span class="p">],</span>
                                                <span class="n">feh_range</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mf">5.0</span><span class="p">,</span><span class="o">-</span><span class="mf">1.5</span><span class="p">])</span>
            <span class="n">model_params_c2</span> <span class="o">=</span> <span class="n">c2</span><span class="o">.</span><span class="n">select_sam_range</span><span class="p">(</span><span class="n">teff_range</span><span class="o">=</span><span class="p">[</span><span class="mi">2800</span><span class="p">,</span><span class="mi">4000</span><span class="p">],</span>
                                                <span class="n">logg_range</span><span class="o">=</span><span class="p">[</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">3.0</span><span class="p">],</span>
                                                <span class="n">feh_range</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">1.5</span><span class="p">])</span>

            <span class="n">teff_c1</span><span class="p">,</span> <span class="n">logg_c1</span><span class="p">,</span> <span class="n">feh_c1</span><span class="p">,</span> <span class="n">sam_g_c1</span><span class="p">,</span> <span class="n">sam_r_c1</span><span class="p">,</span> <span class="n">sam_i_c1</span><span class="p">,</span> <span class="n">sam_z_c1</span><span class="p">,</span> <span class="n">sam_y_c1</span><span class="p">,</span> <span class="n">sam_j_c1</span><span class="p">,</span>\
            <span class="n">sam_h_c1</span><span class="p">,</span> <span class="n">sam_k_c1</span> <span class="o">=</span> <span class="n">model_params_c1</span>
            <span class="n">teff_c2</span><span class="p">,</span> <span class="n">logg_c2</span><span class="p">,</span> <span class="n">feh_c2</span><span class="p">,</span> <span class="n">sam_g_c2</span><span class="p">,</span> <span class="n">sam_r_c2</span><span class="p">,</span> <span class="n">sam_i_c2</span><span class="p">,</span> <span class="n">sam_z_c2</span><span class="p">,</span> <span class="n">sam_y_c2</span><span class="p">,</span> <span class="n">sam_j_c2</span><span class="p">,</span>\
            <span class="n">sam_h_c2</span><span class="p">,</span> <span class="n">sam_k_c2</span> <span class="o">=</span> <span class="n">model_params_c2</span>
            <span class="n">teff_k0</span><span class="p">,</span> <span class="n">logg_k0</span><span class="p">,</span> <span class="n">feh_k0</span><span class="p">,</span> <span class="n">sam_g_k0</span><span class="p">,</span> <span class="n">sam_r_k0</span><span class="p">,</span> <span class="n">sam_i_k0</span><span class="p">,</span> <span class="n">sam_z_k0</span><span class="p">,</span> <span class="n">sam_y_k0</span><span class="p">,</span> <span class="n">sam_j_k0</span><span class="p">,</span>\
            <span class="n">sam_h_k0</span><span class="p">,</span> <span class="n">sam_k_k0</span> <span class="o">=</span> <span class="n">model_params_k0</span>

            <span class="n">teff</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">teff_c1</span><span class="p">,</span> <span class="n">teff_c2</span><span class="p">,</span> <span class="n">teff_k0</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
            <span class="n">logg</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">logg_c1</span><span class="p">,</span> <span class="n">logg_c2</span><span class="p">,</span> <span class="n">logg_k0</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
            <span class="n">feh</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">feh_c1</span><span class="p">,</span> <span class="n">feh_c2</span><span class="p">,</span> <span class="n">feh_k0</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
            <span class="n">sam_g</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">sam_g_c1</span><span class="p">,</span> <span class="n">sam_g_c2</span><span class="p">,</span> <span class="n">sam_g_k0</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
            <span class="n">sam_r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">sam_r_c1</span><span class="p">,</span> <span class="n">sam_r_c2</span><span class="p">,</span> <span class="n">sam_r_k0</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
            <span class="n">sam_i</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">sam_i_c1</span><span class="p">,</span> <span class="n">sam_i_c2</span><span class="p">,</span> <span class="n">sam_i_k0</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
            <span class="n">sam_z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">sam_z_c1</span><span class="p">,</span> <span class="n">sam_z_c2</span><span class="p">,</span> <span class="n">sam_z_k0</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
            <span class="n">sam_y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">sam_y_c1</span><span class="p">,</span> <span class="n">sam_y_c2</span><span class="p">,</span> <span class="n">sam_y_k0</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
            <span class="n">sam_j</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">sam_j_c1</span><span class="p">,</span> <span class="n">sam_j_c2</span><span class="p">,</span> <span class="n">sam_j_k0</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
            <span class="n">sam_h</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">sam_h_c1</span><span class="p">,</span> <span class="n">sam_h_c2</span><span class="p">,</span> <span class="n">sam_h_k0</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
            <span class="n">sam_k</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">sam_k_c1</span><span class="p">,</span> <span class="n">sam_k_c2</span><span class="p">,</span> <span class="n">sam_k_k0</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

            <span class="n">sam_gr</span> <span class="o">=</span> <span class="n">sam_g</span> <span class="o">-</span> <span class="n">sam_r</span>
            <span class="n">sam_ri</span> <span class="o">=</span> <span class="n">sam_r</span> <span class="o">-</span> <span class="n">sam_i</span>
            <span class="n">sam_gi</span> <span class="o">=</span> <span class="n">sam_g</span> <span class="o">-</span> <span class="n">sam_i</span>
            <span class="n">sam_gz</span> <span class="o">=</span> <span class="n">sam_g</span> <span class="o">-</span> <span class="n">sam_z</span>
            <span class="n">sam_gy</span> <span class="o">=</span> <span class="n">sam_g</span> <span class="o">-</span> <span class="n">sam_y</span>
            <span class="n">sam_ry</span> <span class="o">=</span> <span class="n">sam_r</span> <span class="o">-</span> <span class="n">sam_y</span>
            <span class="n">sam_rz</span> <span class="o">=</span> <span class="n">sam_r</span> <span class="o">-</span> <span class="n">sam_z</span>
            <span class="n">sam_iz</span> <span class="o">=</span> <span class="n">sam_i</span> <span class="o">-</span> <span class="n">sam_z</span>
            <span class="n">sam_iy</span> <span class="o">=</span> <span class="n">sam_i</span> <span class="o">-</span> <span class="n">sam_y</span>
            <span class="n">sam_zy</span> <span class="o">=</span> <span class="n">sam_z</span> <span class="o">-</span> <span class="n">sam_y</span>

            <span class="n">observed_colours</span> <span class="o">=</span> <span class="p">(</span><span class="n">ec_gmag</span> <span class="o">-</span> <span class="n">ec_rmag</span><span class="p">),</span> <span class="p">(</span><span class="n">ec_gmag</span> <span class="o">-</span> <span class="n">ec_imag</span><span class="p">),</span>\
            <span class="p">(</span><span class="n">ec_gmag</span> <span class="o">-</span> <span class="n">ec_rmag</span><span class="p">),</span> <span class="p">(</span><span class="n">ec_gmag</span> <span class="o">-</span> <span class="n">ec_ymag</span><span class="p">),</span> <span class="p">(</span><span class="n">ec_rmag</span> <span class="o">-</span> <span class="n">ec_imag</span><span class="p">),</span>\
            <span class="p">(</span><span class="n">ec_rmag</span> <span class="o">-</span> <span class="n">ec_ymag</span><span class="p">),</span> <span class="p">(</span><span class="n">ec_rmag</span> <span class="o">-</span> <span class="n">ec_zmag</span><span class="p">),</span> <span class="p">(</span><span class="n">ec_imag</span> <span class="o">-</span> <span class="n">ec_zmag</span><span class="p">),</span>\
            <span class="p">(</span><span class="n">ec_imag</span> <span class="o">-</span> <span class="n">ec_ymag</span><span class="p">),</span> <span class="p">(</span><span class="n">ec_zmag</span> <span class="o">-</span> <span class="n">ec_ymag</span><span class="p">)</span>

            <span class="n">model_colours</span> <span class="o">=</span> <span class="n">sam_gr</span><span class="p">,</span> <span class="n">sam_gi</span><span class="p">,</span> <span class="n">sam_gz</span><span class="p">,</span> <span class="n">sam_gy</span><span class="p">,</span> <span class="n">sam_ri</span><span class="p">,</span> <span class="n">sam_rz</span><span class="p">,</span>\
            <span class="n">sam_ry</span><span class="p">,</span> <span class="n">sam_iz</span><span class="p">,</span> <span class="n">sam_iy</span><span class="p">,</span> <span class="n">sam_zy</span>

            <span class="n">observed_optical_magnitudes</span> <span class="o">=</span> <span class="n">ec_gmag</span><span class="p">,</span> <span class="n">ec_rmag</span><span class="p">,</span> <span class="n">ec_imag</span><span class="p">,</span>\
                <span class="n">ec_zmag</span><span class="p">,</span> <span class="n">ec_ymag</span>
            <span class="n">e_observed_optical_magnitudes</span> <span class="o">=</span> <span class="n">e_ec_gmag</span><span class="p">,</span> <span class="n">e_ec_rmag</span><span class="p">,</span>\
                <span class="n">e_ec_imag</span><span class="p">,</span> <span class="n">e_ec_zmag</span><span class="p">,</span> <span class="n">e_ec_ymag</span>
            <span class="n">sam_magnitudes</span> <span class="o">=</span> <span class="n">sam_g</span><span class="p">,</span> <span class="n">sam_r</span><span class="p">,</span> <span class="n">sam_i</span><span class="p">,</span> <span class="n">sam_z</span><span class="p">,</span> <span class="n">sam_y</span><span class="p">,</span>\
                <span class="n">sam_j</span><span class="p">,</span> <span class="n">sam_h</span><span class="p">,</span> <span class="n">sam_k</span>

            <span class="n">data</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">ra_name</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ra</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">'.'</span><span class="p">,</span><span class="s1">'_'</span><span class="p">);</span><span class="n">dec_name</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dec</span><span class="p">)</span>\
                <span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">'.'</span><span class="p">,</span> <span class="s1">'_'</span><span class="p">)</span>

            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">'IRGSC'</span><span class="o">+</span><span class="s1">'_'</span><span class="o">+</span><span class="s1">'RA'</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ra_name</span><span class="p">)</span><span class="o">+</span><span class="s1">'DEC'</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">dec_name</span><span class="p">)</span><span class="o">+</span>\
                    <span class="nb">str</span><span class="p">(</span><span class="n">current_datetime</span><span class="p">)</span><span class="o">+</span><span class="s1">'.csv'</span><span class="p">,</span><span class="s1">'w'</span><span class="p">,</span><span class="n">encoding</span><span class="o">=</span><span class="s1">'UTF8'</span><span class="p">)</span> <span class="k">as</span> <span class="n">file1</span><span class="p">:</span>
                <span class="n">writer</span><span class="o">=</span><span class="n">csv</span><span class="o">.</span><span class="n">writer</span><span class="p">(</span><span class="n">file1</span><span class="p">)</span>
                <span class="n">writer</span><span class="o">.</span><span class="n">writerow</span><span class="p">(</span><span class="n">header</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ec_gmag</span><span class="p">)):</span>
                    <span class="n">dquad_arr</span><span class="p">,</span> <span class="n">min_dquad</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> \
                        <span class="n">compute_dquad</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">oc</span> <span class="o">=</span> <span class="n">observed_colours</span><span class="p">,</span> <span class="n">mc</span> <span class="o">=</span> <span class="n">model_colours</span><span class="p">)</span>
                    <span class="n">min_dquad_element</span> <span class="o">=</span> <span class="n">find_nearest</span><span class="p">(</span><span class="n">dquad_arr</span><span class="p">,</span><span class="n">min_dquad</span><span class="p">)</span>
                    <span class="n">index_best_fit_sam</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">min_dquad_element</span><span class="o">==</span><span class="p">(</span><span class="n">dquad_arr</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
                    <span class="n">sf_avg</span><span class="p">,</span><span class="n">sigma_sf</span><span class="p">,</span><span class="n">computed_j</span><span class="p">,</span><span class="n">computed_j_error</span><span class="p">,</span><span class="n">computed_h</span><span class="p">,</span><span class="n">computed_h_error</span><span class="p">,</span>\
                        <span class="n">computed_k</span><span class="p">,</span> <span class="n">computed_k_error</span><span class="o">=</span><span class="n">calc_sf</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">observed_optical_magnitudes</span><span class="p">,</span>\
                                                            <span class="n">e_observed_optical_magnitudes</span><span class="p">,</span>\
                                                            <span class="n">sam_magnitudes</span><span class="p">,</span> <span class="n">index_best_fit_sam</span><span class="p">,</span>\
                                                            <span class="n">aj</span><span class="p">,</span> <span class="n">ah</span><span class="p">,</span> <span class="n">ak</span><span class="p">)</span>
                    <span class="n">gaia_angular_seperation</span> <span class="o">=</span> <span class="mi">3600</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(((</span><span class="n">ps_ra</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
                                                            <span class="o">-</span><span class="n">gaia_ra</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="n">ps_dec</span><span class="p">[</span><span class="n">j</span><span class="p">])))</span><span class="o">**</span><span class="mi">2</span>
                                                            <span class="o">+</span><span class="p">(</span><span class="n">ps_dec</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">-</span> <span class="n">gaia_dec</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
                    <span class="n">index_min_ang_seperation</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">gaia_angular_seperation</span><span class="o">&lt;=</span><span class="mf">1.0</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
                    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">index_min_ang_seperation</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">1.0</span><span class="p">:</span>
                            <span class="n">gaia_ang_seperation_selected</span> <span class="o">=</span> <span class="n">gaia_angular_seperation</span><span class="p">[</span><span class="n">index_min_ang_seperation</span><span class="p">]</span>
                            <span class="n">min_gaia_ang_seperation</span> <span class="o">=</span> <span class="n">gaia_angular_seperation</span>\
                                <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">gaia_ang_seperation_selected</span><span class="p">)</span>\
                                          <span class="o">==</span> <span class="n">gaia_angular_seperation</span><span class="p">)[</span><span class="mi">0</span><span class="p">]]</span>

                            <span class="n">index_min_ang_seperation</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">min_gaia_ang_seperation</span> \
                                                                <span class="o">==</span> <span class="n">gaia_angular_seperation</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

                            <span class="n">irgsc_data</span> <span class="o">=</span> <span class="n">ps1_objid</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">ps_ra</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">err_ps_ra</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">ps_dec</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> \
                                <span class="n">err_ps_dec</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">ec_gmag</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">e_ec_gmag</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">ec_rmag</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> \
                                <span class="n">e_ec_rmag</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">ec_imag</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">e_ec_imag</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">ec_zmag</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> \
                                <span class="n">e_ec_zmag</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">ec_ymag</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">e_ec_ymag</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">teff</span><span class="p">[</span><span class="n">index_best_fit_sam</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> \
                                <span class="n">logg</span><span class="p">[</span><span class="n">index_best_fit_sam</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">feh</span><span class="p">[</span><span class="n">index_best_fit_sam</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> \
                                <span class="n">sam_g</span><span class="p">[</span><span class="n">index_best_fit_sam</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">sam_r</span><span class="p">[</span><span class="n">index_best_fit_sam</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">sam_i</span><span class="p">[</span><span class="n">index_best_fit_sam</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> \
                                <span class="n">sam_z</span><span class="p">[</span><span class="n">index_best_fit_sam</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">sam_y</span><span class="p">[</span><span class="n">index_best_fit_sam</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">sam_j</span><span class="p">[</span><span class="n">index_best_fit_sam</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span>\
                                <span class="n">sam_h</span><span class="p">[</span><span class="n">index_best_fit_sam</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">sam_k</span><span class="p">[</span><span class="n">index_best_fit_sam</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">sf_avg</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">sigma_sf</span><span class="p">,</span>\
                                <span class="n">min_dquad_element</span><span class="p">,</span> <span class="n">computed_j</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">computed_j_error</span><span class="p">,</span> <span class="n">computed_h</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>\
                                <span class="n">computed_h_error</span><span class="p">,</span> <span class="n">computed_k</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">computed_k_error</span><span class="p">,</span>\
                                <span class="n">gaia_source_id</span><span class="p">[</span><span class="n">index_min_ang_seperation</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">gaia_ra</span><span class="p">[</span><span class="n">index_min_ang_seperation</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span>\
                                <span class="n">gaia_ra_error</span><span class="p">[</span><span class="n">index_min_ang_seperation</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">gaia_dec</span><span class="p">[</span><span class="n">index_min_ang_seperation</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span>\
                                <span class="n">gaia_dec_error</span><span class="p">[</span><span class="n">index_min_ang_seperation</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">gaia_parallax</span><span class="p">[</span><span class="n">index_min_ang_seperation</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span>\
                                <span class="n">gaia_parallax_error</span><span class="p">[</span><span class="n">index_min_ang_seperation</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">gaia_pm</span><span class="p">[</span><span class="n">index_min_ang_seperation</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span>\
                                <span class="n">gaia_pm_ra</span><span class="p">[</span><span class="n">index_min_ang_seperation</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">gaia_pm_ra_error</span><span class="p">[</span><span class="n">index_min_ang_seperation</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span>\
                                <span class="n">gaia_pm_dec</span><span class="p">[</span><span class="n">index_min_ang_seperation</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">gaia_pm_dec_error</span><span class="p">[</span><span class="n">index_min_ang_seperation</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span>\
                                <span class="n">gaia_ruwe</span><span class="p">[</span><span class="n">index_min_ang_seperation</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">objinfoflag</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">qualityflag</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">ndetections</span><span class="p">[</span><span class="n">j</span><span class="p">],</span>\
                                <span class="n">nstackdetections</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">ginfoflag</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">ginfoflag2</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">ginfoflag3</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">rinfoflag</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">rinfoflag2</span><span class="p">[</span><span class="n">j</span><span class="p">],</span>\
                                <span class="n">rinfoflag3</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">iinfoflag</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">iinfoflag2</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">iinfoflag3</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">zinfoflag</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">zinfoflag2</span><span class="p">[</span><span class="n">j</span><span class="p">],</span>\
                                <span class="n">zinfoflag3</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">yinfoflag</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">yinfoflag2</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">yinfoflag3</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
                            <span class="n">writer</span><span class="o">.</span><span class="n">writerow</span><span class="p">(</span><span class="n">irgsc_data</span><span class="p">)</span>
                    <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">index_min_ang_seperation</span><span class="p">)</span> <span class="o">==</span> <span class="mf">0.0</span><span class="p">:</span>
                            <span class="n">irgsc_data</span> <span class="o">=</span> <span class="n">ps1_objid</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">ps_ra</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">err_ps_ra</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">ps_dec</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">err_ps_dec</span><span class="p">[</span><span class="n">j</span><span class="p">],</span>\
                                <span class="n">ec_gmag</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">e_ec_gmag</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">ec_rmag</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">e_ec_rmag</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">ec_imag</span><span class="p">[</span><span class="n">j</span><span class="p">],</span>\
                                <span class="n">e_ec_imag</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">ec_zmag</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">e_ec_zmag</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">ec_ymag</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">e_ec_ymag</span><span class="p">[</span><span class="n">j</span><span class="p">],</span>\
                                <span class="n">teff</span><span class="p">[</span><span class="n">index_best_fit_sam</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> \
                                <span class="n">logg</span><span class="p">[</span><span class="n">index_best_fit_sam</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">feh</span><span class="p">[</span><span class="n">index_best_fit_sam</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> \
                                <span class="n">sam_g</span><span class="p">[</span><span class="n">index_best_fit_sam</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">sam_r</span><span class="p">[</span><span class="n">index_best_fit_sam</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">sam_i</span><span class="p">[</span><span class="n">index_best_fit_sam</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> \
                                <span class="n">sam_z</span><span class="p">[</span><span class="n">index_best_fit_sam</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">sam_y</span><span class="p">[</span><span class="n">index_best_fit_sam</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">sam_j</span><span class="p">[</span><span class="n">index_best_fit_sam</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span>\
                                <span class="n">sam_h</span><span class="p">[</span><span class="n">index_best_fit_sam</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">sam_k</span><span class="p">[</span><span class="n">index_best_fit_sam</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">sf_avg</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">sigma_sf</span><span class="p">,</span>\
                                <span class="n">min_dquad_element</span><span class="p">,</span> <span class="n">computed_j</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">computed_j_error</span><span class="p">,</span> <span class="n">computed_h</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>\
                                <span class="n">computed_h_error</span><span class="p">,</span> <span class="n">computed_k</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">computed_k_error</span><span class="p">,</span> <span class="o">-</span><span class="mi">999</span><span class="p">,</span> <span class="o">-</span><span class="mi">999</span><span class="p">,</span> <span class="o">-</span><span class="mi">999</span><span class="p">,</span>\
                                <span class="o">-</span><span class="mi">999</span><span class="p">,</span> <span class="o">-</span><span class="mi">999</span><span class="p">,</span> <span class="o">-</span><span class="mi">999</span><span class="p">,</span> <span class="o">-</span><span class="mi">999</span><span class="p">,</span> <span class="o">-</span><span class="mi">999</span><span class="p">,</span> <span class="o">-</span><span class="mi">999</span><span class="p">,</span> <span class="o">-</span><span class="mi">999</span><span class="p">,</span> <span class="o">-</span><span class="mi">999</span><span class="p">,</span> <span class="o">-</span><span class="mi">999</span><span class="p">,</span> <span class="o">-</span><span class="mi">999</span><span class="p">,</span> <span class="n">objinfoflag</span><span class="p">[</span><span class="n">j</span><span class="p">],</span>\
                                <span class="n">qualityflag</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">ndetections</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">nstackdetections</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">ginfoflag</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">ginfoflag2</span><span class="p">[</span><span class="n">j</span><span class="p">],</span>\
                                <span class="n">ginfoflag3</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">rinfoflag</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">rinfoflag2</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">rinfoflag3</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">iinfoflag</span><span class="p">[</span><span class="n">j</span><span class="p">],</span>\
                                <span class="n">iinfoflag2</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">iinfoflag3</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">zinfoflag</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">zinfoflag2</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">zinfoflag3</span><span class="p">[</span><span class="n">j</span><span class="p">],</span>\
                                <span class="n">yinfoflag</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">yinfoflag2</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">yinfoflag3</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
                            <span class="n">writer</span><span class="o">.</span><span class="n">writerow</span><span class="p">(</span><span class="n">irgsc_data</span><span class="p">)</span>
                    <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">index_min_ang_seperation</span><span class="p">)</span> <span class="o">==</span> <span class="mf">1.0</span><span class="p">:</span>
                            <span class="n">irgsc_data</span> <span class="o">=</span> <span class="n">ps1_objid</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">ps_ra</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">err_ps_ra</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">ps_dec</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">err_ps_dec</span><span class="p">[</span><span class="n">j</span><span class="p">],</span>\
                                <span class="n">ec_gmag</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">e_ec_gmag</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">ec_rmag</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">e_ec_rmag</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">ec_imag</span><span class="p">[</span><span class="n">j</span><span class="p">],</span>\
                                <span class="n">e_ec_imag</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">ec_zmag</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">e_ec_zmag</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">ec_ymag</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">e_ec_ymag</span><span class="p">[</span><span class="n">j</span><span class="p">],</span>\
                                <span class="n">teff</span><span class="p">[</span><span class="n">index_best_fit_sam</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> \
                                <span class="n">logg</span><span class="p">[</span><span class="n">index_best_fit_sam</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">feh</span><span class="p">[</span><span class="n">index_best_fit_sam</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> \
                                <span class="n">sam_g</span><span class="p">[</span><span class="n">index_best_fit_sam</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">sam_r</span><span class="p">[</span><span class="n">index_best_fit_sam</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">sam_i</span><span class="p">[</span><span class="n">index_best_fit_sam</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> \
                                <span class="n">sam_z</span><span class="p">[</span><span class="n">index_best_fit_sam</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">sam_y</span><span class="p">[</span><span class="n">index_best_fit_sam</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">sam_j</span><span class="p">[</span><span class="n">index_best_fit_sam</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span>\
                                <span class="n">sam_h</span><span class="p">[</span><span class="n">index_best_fit_sam</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">sam_k</span><span class="p">[</span><span class="n">index_best_fit_sam</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">sf_avg</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">sigma_sf</span><span class="p">,</span>\
                                <span class="n">min_dquad_element</span><span class="p">,</span> <span class="n">computed_j</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">computed_j_error</span><span class="p">,</span> <span class="n">computed_h</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>\
                                <span class="n">computed_h_error</span><span class="p">,</span> <span class="n">computed_k</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">computed_k_error</span><span class="p">,</span> <span class="n">gaia_source_id</span><span class="p">[</span><span class="n">index_min_ang_seperation</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span>\
                                <span class="n">gaia_ra</span><span class="p">[</span><span class="n">index_min_ang_seperation</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">gaia_ra_error</span><span class="p">[</span><span class="n">index_min_ang_seperation</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span>\
                                <span class="n">gaia_dec</span><span class="p">[</span><span class="n">index_min_ang_seperation</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">gaia_dec_error</span><span class="p">[</span><span class="n">index_min_ang_seperation</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span>\
                                <span class="n">gaia_parallax</span><span class="p">[</span><span class="n">index_min_ang_seperation</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">gaia_parallax_error</span><span class="p">[</span><span class="n">index_min_ang_seperation</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span>\
                                <span class="n">gaia_pm</span><span class="p">[</span><span class="n">index_min_ang_seperation</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">gaia_pm_ra</span><span class="p">[</span><span class="n">index_min_ang_seperation</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span>\
                                <span class="n">gaia_pm_ra_error</span><span class="p">[</span><span class="n">index_min_ang_seperation</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">gaia_pm_dec</span><span class="p">[</span><span class="n">index_min_ang_seperation</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span>\
                                <span class="n">gaia_pm_dec_error</span><span class="p">[</span><span class="n">index_min_ang_seperation</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">gaia_ruwe</span><span class="p">[</span><span class="n">index_min_ang_seperation</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span>\
                                <span class="n">objinfoflag</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">qualityflag</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">ndetections</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">nstackdetections</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">ginfoflag</span><span class="p">[</span><span class="n">j</span><span class="p">],</span>\
                                <span class="n">ginfoflag2</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">ginfoflag3</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">rinfoflag</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">rinfoflag2</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">rinfoflag3</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">iinfoflag</span><span class="p">[</span><span class="n">j</span><span class="p">],</span>\
                                <span class="n">iinfoflag2</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">iinfoflag3</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">zinfoflag</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">zinfoflag2</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">zinfoflag3</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">yinfoflag</span><span class="p">[</span><span class="n">j</span><span class="p">],</span>\
                                <span class="n">iinfoflag2</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">yinfoflag3</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
                            <span class="n">writer</span><span class="o">.</span><span class="n">writerow</span><span class="p">(</span><span class="n">irgsc_data</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">irgsc_data</span>
</code></pre></div></td></tr></table></div>
</details>
<div class="doc doc-children">
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="irgsctool._fitting.GenerateIRGSC.generate_irgsc">
<code class="highlight language-python"><span class="n">generate_irgsc</span><span class="p">(</span><span class="n">use_optimal_method</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>
</h3>
<div class="doc doc-contents">
<p><code>irgsctool.GenerateIRGSC.generate_irgsc(use_optimal_method=True)</code></p>
<p><justify> This method finds 
the best fitting model to the observed colors of the stellar source.
The best fitting model is chosen from a combination of Kurucz/Castelli-Kurucz 
and Phoenix synthetic spectra convolved with the PANSTARRS response function
(or BANDPASS) which is integrated w.r.t. the wavelength and normalised to
the product of the PANSTARRS response function and wavelength. This is also
called as Effective Stimulus (ES). </justify></p>
<div class="arithmatex">\[
ES = \frac{\int{F_{\lambda}P_{\lambda}{\lambda}
d{\lambda}}}{\int{P_{\lambda}{\lambda}d{\lambda}}}
\]</div>
<p>The spectra is obtained from pysynphot 
(<a href="https://pysynphot.readthedocs.io">More information here</a>).</p>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Name</th> <th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>irgsc_data</code></td> <td>
</td>
<td><p>The generated IRGSC.</p></td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>irgsctool/_fitting.py</code></summary>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">generate_irgsc</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">use_optimal_method</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">        `irgsctool.GenerateIRGSC.generate_irgsc(use_optimal_method=True)`</span>

<span class="sd">        &lt;justify&gt; This method finds </span>
<span class="sd">        the best fitting model to the observed colors of the stellar source.</span>
<span class="sd">        The best fitting model is chosen from a combination of Kurucz/Castelli-Kurucz </span>
<span class="sd">        and Phoenix synthetic spectra convolved with the PANSTARRS response function</span>
<span class="sd">        (or BANDPASS) which is integrated w.r.t. the wavelength and normalised to</span>
<span class="sd">        the product of the PANSTARRS response function and wavelength. This is also</span>
<span class="sd">        called as Effective Stimulus (ES). &lt;/justify&gt;</span>

<span class="sd">        $$</span>
<span class="sd">        ES = \\frac{\\int{F_{\\lambda}P_{\\lambda}{\\lambda}</span>
<span class="sd">        d{\\lambda}}}{\\int{P_{\\lambda}{\\lambda}d{\\lambda}}}</span>
<span class="sd">        $$</span>

<span class="sd">        The spectra is obtained from pysynphot </span>
<span class="sd">        ([More information here](https://pysynphot.readthedocs.io)).</span>

<span class="sd">        Returns:</span>
<span class="sd">                irgsc_data: The generated IRGSC.</span>

<span class="sd">    """</span>
    <span class="k">if</span> <span class="n">use_optimal_method</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">""</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">'#########################################'</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">'Computing the NIR magnitudes for the sources using the optimal method'</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">'#########################################'</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">""</span><span class="p">)</span>

        <span class="n">ps1_objid</span><span class="p">,</span> <span class="n">ps_ra</span><span class="p">,</span> <span class="n">err_ps_ra</span><span class="p">,</span> <span class="n">ps_dec</span><span class="p">,</span> <span class="n">err_ps_dec</span><span class="p">,</span> <span class="n">ec_gmag</span><span class="p">,</span> <span class="n">e_ec_gmag</span><span class="p">,</span> <span class="n">gkron</span><span class="p">,</span> <span class="n">e_gkron</span><span class="p">,</span>\
        <span class="n">ec_rmag</span><span class="p">,</span> <span class="n">e_ec_rmag</span><span class="p">,</span> <span class="n">rkron</span><span class="p">,</span> <span class="n">e_rkron</span><span class="p">,</span> <span class="n">ec_imag</span><span class="p">,</span> <span class="n">e_ec_imag</span><span class="p">,</span> <span class="n">ikron</span><span class="p">,</span> <span class="n">e_ikron</span><span class="p">,</span> <span class="n">ec_zmag</span><span class="p">,</span>\
        <span class="n">e_ec_zmag</span><span class="p">,</span> <span class="n">zkron</span><span class="p">,</span> <span class="n">e_zkron</span><span class="p">,</span> <span class="n">ec_ymag</span><span class="p">,</span> <span class="n">e_ec_ymag</span><span class="p">,</span> <span class="n">ykron</span><span class="p">,</span> <span class="n">e_ykron</span><span class="p">,</span> <span class="n">objinfoflag</span><span class="p">,</span> <span class="n">qualityflag</span><span class="p">,</span>\
        <span class="n">ndetections</span><span class="p">,</span> <span class="n">nstackdetections</span><span class="p">,</span> <span class="n">ginfoflag</span><span class="p">,</span> <span class="n">ginfoflag2</span><span class="p">,</span> <span class="n">ginfoflag3</span><span class="p">,</span> <span class="n">rinfoflag</span><span class="p">,</span> <span class="n">rinfoflag2</span><span class="p">,</span>\
        <span class="n">rinfoflag3</span><span class="p">,</span> <span class="n">iinfoflag</span><span class="p">,</span> <span class="n">iinfoflag2</span><span class="p">,</span> <span class="n">iinfoflag3</span><span class="p">,</span> <span class="n">zinfoflag</span><span class="p">,</span> <span class="n">zinfoflag2</span><span class="p">,</span> <span class="n">zinfoflag3</span><span class="p">,</span>\
        <span class="n">yinfoflag</span><span class="p">,</span> <span class="n">yinfoflag2</span><span class="p">,</span> <span class="n">yinfoflag3</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ec</span><span class="o">.</span><span class="n">extinction_corrected_photometry</span><span class="p">()</span>
        <span class="n">_</span><span class="p">,</span><span class="n">_</span><span class="p">,</span><span class="n">aj</span><span class="p">,</span><span class="n">ah</span><span class="p">,</span><span class="n">ak</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ec</span><span class="o">.</span><span class="n">get_reddening</span><span class="p">()</span>
        <span class="n">gaia_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rd</span><span class="o">.</span><span class="n">read_gaia_data</span><span class="p">()</span>
        <span class="n">gaia_source_id</span><span class="p">,</span> <span class="n">gaia_ra</span><span class="p">,</span> <span class="n">gaia_ra_error</span><span class="p">,</span> <span class="n">gaia_dec</span><span class="p">,</span> <span class="n">gaia_dec_error</span><span class="p">,</span> <span class="n">gaia_parallax</span><span class="p">,</span>\
        <span class="n">gaia_parallax_error</span><span class="p">,</span> <span class="n">gaia_pm</span><span class="p">,</span> <span class="n">gaia_pm_ra</span><span class="p">,</span> <span class="n">gaia_pm_ra_error</span><span class="p">,</span> <span class="n">gaia_pm_dec</span><span class="p">,</span>\
        <span class="n">gaia_pm_dec_error</span><span class="p">,</span> <span class="n">gaia_ruwe</span> <span class="o">=</span> <span class="n">gaia_data</span>

        <span class="n">k0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">k0</span><span class="c1">#Models('Kurucz')</span>
        <span class="n">k0</span><span class="o">.</span><span class="n">read_sam_file</span><span class="p">(</span><span class="n">use_sam</span><span class="o">=</span><span class="s1">'Kurucz'</span><span class="p">)</span>

        <span class="n">c1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">c1</span><span class="c1">#Models('Phoenix')</span>
        <span class="n">c1</span><span class="o">.</span><span class="n">read_sam_file</span><span class="p">(</span><span class="n">use_sam</span><span class="o">=</span><span class="s1">'Phoenix'</span><span class="p">)</span>

        <span class="n">c2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">c2</span><span class="c1">#Models('Phoenix')</span>
        <span class="n">c2</span><span class="o">.</span><span class="n">read_sam_file</span><span class="p">(</span><span class="n">use_sam</span><span class="o">=</span><span class="s1">'Phoenix'</span><span class="p">)</span>

        <span class="n">model_params_k0</span> <span class="o">=</span> <span class="n">k0</span><span class="o">.</span><span class="n">select_sam_range</span><span class="p">(</span><span class="n">teff_range</span><span class="o">=</span><span class="p">[</span><span class="mi">4000</span><span class="p">,</span><span class="mi">10000</span><span class="p">],</span>
                                            <span class="n">logg_range</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">feh_range</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
        <span class="n">model_params_c1</span> <span class="o">=</span> <span class="n">c1</span><span class="o">.</span><span class="n">select_sam_range</span><span class="p">(</span><span class="n">teff_range</span><span class="o">=</span><span class="p">[</span><span class="mi">2800</span><span class="p">,</span><span class="mi">5000</span><span class="p">],</span>
                                            <span class="n">logg_range</span><span class="o">=</span><span class="p">[</span><span class="mf">3.0</span><span class="p">,</span><span class="mf">5.5</span><span class="p">],</span>
                                            <span class="n">feh_range</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mf">5.0</span><span class="p">,</span><span class="o">-</span><span class="mf">1.5</span><span class="p">])</span>
        <span class="n">model_params_c2</span> <span class="o">=</span> <span class="n">c2</span><span class="o">.</span><span class="n">select_sam_range</span><span class="p">(</span><span class="n">teff_range</span><span class="o">=</span><span class="p">[</span><span class="mi">2800</span><span class="p">,</span><span class="mi">4000</span><span class="p">],</span>
                                            <span class="n">logg_range</span><span class="o">=</span><span class="p">[</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">3.0</span><span class="p">],</span>
                                            <span class="n">feh_range</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">1.5</span><span class="p">])</span>

        <span class="n">teff_c1</span><span class="p">,</span> <span class="n">logg_c1</span><span class="p">,</span> <span class="n">feh_c1</span><span class="p">,</span> <span class="n">sam_g_c1</span><span class="p">,</span> <span class="n">sam_r_c1</span><span class="p">,</span> <span class="n">sam_i_c1</span><span class="p">,</span> <span class="n">sam_z_c1</span><span class="p">,</span> <span class="n">sam_y_c1</span><span class="p">,</span> <span class="n">sam_j_c1</span><span class="p">,</span>\
        <span class="n">sam_h_c1</span><span class="p">,</span> <span class="n">sam_k_c1</span> <span class="o">=</span> <span class="n">model_params_c1</span>
        <span class="n">teff_c2</span><span class="p">,</span> <span class="n">logg_c2</span><span class="p">,</span> <span class="n">feh_c2</span><span class="p">,</span> <span class="n">sam_g_c2</span><span class="p">,</span> <span class="n">sam_r_c2</span><span class="p">,</span> <span class="n">sam_i_c2</span><span class="p">,</span> <span class="n">sam_z_c2</span><span class="p">,</span> <span class="n">sam_y_c2</span><span class="p">,</span> <span class="n">sam_j_c2</span><span class="p">,</span>\
        <span class="n">sam_h_c2</span><span class="p">,</span> <span class="n">sam_k_c2</span> <span class="o">=</span> <span class="n">model_params_c2</span>
        <span class="n">teff_k0</span><span class="p">,</span> <span class="n">logg_k0</span><span class="p">,</span> <span class="n">feh_k0</span><span class="p">,</span> <span class="n">sam_g_k0</span><span class="p">,</span> <span class="n">sam_r_k0</span><span class="p">,</span> <span class="n">sam_i_k0</span><span class="p">,</span> <span class="n">sam_z_k0</span><span class="p">,</span> <span class="n">sam_y_k0</span><span class="p">,</span> <span class="n">sam_j_k0</span><span class="p">,</span>\
        <span class="n">sam_h_k0</span><span class="p">,</span> <span class="n">sam_k_k0</span> <span class="o">=</span> <span class="n">model_params_k0</span>

        <span class="n">teff</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">teff_c1</span><span class="p">,</span> <span class="n">teff_c2</span><span class="p">,</span> <span class="n">teff_k0</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">logg</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">logg_c1</span><span class="p">,</span> <span class="n">logg_c2</span><span class="p">,</span> <span class="n">logg_k0</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">feh</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">feh_c1</span><span class="p">,</span> <span class="n">feh_c2</span><span class="p">,</span> <span class="n">feh_k0</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">sam_g</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">sam_g_c1</span><span class="p">,</span> <span class="n">sam_g_c2</span><span class="p">,</span> <span class="n">sam_g_k0</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">sam_r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">sam_r_c1</span><span class="p">,</span> <span class="n">sam_r_c2</span><span class="p">,</span> <span class="n">sam_r_k0</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">sam_i</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">sam_i_c1</span><span class="p">,</span> <span class="n">sam_i_c2</span><span class="p">,</span> <span class="n">sam_i_k0</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">sam_z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">sam_z_c1</span><span class="p">,</span> <span class="n">sam_z_c2</span><span class="p">,</span> <span class="n">sam_z_k0</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">sam_y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">sam_y_c1</span><span class="p">,</span> <span class="n">sam_y_c2</span><span class="p">,</span> <span class="n">sam_y_k0</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">sam_j</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">sam_j_c1</span><span class="p">,</span> <span class="n">sam_j_c2</span><span class="p">,</span> <span class="n">sam_j_k0</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">sam_h</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">sam_h_c1</span><span class="p">,</span> <span class="n">sam_h_c2</span><span class="p">,</span> <span class="n">sam_h_k0</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">sam_k</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">sam_k_c1</span><span class="p">,</span> <span class="n">sam_k_c2</span><span class="p">,</span> <span class="n">sam_k_k0</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

        <span class="n">sam_gr</span> <span class="o">=</span> <span class="n">sam_g</span> <span class="o">-</span> <span class="n">sam_r</span>
        <span class="n">sam_ri</span> <span class="o">=</span> <span class="n">sam_r</span> <span class="o">-</span> <span class="n">sam_i</span>
        <span class="n">sam_gi</span> <span class="o">=</span> <span class="n">sam_g</span> <span class="o">-</span> <span class="n">sam_i</span>
        <span class="n">sam_gz</span> <span class="o">=</span> <span class="n">sam_g</span> <span class="o">-</span> <span class="n">sam_z</span>
        <span class="n">sam_gy</span> <span class="o">=</span> <span class="n">sam_g</span> <span class="o">-</span> <span class="n">sam_y</span>
        <span class="n">sam_ry</span> <span class="o">=</span> <span class="n">sam_r</span> <span class="o">-</span> <span class="n">sam_y</span>
        <span class="n">sam_rz</span> <span class="o">=</span> <span class="n">sam_r</span> <span class="o">-</span> <span class="n">sam_z</span>
        <span class="n">sam_iz</span> <span class="o">=</span> <span class="n">sam_i</span> <span class="o">-</span> <span class="n">sam_z</span>
        <span class="n">sam_iy</span> <span class="o">=</span> <span class="n">sam_i</span> <span class="o">-</span> <span class="n">sam_y</span>
        <span class="n">sam_zy</span> <span class="o">=</span> <span class="n">sam_z</span> <span class="o">-</span> <span class="n">sam_y</span>

        <span class="n">observed_colours</span> <span class="o">=</span> <span class="p">(</span><span class="n">ec_gmag</span> <span class="o">-</span> <span class="n">ec_rmag</span><span class="p">),</span> <span class="p">(</span><span class="n">ec_gmag</span> <span class="o">-</span> <span class="n">ec_imag</span><span class="p">),</span>\
        <span class="p">(</span><span class="n">ec_gmag</span> <span class="o">-</span> <span class="n">ec_rmag</span><span class="p">),</span> <span class="p">(</span><span class="n">ec_gmag</span> <span class="o">-</span> <span class="n">ec_ymag</span><span class="p">),</span> <span class="p">(</span><span class="n">ec_rmag</span> <span class="o">-</span> <span class="n">ec_imag</span><span class="p">),</span>\
        <span class="p">(</span><span class="n">ec_rmag</span> <span class="o">-</span> <span class="n">ec_ymag</span><span class="p">),</span> <span class="p">(</span><span class="n">ec_rmag</span> <span class="o">-</span> <span class="n">ec_zmag</span><span class="p">),</span> <span class="p">(</span><span class="n">ec_imag</span> <span class="o">-</span> <span class="n">ec_zmag</span><span class="p">),</span>\
        <span class="p">(</span><span class="n">ec_imag</span> <span class="o">-</span> <span class="n">ec_ymag</span><span class="p">),</span> <span class="p">(</span><span class="n">ec_zmag</span> <span class="o">-</span> <span class="n">ec_ymag</span><span class="p">)</span>

        <span class="n">model_colours</span> <span class="o">=</span> <span class="n">sam_gr</span><span class="p">,</span> <span class="n">sam_gi</span><span class="p">,</span> <span class="n">sam_gz</span><span class="p">,</span> <span class="n">sam_gy</span><span class="p">,</span> <span class="n">sam_ri</span><span class="p">,</span> <span class="n">sam_rz</span><span class="p">,</span>\
        <span class="n">sam_ry</span><span class="p">,</span> <span class="n">sam_iz</span><span class="p">,</span> <span class="n">sam_iy</span><span class="p">,</span> <span class="n">sam_zy</span>

        <span class="n">observed_optical_magnitudes</span> <span class="o">=</span> <span class="n">ec_gmag</span><span class="p">,</span> <span class="n">ec_rmag</span><span class="p">,</span> <span class="n">ec_imag</span><span class="p">,</span>\
            <span class="n">ec_zmag</span><span class="p">,</span> <span class="n">ec_ymag</span>
        <span class="n">e_observed_optical_magnitudes</span> <span class="o">=</span> <span class="n">e_ec_gmag</span><span class="p">,</span> <span class="n">e_ec_rmag</span><span class="p">,</span>\
            <span class="n">e_ec_imag</span><span class="p">,</span> <span class="n">e_ec_zmag</span><span class="p">,</span> <span class="n">e_ec_ymag</span>
        <span class="n">sam_magnitudes</span> <span class="o">=</span> <span class="n">sam_g</span><span class="p">,</span> <span class="n">sam_r</span><span class="p">,</span> <span class="n">sam_i</span><span class="p">,</span> <span class="n">sam_z</span><span class="p">,</span> <span class="n">sam_y</span><span class="p">,</span>\
            <span class="n">sam_j</span><span class="p">,</span> <span class="n">sam_h</span><span class="p">,</span> <span class="n">sam_k</span>

        <span class="n">data</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">ra_name</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ra</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">'.'</span><span class="p">,</span><span class="s1">'_'</span><span class="p">);</span><span class="n">dec_name</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dec</span><span class="p">)</span>\
            <span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">'.'</span><span class="p">,</span> <span class="s1">'_'</span><span class="p">)</span>

        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">'IRGSC'</span><span class="o">+</span><span class="s1">'_'</span><span class="o">+</span><span class="s1">'RA'</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ra_name</span><span class="p">)</span><span class="o">+</span><span class="s1">'DEC'</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">dec_name</span><span class="p">)</span><span class="o">+</span>\
                <span class="nb">str</span><span class="p">(</span><span class="n">current_datetime</span><span class="p">)</span><span class="o">+</span><span class="s1">'.csv'</span><span class="p">,</span><span class="s1">'w'</span><span class="p">,</span><span class="n">encoding</span><span class="o">=</span><span class="s1">'UTF8'</span><span class="p">)</span> <span class="k">as</span> <span class="n">file1</span><span class="p">:</span>
            <span class="n">writer</span><span class="o">=</span><span class="n">csv</span><span class="o">.</span><span class="n">writer</span><span class="p">(</span><span class="n">file1</span><span class="p">)</span>
            <span class="n">writer</span><span class="o">.</span><span class="n">writerow</span><span class="p">(</span><span class="n">header</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ec_gmag</span><span class="p">)):</span>
                <span class="n">dquad_arr</span><span class="p">,</span> <span class="n">min_dquad</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> \
                    <span class="n">compute_dquad</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">oc</span> <span class="o">=</span> <span class="n">observed_colours</span><span class="p">,</span> <span class="n">mc</span> <span class="o">=</span> <span class="n">model_colours</span><span class="p">)</span>
                <span class="n">min_dquad_element</span> <span class="o">=</span> <span class="n">find_nearest</span><span class="p">(</span><span class="n">dquad_arr</span><span class="p">,</span><span class="n">min_dquad</span><span class="p">)</span>
                <span class="n">index_best_fit_sam</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">min_dquad_element</span><span class="o">==</span><span class="p">(</span><span class="n">dquad_arr</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">sf_avg</span><span class="p">,</span><span class="n">sigma_sf</span><span class="p">,</span><span class="n">computed_j</span><span class="p">,</span><span class="n">computed_j_error</span><span class="p">,</span><span class="n">computed_h</span><span class="p">,</span><span class="n">computed_h_error</span><span class="p">,</span>\
                    <span class="n">computed_k</span><span class="p">,</span> <span class="n">computed_k_error</span><span class="o">=</span><span class="n">calc_sf</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">observed_optical_magnitudes</span><span class="p">,</span>\
                                                        <span class="n">e_observed_optical_magnitudes</span><span class="p">,</span>\
                                                        <span class="n">sam_magnitudes</span><span class="p">,</span> <span class="n">index_best_fit_sam</span><span class="p">,</span>\
                                                        <span class="n">aj</span><span class="p">,</span> <span class="n">ah</span><span class="p">,</span> <span class="n">ak</span><span class="p">)</span>
                <span class="n">gaia_angular_seperation</span> <span class="o">=</span> <span class="mi">3600</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(((</span><span class="n">ps_ra</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
                                                        <span class="o">-</span><span class="n">gaia_ra</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="n">ps_dec</span><span class="p">[</span><span class="n">j</span><span class="p">])))</span><span class="o">**</span><span class="mi">2</span>
                                                        <span class="o">+</span><span class="p">(</span><span class="n">ps_dec</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">-</span> <span class="n">gaia_dec</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
                <span class="n">index_min_ang_seperation</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">gaia_angular_seperation</span><span class="o">&lt;=</span><span class="mf">1.0</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">index_min_ang_seperation</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">1.0</span><span class="p">:</span>
                        <span class="n">gaia_ang_seperation_selected</span> <span class="o">=</span> <span class="n">gaia_angular_seperation</span><span class="p">[</span><span class="n">index_min_ang_seperation</span><span class="p">]</span>
                        <span class="n">min_gaia_ang_seperation</span> <span class="o">=</span> <span class="n">gaia_angular_seperation</span>\
                            <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">gaia_ang_seperation_selected</span><span class="p">)</span>\
                                      <span class="o">==</span> <span class="n">gaia_angular_seperation</span><span class="p">)[</span><span class="mi">0</span><span class="p">]]</span>

                        <span class="n">index_min_ang_seperation</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">min_gaia_ang_seperation</span> \
                                                            <span class="o">==</span> <span class="n">gaia_angular_seperation</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

                        <span class="n">irgsc_data</span> <span class="o">=</span> <span class="n">ps1_objid</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">ps_ra</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">err_ps_ra</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">ps_dec</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> \
                            <span class="n">err_ps_dec</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">ec_gmag</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">e_ec_gmag</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">ec_rmag</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> \
                            <span class="n">e_ec_rmag</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">ec_imag</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">e_ec_imag</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">ec_zmag</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> \
                            <span class="n">e_ec_zmag</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">ec_ymag</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">e_ec_ymag</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">teff</span><span class="p">[</span><span class="n">index_best_fit_sam</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> \
                            <span class="n">logg</span><span class="p">[</span><span class="n">index_best_fit_sam</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">feh</span><span class="p">[</span><span class="n">index_best_fit_sam</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> \
                            <span class="n">sam_g</span><span class="p">[</span><span class="n">index_best_fit_sam</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">sam_r</span><span class="p">[</span><span class="n">index_best_fit_sam</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">sam_i</span><span class="p">[</span><span class="n">index_best_fit_sam</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> \
                            <span class="n">sam_z</span><span class="p">[</span><span class="n">index_best_fit_sam</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">sam_y</span><span class="p">[</span><span class="n">index_best_fit_sam</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">sam_j</span><span class="p">[</span><span class="n">index_best_fit_sam</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span>\
                            <span class="n">sam_h</span><span class="p">[</span><span class="n">index_best_fit_sam</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">sam_k</span><span class="p">[</span><span class="n">index_best_fit_sam</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">sf_avg</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">sigma_sf</span><span class="p">,</span>\
                            <span class="n">min_dquad_element</span><span class="p">,</span> <span class="n">computed_j</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">computed_j_error</span><span class="p">,</span> <span class="n">computed_h</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>\
                            <span class="n">computed_h_error</span><span class="p">,</span> <span class="n">computed_k</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">computed_k_error</span><span class="p">,</span>\
                            <span class="n">gaia_source_id</span><span class="p">[</span><span class="n">index_min_ang_seperation</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">gaia_ra</span><span class="p">[</span><span class="n">index_min_ang_seperation</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span>\
                            <span class="n">gaia_ra_error</span><span class="p">[</span><span class="n">index_min_ang_seperation</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">gaia_dec</span><span class="p">[</span><span class="n">index_min_ang_seperation</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span>\
                            <span class="n">gaia_dec_error</span><span class="p">[</span><span class="n">index_min_ang_seperation</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">gaia_parallax</span><span class="p">[</span><span class="n">index_min_ang_seperation</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span>\
                            <span class="n">gaia_parallax_error</span><span class="p">[</span><span class="n">index_min_ang_seperation</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">gaia_pm</span><span class="p">[</span><span class="n">index_min_ang_seperation</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span>\
                            <span class="n">gaia_pm_ra</span><span class="p">[</span><span class="n">index_min_ang_seperation</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">gaia_pm_ra_error</span><span class="p">[</span><span class="n">index_min_ang_seperation</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span>\
                            <span class="n">gaia_pm_dec</span><span class="p">[</span><span class="n">index_min_ang_seperation</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">gaia_pm_dec_error</span><span class="p">[</span><span class="n">index_min_ang_seperation</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span>\
                            <span class="n">gaia_ruwe</span><span class="p">[</span><span class="n">index_min_ang_seperation</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">objinfoflag</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">qualityflag</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">ndetections</span><span class="p">[</span><span class="n">j</span><span class="p">],</span>\
                            <span class="n">nstackdetections</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">ginfoflag</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">ginfoflag2</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">ginfoflag3</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">rinfoflag</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">rinfoflag2</span><span class="p">[</span><span class="n">j</span><span class="p">],</span>\
                            <span class="n">rinfoflag3</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">iinfoflag</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">iinfoflag2</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">iinfoflag3</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">zinfoflag</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">zinfoflag2</span><span class="p">[</span><span class="n">j</span><span class="p">],</span>\
                            <span class="n">zinfoflag3</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">yinfoflag</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">yinfoflag2</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">yinfoflag3</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
                        <span class="n">writer</span><span class="o">.</span><span class="n">writerow</span><span class="p">(</span><span class="n">irgsc_data</span><span class="p">)</span>
                <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">index_min_ang_seperation</span><span class="p">)</span> <span class="o">==</span> <span class="mf">0.0</span><span class="p">:</span>
                        <span class="n">irgsc_data</span> <span class="o">=</span> <span class="n">ps1_objid</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">ps_ra</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">err_ps_ra</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">ps_dec</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">err_ps_dec</span><span class="p">[</span><span class="n">j</span><span class="p">],</span>\
                            <span class="n">ec_gmag</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">e_ec_gmag</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">ec_rmag</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">e_ec_rmag</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">ec_imag</span><span class="p">[</span><span class="n">j</span><span class="p">],</span>\
                            <span class="n">e_ec_imag</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">ec_zmag</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">e_ec_zmag</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">ec_ymag</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">e_ec_ymag</span><span class="p">[</span><span class="n">j</span><span class="p">],</span>\
                            <span class="n">teff</span><span class="p">[</span><span class="n">index_best_fit_sam</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> \
                            <span class="n">logg</span><span class="p">[</span><span class="n">index_best_fit_sam</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">feh</span><span class="p">[</span><span class="n">index_best_fit_sam</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> \
                            <span class="n">sam_g</span><span class="p">[</span><span class="n">index_best_fit_sam</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">sam_r</span><span class="p">[</span><span class="n">index_best_fit_sam</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">sam_i</span><span class="p">[</span><span class="n">index_best_fit_sam</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> \
                            <span class="n">sam_z</span><span class="p">[</span><span class="n">index_best_fit_sam</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">sam_y</span><span class="p">[</span><span class="n">index_best_fit_sam</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">sam_j</span><span class="p">[</span><span class="n">index_best_fit_sam</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span>\
                            <span class="n">sam_h</span><span class="p">[</span><span class="n">index_best_fit_sam</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">sam_k</span><span class="p">[</span><span class="n">index_best_fit_sam</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">sf_avg</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">sigma_sf</span><span class="p">,</span>\
                            <span class="n">min_dquad_element</span><span class="p">,</span> <span class="n">computed_j</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">computed_j_error</span><span class="p">,</span> <span class="n">computed_h</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>\
                            <span class="n">computed_h_error</span><span class="p">,</span> <span class="n">computed_k</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">computed_k_error</span><span class="p">,</span> <span class="o">-</span><span class="mi">999</span><span class="p">,</span> <span class="o">-</span><span class="mi">999</span><span class="p">,</span> <span class="o">-</span><span class="mi">999</span><span class="p">,</span>\
                            <span class="o">-</span><span class="mi">999</span><span class="p">,</span> <span class="o">-</span><span class="mi">999</span><span class="p">,</span> <span class="o">-</span><span class="mi">999</span><span class="p">,</span> <span class="o">-</span><span class="mi">999</span><span class="p">,</span> <span class="o">-</span><span class="mi">999</span><span class="p">,</span> <span class="o">-</span><span class="mi">999</span><span class="p">,</span> <span class="o">-</span><span class="mi">999</span><span class="p">,</span> <span class="o">-</span><span class="mi">999</span><span class="p">,</span> <span class="o">-</span><span class="mi">999</span><span class="p">,</span> <span class="o">-</span><span class="mi">999</span><span class="p">,</span> <span class="n">objinfoflag</span><span class="p">[</span><span class="n">j</span><span class="p">],</span>\
                            <span class="n">qualityflag</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">ndetections</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">nstackdetections</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">ginfoflag</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">ginfoflag2</span><span class="p">[</span><span class="n">j</span><span class="p">],</span>\
                            <span class="n">ginfoflag3</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">rinfoflag</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">rinfoflag2</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">rinfoflag3</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">iinfoflag</span><span class="p">[</span><span class="n">j</span><span class="p">],</span>\
                            <span class="n">iinfoflag2</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">iinfoflag3</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">zinfoflag</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">zinfoflag2</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">zinfoflag3</span><span class="p">[</span><span class="n">j</span><span class="p">],</span>\
                            <span class="n">yinfoflag</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">yinfoflag2</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">yinfoflag3</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
                        <span class="n">writer</span><span class="o">.</span><span class="n">writerow</span><span class="p">(</span><span class="n">irgsc_data</span><span class="p">)</span>
                <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">index_min_ang_seperation</span><span class="p">)</span> <span class="o">==</span> <span class="mf">1.0</span><span class="p">:</span>
                        <span class="n">irgsc_data</span> <span class="o">=</span> <span class="n">ps1_objid</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">ps_ra</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">err_ps_ra</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">ps_dec</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">err_ps_dec</span><span class="p">[</span><span class="n">j</span><span class="p">],</span>\
                            <span class="n">ec_gmag</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">e_ec_gmag</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">ec_rmag</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">e_ec_rmag</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">ec_imag</span><span class="p">[</span><span class="n">j</span><span class="p">],</span>\
                            <span class="n">e_ec_imag</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">ec_zmag</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">e_ec_zmag</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">ec_ymag</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">e_ec_ymag</span><span class="p">[</span><span class="n">j</span><span class="p">],</span>\
                            <span class="n">teff</span><span class="p">[</span><span class="n">index_best_fit_sam</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> \
                            <span class="n">logg</span><span class="p">[</span><span class="n">index_best_fit_sam</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">feh</span><span class="p">[</span><span class="n">index_best_fit_sam</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> \
                            <span class="n">sam_g</span><span class="p">[</span><span class="n">index_best_fit_sam</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">sam_r</span><span class="p">[</span><span class="n">index_best_fit_sam</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">sam_i</span><span class="p">[</span><span class="n">index_best_fit_sam</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> \
                            <span class="n">sam_z</span><span class="p">[</span><span class="n">index_best_fit_sam</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">sam_y</span><span class="p">[</span><span class="n">index_best_fit_sam</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">sam_j</span><span class="p">[</span><span class="n">index_best_fit_sam</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span>\
                            <span class="n">sam_h</span><span class="p">[</span><span class="n">index_best_fit_sam</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">sam_k</span><span class="p">[</span><span class="n">index_best_fit_sam</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">sf_avg</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">sigma_sf</span><span class="p">,</span>\
                            <span class="n">min_dquad_element</span><span class="p">,</span> <span class="n">computed_j</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">computed_j_error</span><span class="p">,</span> <span class="n">computed_h</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>\
                            <span class="n">computed_h_error</span><span class="p">,</span> <span class="n">computed_k</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">computed_k_error</span><span class="p">,</span> <span class="n">gaia_source_id</span><span class="p">[</span><span class="n">index_min_ang_seperation</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span>\
                            <span class="n">gaia_ra</span><span class="p">[</span><span class="n">index_min_ang_seperation</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">gaia_ra_error</span><span class="p">[</span><span class="n">index_min_ang_seperation</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span>\
                            <span class="n">gaia_dec</span><span class="p">[</span><span class="n">index_min_ang_seperation</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">gaia_dec_error</span><span class="p">[</span><span class="n">index_min_ang_seperation</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span>\
                            <span class="n">gaia_parallax</span><span class="p">[</span><span class="n">index_min_ang_seperation</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">gaia_parallax_error</span><span class="p">[</span><span class="n">index_min_ang_seperation</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span>\
                            <span class="n">gaia_pm</span><span class="p">[</span><span class="n">index_min_ang_seperation</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">gaia_pm_ra</span><span class="p">[</span><span class="n">index_min_ang_seperation</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span>\
                            <span class="n">gaia_pm_ra_error</span><span class="p">[</span><span class="n">index_min_ang_seperation</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">gaia_pm_dec</span><span class="p">[</span><span class="n">index_min_ang_seperation</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span>\
                            <span class="n">gaia_pm_dec_error</span><span class="p">[</span><span class="n">index_min_ang_seperation</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">gaia_ruwe</span><span class="p">[</span><span class="n">index_min_ang_seperation</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span>\
                            <span class="n">objinfoflag</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">qualityflag</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">ndetections</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">nstackdetections</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">ginfoflag</span><span class="p">[</span><span class="n">j</span><span class="p">],</span>\
                            <span class="n">ginfoflag2</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">ginfoflag3</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">rinfoflag</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">rinfoflag2</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">rinfoflag3</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">iinfoflag</span><span class="p">[</span><span class="n">j</span><span class="p">],</span>\
                            <span class="n">iinfoflag2</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">iinfoflag3</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">zinfoflag</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">zinfoflag2</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">zinfoflag3</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">yinfoflag</span><span class="p">[</span><span class="n">j</span><span class="p">],</span>\
                            <span class="n">iinfoflag2</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">yinfoflag3</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
                        <span class="n">writer</span><span class="o">.</span><span class="n">writerow</span><span class="p">(</span><span class="n">irgsc_data</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">irgsc_data</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="doc doc-object doc-module">
<a id="irgsctool._validate"></a>
<div class="doc doc-contents first">
<div class="doc doc-children">
<div class="doc doc-object doc-class">
<h2 class="doc doc-heading" id="irgsctool._validate.ValidateIRGSC">
<code>ValidateIRGSC</code>
</h2>
<div class="doc doc-contents">
<p><justify> The <strong><em>Validate</em></strong> class includes methods to validate the generated irgsc,
generate a validated catalog and plot the comparison of the
observed and computed NIR magnitudes. </justify></p>
<details class="quote">
<summary>Source code in <code>irgsctool/_validate.py</code></summary>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">ValidateIRGSC</span><span class="p">():</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">            &lt;justify&gt; The ***Validate*** class includes methods to validate the generated irgsc,</span>
<span class="sd">            generate a validated catalog and plot the comparison of the</span>
<span class="sd">            observed and computed NIR magnitudes. &lt;/justify&gt;</span>

<span class="sd">    """</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ra</span><span class="p">,</span> <span class="n">dec</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ra</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dec</span> <span class="o">=</span> <span class="n">ra</span><span class="p">,</span> <span class="n">dec</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rd</span> <span class="o">=</span> <span class="n">ReadData</span><span class="p">(</span><span class="n">ra</span><span class="p">,</span><span class="n">dec</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">read_irgsc</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""</span>

<span class="sd">            `irgsctool.validate.read_irgsc()`</span>

<span class="sd">            This function reads the generated IRGSC for a given set of coordinates.</span>
<span class="sd">            Raises:</span>
<span class="sd">                FileNotFoundError: This error arises if there is no generated IRGSC</span>
<span class="sd">                available. However, this function then generates it.</span>

<span class="sd">        """</span>
        <span class="n">ra_name</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ra</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">'.'</span><span class="p">,</span><span class="s1">'_'</span><span class="p">)</span>
        <span class="n">dec_name</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dec</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">'.'</span><span class="p">,</span> <span class="s1">'_'</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">irgsc_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">genfromtxt</span><span class="p">(</span><span class="s1">'IRGSC'</span> <span class="o">+</span> <span class="s1">'_'</span> <span class="o">+</span> <span class="s1">'RA'</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">ra_name</span><span class="p">)</span> <span class="o">+</span> <span class="s1">'DEC'</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">dec_name</span><span class="p">)</span> <span class="o">+</span>\
                      <span class="nb">str</span><span class="p">(</span><span class="n">current_datetime</span><span class="p">)</span> <span class="o">+</span> <span class="s1">'.csv'</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="s1">','</span><span class="p">,</span> <span class="n">skip_header</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

        <span class="k">except</span> <span class="ne">FileNotFoundError</span><span class="p">:</span>
            <span class="n">gc</span> <span class="o">=</span> <span class="n">GenerateIRGSC</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ra</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">dec</span><span class="p">)</span>
            <span class="n">gc</span><span class="o">.</span><span class="n">generate_irgsc</span><span class="p">()</span>
        <span class="n">irgsc_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">genfromtxt</span><span class="p">(</span><span class="s1">'IRGSC'</span> <span class="o">+</span> <span class="s1">'_'</span> <span class="o">+</span> <span class="s1">'RA'</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">ra_name</span><span class="p">)</span> <span class="o">+</span> <span class="s1">'DEC'</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">dec_name</span><span class="p">)</span> <span class="o">+</span>\
                      <span class="nb">str</span><span class="p">(</span><span class="n">current_datetime</span><span class="p">)</span> <span class="o">+</span> <span class="s1">'.csv'</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="s1">','</span><span class="p">,</span> <span class="n">skip_header</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">ps1_objid</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">ps_ra</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">err_ps_ra</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">ps_dec</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">3</span><span class="p">]</span>
        <span class="n">err_ps_dec</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">4</span><span class="p">]</span>
        <span class="n">ec_gmag</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">5</span><span class="p">]</span>
        <span class="n">e_ec_gmag</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">6</span><span class="p">]</span>
        <span class="n">ec_rmag</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">7</span><span class="p">]</span>
        <span class="n">e_ec_rmag</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">8</span><span class="p">]</span>
        <span class="n">ec_imag</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">9</span><span class="p">]</span>
        <span class="n">e_ec_imag</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">10</span><span class="p">]</span>
        <span class="n">ec_zmag</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">11</span><span class="p">]</span>
        <span class="n">e_ec_zmag</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">12</span><span class="p">]</span>
        <span class="n">ec_ymag</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">13</span><span class="p">]</span>
        <span class="n">e_ec_ymag</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">14</span><span class="p">]</span>
        <span class="n">teff</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">15</span><span class="p">]</span>
        <span class="n">logg</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">16</span><span class="p">]</span>
        <span class="n">feh</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">17</span><span class="p">]</span>
        <span class="n">sam_g</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">18</span><span class="p">]</span>
        <span class="n">sam_r</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">19</span><span class="p">]</span>
        <span class="n">sam_i</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">20</span><span class="p">]</span>
        <span class="n">sam_z</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">21</span><span class="p">]</span>
        <span class="n">sam_y</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">22</span><span class="p">]</span>
        <span class="n">sam_j</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">23</span><span class="p">]</span>
        <span class="n">sam_h</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">24</span><span class="p">]</span>
        <span class="n">sam_k</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">25</span><span class="p">]</span>
        <span class="n">sf_avg</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">26</span><span class="p">]</span>
        <span class="n">sigma_sf</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">27</span><span class="p">]</span>
        <span class="n">min_dquad_element</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">28</span><span class="p">]</span>
        <span class="n">computed_j</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">29</span><span class="p">]</span>
        <span class="n">computed_j_error</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">30</span><span class="p">]</span>
        <span class="n">computed_h</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">31</span><span class="p">]</span>
        <span class="n">computed_h_error</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">32</span><span class="p">]</span>
        <span class="n">computed_k</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">33</span><span class="p">]</span>
        <span class="n">computed_k_error</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">34</span><span class="p">]</span>
        <span class="n">gaia_source_id</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">35</span><span class="p">]</span>
        <span class="n">gaia_ra</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">36</span><span class="p">]</span>
        <span class="n">gaia_ra_error</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">37</span><span class="p">]</span>
        <span class="n">gaia_dec</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">38</span><span class="p">]</span>
        <span class="n">gaia_dec_error</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">39</span><span class="p">]</span>
        <span class="n">gaia_parallax</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">40</span><span class="p">]</span>
        <span class="n">gaia_parallax_error</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">41</span><span class="p">]</span>
        <span class="n">gaia_pm</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">42</span><span class="p">]</span>
        <span class="n">gaia_pm_ra</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">43</span><span class="p">]</span>
        <span class="n">gaia_pm_ra_error</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">44</span><span class="p">]</span>
        <span class="n">gaia_pm_dec</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">45</span><span class="p">]</span>
        <span class="n">gaia_pm_dec_error</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">46</span><span class="p">]</span>
        <span class="n">gaia_ruwe</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">47</span><span class="p">]</span>
        <span class="n">objinfoflag</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">48</span><span class="p">]</span>
        <span class="n">qualityflag</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">49</span><span class="p">]</span>
        <span class="n">ndetections</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">50</span><span class="p">]</span>
        <span class="n">nstackdetections</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">51</span><span class="p">]</span>
        <span class="n">ginfoflag</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">52</span><span class="p">]</span>
        <span class="n">ginfoflag2</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">53</span><span class="p">]</span>
        <span class="n">ginfoflag3</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">54</span><span class="p">]</span>
        <span class="n">rinfoflag</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">55</span><span class="p">]</span>
        <span class="n">rinfoflag2</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">56</span><span class="p">]</span>
        <span class="n">rinfoflag3</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">57</span><span class="p">]</span>
        <span class="n">iinfoflag</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">58</span><span class="p">]</span>
        <span class="n">iinfoflag2</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">59</span><span class="p">]</span>
        <span class="n">iinfoflag3</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">60</span><span class="p">]</span>
        <span class="n">zinfoflag</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">61</span><span class="p">]</span>
        <span class="n">zinfoflag2</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">62</span><span class="p">]</span>
        <span class="n">zinfoflag3</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">63</span><span class="p">]</span>
        <span class="n">yinfoflag</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">64</span><span class="p">]</span>
        <span class="n">yinfoflag2</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">65</span><span class="p">]</span>
        <span class="n">yinfoflag3</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">66</span><span class="p">]</span>

        <span class="n">irgsc_data</span> <span class="o">=</span> <span class="n">ps1_objid</span><span class="p">,</span> <span class="n">ps_ra</span><span class="p">,</span> <span class="n">err_ps_ra</span><span class="p">,</span> <span class="n">ps_dec</span><span class="p">,</span> <span class="n">err_ps_dec</span><span class="p">,</span> <span class="n">ec_gmag</span><span class="p">,</span> <span class="n">e_ec_gmag</span><span class="p">,</span> <span class="n">ec_rmag</span><span class="p">,</span> <span class="n">e_ec_rmag</span><span class="p">,</span>\
            <span class="n">ec_imag</span><span class="p">,</span> <span class="n">e_ec_imag</span><span class="p">,</span> <span class="n">ec_zmag</span><span class="p">,</span> <span class="n">e_ec_zmag</span><span class="p">,</span> <span class="n">ec_ymag</span><span class="p">,</span> <span class="n">e_ec_ymag</span><span class="p">,</span> <span class="n">teff</span><span class="p">,</span> <span class="n">logg</span><span class="p">,</span> <span class="n">feh</span><span class="p">,</span> <span class="n">sam_g</span><span class="p">,</span>\
                <span class="n">sam_r</span><span class="p">,</span> <span class="n">sam_i</span><span class="p">,</span> <span class="n">sam_z</span><span class="p">,</span> <span class="n">sam_y</span><span class="p">,</span> <span class="n">sam_j</span><span class="p">,</span> <span class="n">sam_h</span><span class="p">,</span> <span class="n">sam_k</span><span class="p">,</span> <span class="n">sf_avg</span><span class="p">,</span> <span class="n">sigma_sf</span><span class="p">,</span> <span class="n">min_dquad_element</span><span class="p">,</span>\
                <span class="n">computed_j</span><span class="p">,</span> <span class="n">computed_j_error</span><span class="p">,</span> <span class="n">computed_h</span><span class="p">,</span> <span class="n">computed_h_error</span><span class="p">,</span> <span class="n">computed_k</span><span class="p">,</span> <span class="n">computed_k_error</span><span class="p">,</span>\
                    <span class="n">gaia_source_id</span><span class="p">,</span> <span class="n">gaia_ra</span><span class="p">,</span> <span class="n">gaia_ra_error</span><span class="p">,</span> <span class="n">gaia_dec</span><span class="p">,</span> <span class="n">gaia_dec_error</span><span class="p">,</span> <span class="n">gaia_parallax</span><span class="p">,</span>\
                    <span class="n">gaia_parallax_error</span><span class="p">,</span> <span class="n">gaia_pm</span><span class="p">,</span> <span class="n">gaia_pm_ra</span><span class="p">,</span> <span class="n">gaia_pm_ra_error</span><span class="p">,</span> <span class="n">gaia_pm_dec</span><span class="p">,</span>\
                        <span class="n">gaia_pm_dec_error</span><span class="p">,</span> <span class="n">gaia_ruwe</span><span class="p">,</span> <span class="n">objinfoflag</span><span class="p">,</span> <span class="n">qualityflag</span><span class="p">,</span> <span class="n">ndetections</span><span class="p">,</span>\
                        <span class="n">nstackdetections</span><span class="p">,</span> <span class="n">ginfoflag</span><span class="p">,</span> <span class="n">ginfoflag2</span><span class="p">,</span> <span class="n">ginfoflag3</span><span class="p">,</span> <span class="n">rinfoflag</span><span class="p">,</span> <span class="n">rinfoflag2</span><span class="p">,</span>\
                            <span class="n">rinfoflag3</span><span class="p">,</span> <span class="n">iinfoflag</span><span class="p">,</span> <span class="n">iinfoflag2</span><span class="p">,</span> <span class="n">iinfoflag3</span><span class="p">,</span> <span class="n">zinfoflag</span><span class="p">,</span> <span class="n">zinfoflag2</span><span class="p">,</span>\
                            <span class="n">zinfoflag3</span><span class="p">,</span> <span class="n">yinfoflag</span><span class="p">,</span> <span class="n">yinfoflag2</span><span class="p">,</span> <span class="n">yinfoflag3</span>
        <span class="k">return</span> <span class="n">irgsc_data</span>

    <span class="k">def</span> <span class="nf">validate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">validate</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""</span>

<span class="sd">            `irgsctool.ValidateIRGSC.calidate(validate=True)`</span>

<span class="sd">            This method compares the observed and computed NIR magnitudes for a given field.</span>
<span class="sd">            If this is set to True, the method first obtains the UKIDSS data for the given field.</span>
<span class="sd">            The output is a validated IRGSC and plots showing the comparison of the </span>
<span class="sd">            computed NIR magnitudes with the observed ones.</span>

<span class="sd">            Raises:</span>
<span class="sd">                    ValueError: if validate is False</span>

<span class="sd">        """</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">""</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">'###############################################################################'</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">'Now validating the generated IRGSC using the UKIDSS data file if it is present.'</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">""</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">'###############################################################################'</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">validate</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">True</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">'Cannot proceed as validate=False'</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">validate</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
            <span class="n">ukidss_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rd</span><span class="o">.</span><span class="n">read_nir_data</span><span class="p">()</span>
            <span class="n">irgsc_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">read_irgsc</span><span class="p">()</span>
            <span class="n">ukidss_j</span><span class="p">,</span> <span class="n">ukidss_h</span><span class="p">,</span> <span class="n">ukidss_k</span><span class="p">,</span> <span class="n">e_ukidss_j</span><span class="p">,</span> <span class="n">e_ukidss_h</span><span class="p">,</span> <span class="n">e_ukidss_k</span><span class="p">,</span> <span class="n">ukidss_ra</span><span class="p">,</span> <span class="n">ukidss_dec</span> <span class="o">=</span> <span class="n">ukidss_data</span>
            <span class="n">ps1_objid</span><span class="p">,</span> <span class="n">ps_ra</span><span class="p">,</span> <span class="n">err_ps_ra</span><span class="p">,</span> <span class="n">ps_dec</span><span class="p">,</span> <span class="n">err_ps_dec</span><span class="p">,</span> <span class="n">ec_gmag</span><span class="p">,</span> <span class="n">e_ec_gmag</span><span class="p">,</span> <span class="n">ec_rmag</span><span class="p">,</span>\
                <span class="n">e_ec_rmag</span><span class="p">,</span> <span class="n">ec_imag</span><span class="p">,</span> <span class="n">e_ec_imag</span><span class="p">,</span> <span class="n">ec_zmag</span><span class="p">,</span> <span class="n">e_ec_zmag</span><span class="p">,</span> <span class="n">ec_ymag</span><span class="p">,</span> <span class="n">e_ec_ymag</span><span class="p">,</span> <span class="n">teff</span><span class="p">,</span>\
                <span class="n">logg</span><span class="p">,</span> <span class="n">feh</span><span class="p">,</span> <span class="n">sam_g</span><span class="p">,</span><span class="n">sam_r</span><span class="p">,</span> <span class="n">sam_i</span><span class="p">,</span> <span class="n">sam_z</span><span class="p">,</span> <span class="n">sam_y</span><span class="p">,</span> <span class="n">sam_j</span><span class="p">,</span> <span class="n">sam_h</span><span class="p">,</span> <span class="n">sam_k</span><span class="p">,</span> <span class="n">sf_avg</span><span class="p">,</span> <span class="n">sigma_sf</span><span class="p">,</span>\
                    <span class="n">min_dquad_element</span><span class="p">,</span> <span class="n">computed_j</span><span class="p">,</span> <span class="n">computed_j_error</span><span class="p">,</span> <span class="n">computed_h</span><span class="p">,</span> <span class="n">computed_h_error</span><span class="p">,</span>\
                        <span class="n">computed_k</span><span class="p">,</span> <span class="n">computed_k_error</span><span class="p">,</span> <span class="n">gaia_source_id</span><span class="p">,</span> <span class="n">gaia_ra</span><span class="p">,</span> <span class="n">gaia_ra_error</span><span class="p">,</span>\
                            <span class="n">gaia_dec</span><span class="p">,</span> <span class="n">gaia_dec_error</span><span class="p">,</span> <span class="n">gaia_parallax</span><span class="p">,</span> <span class="n">gaia_parallax_error</span><span class="p">,</span>\
                            <span class="n">gaia_pm</span><span class="p">,</span> <span class="n">gaia_pm_ra</span><span class="p">,</span> <span class="n">gaia_pm_ra_error</span><span class="p">,</span> <span class="n">gaia_pm_dec</span><span class="p">,</span> <span class="n">gaia_pm_dec_error</span><span class="p">,</span>\
                                <span class="n">gaia_ruwe</span><span class="p">,</span> <span class="n">objinfoflag</span><span class="p">,</span> <span class="n">qualityflag</span><span class="p">,</span> <span class="n">ndetections</span><span class="p">,</span> <span class="n">nstackdetections</span><span class="p">,</span>\
                                <span class="n">ginfoflag</span><span class="p">,</span> <span class="n">ginfoflag2</span><span class="p">,</span> <span class="n">ginfoflag3</span><span class="p">,</span> <span class="n">rinfoflag</span><span class="p">,</span> <span class="n">rinfoflag2</span><span class="p">,</span> <span class="n">rinfoflag3</span><span class="p">,</span>\
                                    <span class="n">iinfoflag</span><span class="p">,</span> <span class="n">iinfoflag2</span><span class="p">,</span> <span class="n">iinfoflag3</span><span class="p">,</span> <span class="n">zinfoflag</span><span class="p">,</span> <span class="n">zinfoflag2</span><span class="p">,</span>\
                                    <span class="n">zinfoflag3</span><span class="p">,</span> <span class="n">yinfoflag</span><span class="p">,</span> <span class="n">yinfoflag2</span><span class="p">,</span> <span class="n">yinfoflag3</span> <span class="o">=</span> <span class="n">irgsc_data</span>

        <span class="n">validate_params</span><span class="o">=</span><span class="p">[];</span> <span class="n">ob_j</span> <span class="o">=</span> <span class="p">[];</span> <span class="n">e_ob_j</span> <span class="o">=</span> <span class="p">[];</span> <span class="n">ob_h</span> <span class="o">=</span> <span class="p">[];</span> <span class="n">e_ob_h</span> <span class="o">=</span> <span class="p">[];</span> <span class="n">ob_k</span> <span class="o">=</span> <span class="p">[];</span> <span class="n">e_ob_k</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">diff_jf</span> <span class="o">=</span> <span class="p">[];</span> <span class="n">diff_hf</span> <span class="o">=</span> <span class="p">[];</span> <span class="n">diff_kf</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">ra_name</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ra</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">'.'</span><span class="p">,</span><span class="s1">'_'</span><span class="p">);</span> <span class="n">dec_name</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dec</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">'.'</span><span class="p">,</span> <span class="s1">'_'</span><span class="p">)</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">'validated_IRGSC'</span> <span class="o">+</span> <span class="s1">'_'</span> <span class="o">+</span> <span class="s1">'RA'</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">ra_name</span><span class="p">)</span> <span class="o">+</span> <span class="s1">'_'</span> <span class="o">+</span> <span class="s1">'DEC'</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">dec_name</span><span class="p">)</span> <span class="o">+</span> <span class="s1">'_'</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">current_datetime</span><span class="p">)</span> <span class="o">+</span> <span class="s1">'.csv'</span><span class="p">,</span> <span class="s1">'w'</span><span class="p">)</span> <span class="k">as</span> <span class="n">file2</span><span class="p">:</span>
            <span class="n">writer</span><span class="o">=</span><span class="n">csv</span><span class="o">.</span><span class="n">writer</span><span class="p">(</span><span class="n">file2</span><span class="p">)</span>
            <span class="n">writer</span><span class="o">.</span><span class="n">writerow</span><span class="p">(</span><span class="n">header</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">i1</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ps_ra</span><span class="p">)):</span>
                <span class="c1">#positionally matching the sources in the UKIDSS within 1" to the PS1 sources in the catalogue</span>
                <span class="n">gamma_ukidss</span> <span class="o">=</span> <span class="mi">3600</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(((</span><span class="n">ps_ra</span><span class="p">[</span><span class="n">i1</span><span class="p">]</span> <span class="o">-</span> <span class="n">ukidss_ra</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="n">ps_dec</span><span class="p">[</span><span class="n">i1</span><span class="p">])))</span><span class="o">**</span><span class="mi">2</span>\
                                      <span class="o">+</span> <span class="p">(</span><span class="n">ps_dec</span><span class="p">[</span><span class="n">i1</span><span class="p">]</span> <span class="o">-</span> <span class="n">ukidss_dec</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
                <span class="n">index_ukidss_position</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">gamma_ukidss</span><span class="o">&lt;=</span><span class="mf">1.0</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">index_ukidss_position</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="n">matched_positions</span> <span class="o">=</span> <span class="n">gamma_ukidss</span><span class="p">[</span><span class="n">index_ukidss_position</span><span class="p">]</span>
                    <span class="n">minimum_seperation</span> <span class="o">=</span> <span class="n">gamma_ukidss</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">matched_positions</span><span class="p">)</span> <span class="o">==</span> <span class="n">gamma_ukidss</span><span class="p">)[</span><span class="mi">0</span><span class="p">]]</span>
                    <span class="n">index_minimum_seperation</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">minimum_seperation</span> <span class="o">==</span> <span class="n">gamma_ukidss</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
                    <span class="n">diff_j</span> <span class="o">=</span> <span class="n">ukidss_j</span><span class="p">[</span><span class="n">index_minimum_seperation</span><span class="p">]</span> <span class="o">-</span> <span class="n">computed_j</span><span class="p">[</span><span class="n">i1</span><span class="p">]</span>
                    <span class="n">diff_h</span> <span class="o">=</span> <span class="n">ukidss_h</span><span class="p">[</span><span class="n">index_minimum_seperation</span><span class="p">]</span> <span class="o">-</span> <span class="n">computed_h</span><span class="p">[</span><span class="n">i1</span><span class="p">]</span>
                    <span class="n">diff_k</span> <span class="o">=</span> <span class="n">ukidss_k</span><span class="p">[</span><span class="n">index_minimum_seperation</span><span class="p">]</span> <span class="o">-</span> <span class="n">computed_k</span><span class="p">[</span><span class="n">i1</span><span class="p">]</span>
                    <span class="n">validate_params</span> <span class="o">=</span> <span class="n">ps1_objid</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">ps_ra</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">err_ps_ra</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">ps_dec</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">err_ps_dec</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">ec_gmag</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">e_ec_gmag</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">ec_rmag</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span>\
                    <span class="n">e_ec_rmag</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">ec_imag</span><span class="p">,</span> <span class="n">e_ec_imag</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">ec_zmag</span><span class="p">,</span> <span class="n">e_ec_zmag</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">ec_ymag</span><span class="p">,</span> <span class="n">e_ec_ymag</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">teff</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">logg</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">feh</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">sam_g</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span>\
                    <span class="n">sam_r</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">sam_i</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">sam_z</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">sam_y</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">sam_j</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">sam_h</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">sam_k</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">sf_avg</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">sigma_sf</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">min_dquad_element</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span>\
                    <span class="n">computed_j</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">computed_j_error</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">computed_h</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">computed_h_error</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">computed_k</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">computed_k_error</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">gaia_source_id</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span>\
                    <span class="n">gaia_ra</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">gaia_ra_error</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">gaia_dec</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">gaia_dec_error</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">gaia_parallax</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">gaia_parallax_error</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">gaia_pm</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">gaia_pm_ra</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span>\
                    <span class="n">gaia_pm_ra_error</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">gaia_pm_dec</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">gaia_pm_dec_error</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">gaia_ruwe</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">objinfoflag</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">qualityflag</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">ndetections</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">nstackdetections</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span>\
                    <span class="n">ginfoflag</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">ginfoflag2</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">ginfoflag3</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">rinfoflag</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">rinfoflag2</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">rinfoflag3</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">iinfoflag</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">iinfoflag2</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">iinfoflag3</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span>\
                    <span class="n">zinfoflag</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">zinfoflag2</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">zinfoflag3</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">yinfoflag</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">yinfoflag2</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">yinfoflag3</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">diff_j</span><span class="p">,</span> <span class="n">diff_h</span><span class="p">,</span> <span class="n">diff_k</span><span class="p">,</span>\
                    <span class="n">ukidss_j</span><span class="p">[</span><span class="n">index_minimum_seperation</span><span class="p">],</span> <span class="n">e_ukidss_j</span><span class="p">[</span><span class="n">index_minimum_seperation</span><span class="p">],</span> <span class="n">ukidss_h</span><span class="p">[</span><span class="n">index_minimum_seperation</span><span class="p">],</span> <span class="n">e_ukidss_h</span><span class="p">[</span><span class="n">index_minimum_seperation</span><span class="p">],</span>\
                    <span class="n">ukidss_k</span><span class="p">[</span><span class="n">index_minimum_seperation</span><span class="p">],</span> <span class="n">e_ukidss_k</span><span class="p">[</span><span class="n">index_minimum_seperation</span><span class="p">]</span>
                    <span class="n">writer</span><span class="o">.</span><span class="n">writerow</span><span class="p">(</span><span class="n">validate_params</span><span class="p">)</span>
                    <span class="n">ob_j</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ob_j</span><span class="p">,</span> <span class="n">ukidss_j</span><span class="p">[</span><span class="n">index_minimum_seperation</span><span class="p">])</span>
                    <span class="n">e_ob_j</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">e_ob_j</span><span class="p">,</span> <span class="n">e_ukidss_j</span><span class="p">[</span><span class="n">index_minimum_seperation</span><span class="p">])</span>
                    <span class="n">ob_h</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ob_h</span><span class="p">,</span> <span class="n">ukidss_h</span><span class="p">[</span><span class="n">index_minimum_seperation</span><span class="p">])</span>
                    <span class="n">e_ob_h</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">e_ob_h</span><span class="p">,</span> <span class="n">e_ukidss_h</span><span class="p">[</span><span class="n">index_minimum_seperation</span><span class="p">])</span>
                    <span class="n">ob_k</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ob_k</span><span class="p">,</span> <span class="n">ukidss_k</span><span class="p">[</span><span class="n">index_minimum_seperation</span><span class="p">])</span>
                    <span class="n">e_ob_k</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">e_ob_k</span><span class="p">,</span> <span class="n">e_ukidss_k</span><span class="p">[</span><span class="n">index_minimum_seperation</span><span class="p">])</span>
                    <span class="n">diff_jf</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">diff_jf</span><span class="p">,</span> <span class="n">diff_j</span><span class="p">)</span>
                    <span class="n">diff_hf</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">diff_hf</span><span class="p">,</span> <span class="n">diff_h</span><span class="p">)</span>
                    <span class="n">diff_kf</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">diff_kf</span><span class="p">,</span> <span class="n">diff_k</span><span class="p">)</span>
                <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">index_ukidss_position</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="n">diff_j</span> <span class="o">=</span> <span class="n">ukidss_j</span><span class="p">[</span><span class="n">index_ukidss_position</span><span class="p">]</span> <span class="o">-</span> <span class="n">computed_j</span><span class="p">[</span><span class="n">i1</span><span class="p">]</span>
                    <span class="n">diff_h</span> <span class="o">=</span> <span class="n">ukidss_h</span><span class="p">[</span><span class="n">index_ukidss_position</span><span class="p">]</span> <span class="o">-</span> <span class="n">computed_h</span><span class="p">[</span><span class="n">i1</span><span class="p">]</span>
                    <span class="n">diff_k</span> <span class="o">=</span> <span class="n">ukidss_k</span><span class="p">[</span><span class="n">index_ukidss_position</span><span class="p">]</span> <span class="o">-</span> <span class="n">computed_k</span><span class="p">[</span><span class="n">i1</span><span class="p">]</span>
                    <span class="n">validate_params</span> <span class="o">=</span> <span class="n">ps1_objid</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">ps_ra</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">err_ps_ra</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">ps_dec</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">err_ps_dec</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">ec_gmag</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">e_ec_gmag</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">ec_rmag</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span>\
                    <span class="n">e_ec_rmag</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">ec_imag</span><span class="p">,</span> <span class="n">e_ec_imag</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">ec_zmag</span><span class="p">,</span> <span class="n">e_ec_zmag</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">ec_ymag</span><span class="p">,</span> <span class="n">e_ec_ymag</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">teff</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">logg</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">feh</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">sam_g</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span>\
                    <span class="n">sam_r</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">sam_i</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">sam_z</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">sam_y</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">sam_j</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">sam_h</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">sam_k</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">sf_avg</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">sigma_sf</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">min_dquad_element</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span>\
                    <span class="n">computed_j</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">computed_j_error</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">computed_h</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">computed_h_error</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">computed_k</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">computed_k_error</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">gaia_source_id</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span>\
                    <span class="n">gaia_ra</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">gaia_ra_error</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">gaia_dec</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">gaia_dec_error</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">gaia_parallax</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">gaia_parallax_error</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">gaia_pm</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">gaia_pm_ra</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span>\
                    <span class="n">gaia_pm_ra_error</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">gaia_pm_dec</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">gaia_pm_dec_error</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">gaia_ruwe</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">objinfoflag</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">qualityflag</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">ndetections</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">nstackdetections</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span>\
                    <span class="n">ginfoflag</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">ginfoflag2</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">ginfoflag3</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">rinfoflag</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">rinfoflag2</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">rinfoflag3</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">iinfoflag</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">iinfoflag2</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">iinfoflag3</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span>\
                    <span class="n">zinfoflag</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">zinfoflag2</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">zinfoflag3</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">yinfoflag</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">yinfoflag2</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">yinfoflag3</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">diff_j</span><span class="p">,</span> <span class="n">diff_h</span><span class="p">,</span> <span class="n">diff_k</span><span class="p">,</span>\
                    <span class="n">ukidss_j</span><span class="p">[</span><span class="n">index_ukidss_position</span><span class="p">],</span> <span class="n">e_ukidss_j</span><span class="p">[</span><span class="n">index_ukidss_position</span><span class="p">],</span> <span class="n">ukidss_h</span><span class="p">[</span><span class="n">index_ukidss_position</span><span class="p">],</span> <span class="n">e_ukidss_h</span><span class="p">[</span><span class="n">index_ukidss_position</span><span class="p">],</span>\
                    <span class="n">ukidss_k</span><span class="p">[</span><span class="n">index_ukidss_position</span><span class="p">],</span> <span class="n">e_ukidss_k</span><span class="p">[</span><span class="n">index_ukidss_position</span><span class="p">]</span>
                    <span class="n">writer</span><span class="o">.</span><span class="n">writerow</span><span class="p">(</span><span class="n">validate_params</span><span class="p">)</span>
                    <span class="n">ob_j</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ob_j</span><span class="p">,</span> <span class="n">ukidss_j</span><span class="p">[</span><span class="n">index_ukidss_position</span><span class="p">])</span>
                    <span class="n">e_ob_j</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">e_ob_j</span><span class="p">,</span> <span class="n">e_ukidss_j</span><span class="p">[</span><span class="n">index_ukidss_position</span><span class="p">])</span>
                    <span class="n">ob_h</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ob_h</span><span class="p">,</span> <span class="n">ukidss_h</span><span class="p">[</span><span class="n">index_ukidss_position</span><span class="p">])</span>
                    <span class="n">e_ob_h</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">e_ob_h</span><span class="p">,</span> <span class="n">e_ukidss_h</span><span class="p">[</span><span class="n">index_ukidss_position</span><span class="p">])</span>
                    <span class="n">ob_k</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ob_k</span><span class="p">,</span> <span class="n">ukidss_k</span><span class="p">[</span><span class="n">index_ukidss_position</span><span class="p">])</span>
                    <span class="n">e_ob_k</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">e_ob_k</span><span class="p">,</span> <span class="n">e_ukidss_k</span><span class="p">[</span><span class="n">index_ukidss_position</span><span class="p">])</span>
                    <span class="n">diff_jf</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">diff_jf</span><span class="p">,</span> <span class="n">diff_j</span><span class="p">)</span>
                    <span class="n">diff_hf</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">diff_hf</span><span class="p">,</span> <span class="n">diff_h</span><span class="p">)</span>
                    <span class="n">diff_kf</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">diff_kf</span><span class="p">,</span> <span class="n">diff_k</span><span class="p">)</span>

        <span class="n">indjp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">diff_jf</span><span class="p">)</span><span class="o">&lt;</span><span class="mf">0.2</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">indhp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">diff_hf</span><span class="p">)</span><span class="o">&lt;</span><span class="mf">0.2</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">indkp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">diff_kf</span><span class="p">)</span><span class="o">&lt;</span><span class="mf">0.2</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">clf</span><span class="p">()</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">ob_j</span><span class="p">,</span> <span class="n">e_ob_j</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">'Error in $J_</span><span class="si">{UKIDSS}</span><span class="s1">$'</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">'$J_</span><span class="si">{UKIDSS}</span><span class="s1">'</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">'obj_vs_err_obj.png'</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">clf</span><span class="p">()</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">clf</span><span class="p">()</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">ob_h</span><span class="p">,</span> <span class="n">e_ob_h</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">'Error in $H_</span><span class="si">{UKIDSS}</span><span class="s1">$'</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">'$H_</span><span class="si">{UKIDSS}</span><span class="s1">'</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">'obh_vs_err_obh.png'</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">clf</span><span class="p">()</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">clf</span><span class="p">()</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">ob_k</span><span class="p">,</span> <span class="n">e_ob_k</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">'Error in $K_</span><span class="si">{UKIDSS}</span><span class="s1">$'</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">'$K_</span><span class="si">{UKIDSS}</span><span class="s1">'</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">'obk_vs_err_obk.png'</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">clf</span><span class="p">()</span>


        <span class="n">bins2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">diff_jf</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">diff_jf</span><span class="p">)</span><span class="o">+</span><span class="mf">.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">clf</span><span class="p">()</span>
        <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
        <span class="kn">from</span> <span class="nn">matplotlib.gridspec</span> <span class="kn">import</span> <span class="n">GridSpec</span>
        <span class="n">gs</span> <span class="o">=</span> <span class="n">GridSpec</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
        <span class="n">ax_joint</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">4</span><span class="p">,</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">])</span>
        <span class="n">ax_marg_x</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">])</span>
        <span class="n">ax_marg_y</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
        <span class="n">ax_joint</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">ob_j</span><span class="p">,</span> <span class="n">diff_jf</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.3</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">'g'</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span>\
                        <span class="s1">'No. of stars ='</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ob_j</span><span class="p">)))</span>
        <span class="n">ax_joint</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
        <span class="n">ax_joint</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">ax_joint</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span> <span class="o">=</span> <span class="s1">'best'</span><span class="p">)</span>
        <span class="n">nx</span><span class="p">,</span> <span class="n">bx</span><span class="p">,</span> <span class="n">px</span> <span class="o">=</span> <span class="n">ax_marg_x</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">ob_j</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">'m'</span><span class="p">,</span> <span class="n">edgecolor</span> <span class="o">=</span> <span class="s1">'g'</span><span class="p">,</span> <span class="n">density</span> <span class="o">=</span><span class="kc">True</span><span class="p">,</span>\
                                    <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">'Observed J'</span><span class="p">)</span>
        <span class="n">ny</span><span class="p">,</span> <span class="n">by</span><span class="p">,</span> <span class="n">px</span> <span class="o">=</span> <span class="n">ax_marg_y</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">diff_jf</span><span class="p">,</span> <span class="n">bins</span> <span class="o">=</span> <span class="n">bins2</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="s2">"horizontal"</span><span class="p">,</span>\
                                    <span class="n">edgecolor</span> <span class="o">=</span> <span class="s1">'g'</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span>\
                                    <span class="n">facecolor</span> <span class="o">=</span> <span class="s1">'orange'</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">'Difference'</span><span class="p">)</span>
        <span class="n">biny_max</span> <span class="o">=</span> <span class="n">find_nearest</span><span class="p">(</span><span class="n">ny</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">ny</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">'binymax='</span><span class="p">,</span> <span class="n">biny_max</span><span class="p">)</span>
        <span class="c1">#ax_marg_y.set_title('Median at:%0.2f'%(by[np.where(ny==biny_max)[0][0]]))</span>
        <span class="n">ax_joint</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">'Median and spread of the scatter ='</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="s2">"</span><span class="si">{:.3f}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">diff_jf</span><span class="p">)))</span>\
                           <span class="o">+</span><span class="sa">r</span><span class="s1">'$\pm$'</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="s2">"</span><span class="si">{:.3f}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">diff_jf</span><span class="p">))))</span>
        <span class="n">ax_marg_x</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">'No. of sources lying in the range -0.2 &lt; ($J_</span><span class="si">{o}</span><span class="s1">$ - $J_</span><span class="si">{c}</span><span class="s1">$) &lt; 0.2 ='</span> <span class="o">+</span> \
                            <span class="nb">str</span><span class="p">(</span><span class="s2">"</span><span class="si">{:.2f}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="mi">100</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">indjp</span><span class="p">)</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">diff_jf</span><span class="p">))</span><span class="o">+</span><span class="s1">'%'</span><span class="p">))</span>
        <span class="n">ax_marg_y</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">ax_marg_x</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
        <span class="n">ax_marg_x</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">'best'</span><span class="p">)</span>
        <span class="n">ax_marg_y</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
        <span class="n">ax_marg_y</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">'best'</span><span class="p">)</span>
        <span class="c1"># Turn off tick labels on marginals</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span><span class="n">ax_marg_x</span><span class="o">.</span><span class="n">get_xticklabels</span><span class="p">(),</span> <span class="n">visible</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span><span class="n">ax_marg_y</span><span class="o">.</span><span class="n">get_yticklabels</span><span class="p">(),</span> <span class="n">visible</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="c1"># Set labels on joint</span>
        <span class="n">ax_joint</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">'Observed J magnitude'</span><span class="p">)</span>
        <span class="n">ax_joint</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">'$J_</span><span class="si">{UKIDSS}</span><span class="s1">$ - $J_</span><span class="si">{Computed}</span><span class="s1">$'</span><span class="p">)</span>
        <span class="c1"># Set labels on marginals</span>
        <span class="n">ax_marg_y</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">'N'</span><span class="p">)</span>
        <span class="n">ax_marg_x</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">'N'</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">'validation_plot_j'</span> <span class="o">+</span> <span class="s1">'_'</span> <span class="o">+</span> <span class="s1">'RA'</span> <span class="o">+</span> <span class="s1">'_'</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ra</span><span class="p">)</span> <span class="o">+</span> <span class="s1">'_'</span> <span class="o">+</span> <span class="s1">'DEC'</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dec</span><span class="p">)</span>\
                    <span class="o">+</span><span class="s1">'.png'</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">clf</span><span class="p">()</span>

        <span class="n">bins2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">diff_hf</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">diff_hf</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">+</span><span class="mf">.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">clf</span><span class="p">()</span>
        <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
        <span class="kn">from</span> <span class="nn">matplotlib.gridspec</span> <span class="kn">import</span> <span class="n">GridSpec</span>
        <span class="n">gs</span> <span class="o">=</span> <span class="n">GridSpec</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
        <span class="n">ax_joint</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">4</span><span class="p">,</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">])</span>
        <span class="n">ax_marg_x</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">])</span>
        <span class="n">ax_marg_y</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
        <span class="n">ax_joint</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">ob_h</span><span class="p">,</span> <span class="n">diff_hf</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.3</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">'g'</span><span class="p">,</span>\
                            <span class="n">label</span> <span class="o">=</span> <span class="s1">'No. of stars ='</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ob_j</span><span class="p">)))</span>
        <span class="n">ax_joint</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
        <span class="n">ax_joint</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">ax_joint</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">,</span> <span class="n">loc</span> <span class="o">=</span> <span class="s1">'best'</span><span class="p">)</span>
        <span class="n">nx</span><span class="p">,</span> <span class="n">bx</span><span class="p">,</span> <span class="n">px</span> <span class="o">=</span> <span class="n">ax_marg_x</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">ob_h</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">'m'</span><span class="p">,</span> <span class="n">edgecolor</span> <span class="o">=</span> <span class="s1">'g'</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span>\
                                <span class="n">label</span> <span class="o">=</span> <span class="s1">'Observed J'</span><span class="p">)</span>
        <span class="n">ny</span><span class="p">,</span> <span class="n">by</span><span class="p">,</span> <span class="n">px</span> <span class="o">=</span> <span class="n">ax_marg_y</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">diff_hf</span><span class="p">,</span> <span class="n">bins</span> <span class="o">=</span> <span class="n">bins2</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="s2">"horizontal"</span><span class="p">,</span>\
                                 <span class="n">edgecolor</span> <span class="o">=</span> <span class="s1">'g'</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">facecolor</span> <span class="o">=</span> <span class="s1">'orange'</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">'Difference'</span><span class="p">)</span>
        <span class="n">biny_max</span> <span class="o">=</span> <span class="n">find_nearest</span><span class="p">(</span><span class="n">ny</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">ny</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">'binymax='</span><span class="p">,</span> <span class="n">biny_max</span><span class="p">)</span>
        <span class="c1">#ax_marg_y.set_title('Median at:%0.2f'%(by[np.where(ny==biny_max)[0][0]]))</span>
        <span class="n">ax_joint</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">'Median and spread of the scatter ='</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="s2">"</span><span class="si">{:.3f}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">diff_hf</span><span class="p">)))</span>\
                           <span class="o">+</span><span class="sa">r</span><span class="s1">'$\pm$'</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="s2">"</span><span class="si">{:.3f}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">diff_hf</span><span class="p">))))</span>
        <span class="n">ax_marg_x</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">'No. of sources lying in the range -0.2 &lt; ($H_</span><span class="si">{o}</span><span class="s1">$ - $H_</span><span class="si">{c}</span><span class="s1">$) &lt; 0.2 ='</span> <span class="o">+</span> \
                            <span class="nb">str</span><span class="p">(</span><span class="s2">"</span><span class="si">{:.2f}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="mi">100</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">indhp</span><span class="p">)</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">diff_hf</span><span class="p">))</span><span class="o">+</span><span class="s1">'%'</span><span class="p">))</span>
        <span class="n">ax_marg_y</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">ax_marg_x</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
        <span class="n">ax_marg_x</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">'best'</span><span class="p">)</span>
        <span class="n">ax_marg_y</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
        <span class="n">ax_marg_y</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">'best'</span><span class="p">)</span>
        <span class="c1"># Turn off tick labels on marginals</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span><span class="n">ax_marg_x</span><span class="o">.</span><span class="n">get_xticklabels</span><span class="p">(),</span> <span class="n">visible</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span><span class="n">ax_marg_y</span><span class="o">.</span><span class="n">get_yticklabels</span><span class="p">(),</span> <span class="n">visible</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="c1"># Set labels on joint</span>
        <span class="n">ax_joint</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">'Observed H magnitude'</span><span class="p">)</span>
        <span class="n">ax_joint</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">'$H_</span><span class="si">{UKIDSS}</span><span class="s1">$ - $H_</span><span class="si">{Computed}</span><span class="s1">$'</span><span class="p">)</span>
        <span class="c1"># Set labels on marginals</span>
        <span class="n">ax_marg_y</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">'N'</span><span class="p">)</span>
        <span class="n">ax_marg_x</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">'N'</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">'validation_plot_h'</span> <span class="o">+</span> <span class="s1">'_'</span> <span class="o">+</span> <span class="s1">'RA'</span> <span class="o">+</span> <span class="s1">'_'</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ra</span><span class="p">)</span> <span class="o">+</span> <span class="s1">'_'</span> <span class="o">+</span> <span class="s1">'DEC'</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dec</span><span class="p">)</span><span class="o">+</span>\
                    <span class="s1">'.png'</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">clf</span><span class="p">()</span>

        <span class="n">bins2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">diff_jf</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">diff_jf</span><span class="p">)</span><span class="o">+</span><span class="mf">.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">clf</span><span class="p">()</span>
        <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
        <span class="kn">from</span> <span class="nn">matplotlib.gridspec</span> <span class="kn">import</span> <span class="n">GridSpec</span>
        <span class="n">gs</span> <span class="o">=</span> <span class="n">GridSpec</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
        <span class="n">ax_joint</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">4</span><span class="p">,</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">])</span>
        <span class="n">ax_marg_x</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">])</span>
        <span class="n">ax_marg_y</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
        <span class="n">ax_joint</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">ob_k</span><span class="p">,</span> <span class="n">diff_kf</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.3</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">'g'</span><span class="p">,</span>\
                             <span class="n">label</span> <span class="o">=</span> <span class="s1">'No. of stars ='</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ob_j</span><span class="p">)))</span>
        <span class="n">ax_joint</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
        <span class="n">ax_joint</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">ax_joint</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">,</span> <span class="n">loc</span> <span class="o">=</span> <span class="s1">'best'</span><span class="p">)</span>
        <span class="n">nx</span><span class="p">,</span> <span class="n">bx</span><span class="p">,</span> <span class="n">px</span> <span class="o">=</span> <span class="n">ax_marg_x</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">ob_k</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">'m'</span><span class="p">,</span> <span class="n">edgecolor</span> <span class="o">=</span> <span class="s1">'g'</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span>\
                                        <span class="n">label</span> <span class="o">=</span> <span class="s1">'Observed J'</span><span class="p">)</span>
        <span class="n">ny</span><span class="p">,</span> <span class="n">by</span><span class="p">,</span> <span class="n">px</span> <span class="o">=</span> <span class="n">ax_marg_y</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">diff_kf</span><span class="p">,</span> <span class="n">bins</span> <span class="o">=</span> <span class="n">bins2</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="s2">"horizontal"</span><span class="p">,</span>\
                                    <span class="n">edgecolor</span> <span class="o">=</span> <span class="s1">'g'</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">facecolor</span> <span class="o">=</span> <span class="s1">'orange'</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span>\
                                        <span class="s1">'Difference'</span><span class="p">)</span>
        <span class="n">biny_max</span> <span class="o">=</span> <span class="n">find_nearest</span><span class="p">(</span><span class="n">ny</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">ny</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">'binymax='</span><span class="p">,</span> <span class="n">biny_max</span><span class="p">)</span>
        <span class="c1">#ax_marg_y.set_title('Median at:%0.2f'%(by[np.where(ny==biny_max)[0][0]]))</span>
        <span class="n">ax_marg_y</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">ax_marg_x</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
        <span class="n">ax_marg_x</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">'best'</span><span class="p">)</span>
        <span class="n">ax_marg_y</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
        <span class="n">ax_marg_y</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">'best'</span><span class="p">)</span>
        <span class="n">ax_joint</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">'Median and spread of the scatter ='</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="s2">"</span><span class="si">{:.3f}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">diff_kf</span><span class="p">)))</span>\
                           <span class="o">+</span><span class="sa">r</span><span class="s1">'$\pm$'</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="s2">"</span><span class="si">{:.3f}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">diff_kf</span><span class="p">))))</span>
        <span class="n">ax_marg_x</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">'No. of sources lying in the range -0.2 &lt; ($K_</span><span class="si">{o}</span><span class="s1">$ - $K_</span><span class="si">{c}</span><span class="s1">$) &lt; 0.2 ='</span> <span class="o">+</span>\
                            <span class="nb">str</span><span class="p">(</span><span class="s2">"</span><span class="si">{:.2f}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="mi">100</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">indkp</span><span class="p">)</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">diff_kf</span><span class="p">))</span><span class="o">+</span><span class="s1">'%'</span><span class="p">))</span>
        <span class="c1"># Turn off tick labels on marginals</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span><span class="n">ax_marg_x</span><span class="o">.</span><span class="n">get_xticklabels</span><span class="p">(),</span> <span class="n">visible</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span><span class="n">ax_marg_y</span><span class="o">.</span><span class="n">get_yticklabels</span><span class="p">(),</span> <span class="n">visible</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="c1"># Set labels on joint</span>
        <span class="n">ax_joint</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">'Observed K magnitude'</span><span class="p">)</span>
        <span class="n">ax_joint</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">'$K_</span><span class="si">{UKIDSS}</span><span class="s1">$ - $K_</span><span class="si">{Computed}</span><span class="s1">$'</span><span class="p">)</span>
        <span class="c1"># Set labels on marginals</span>
        <span class="n">ax_marg_y</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">'N'</span><span class="p">)</span>
        <span class="n">ax_marg_x</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">'N'</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">'validation_plot_k'</span> <span class="o">+</span> <span class="s1">'_'</span> <span class="o">+</span> <span class="s1">'RA'</span> <span class="o">+</span> <span class="s1">'_'</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ra</span><span class="p">)</span> <span class="o">+</span> <span class="s1">'_'</span> <span class="o">+</span> <span class="s1">'DEC'</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dec</span><span class="p">)</span><span class="o">+</span>\
                    <span class="s1">'.png'</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">clf</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
</details>
<div class="doc doc-children">
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="irgsctool._validate.ValidateIRGSC.read_irgsc">
<code class="highlight language-python"><span class="n">read_irgsc</span><span class="p">()</span></code>
</h3>
<div class="doc doc-contents">
<p><code>irgsctool.validate.read_irgsc()</code></p>
<p>This function reads the generated IRGSC for a given set of coordinates.</p>
<p><strong>Raises:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<code>FileNotFoundError</code>
</td>
<td><p>This error arises if there is no generated IRGSC</p></td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>irgsctool/_validate.py</code></summary>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">read_irgsc</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""</span>

<span class="sd">        `irgsctool.validate.read_irgsc()`</span>

<span class="sd">        This function reads the generated IRGSC for a given set of coordinates.</span>
<span class="sd">        Raises:</span>
<span class="sd">            FileNotFoundError: This error arises if there is no generated IRGSC</span>
<span class="sd">            available. However, this function then generates it.</span>

<span class="sd">    """</span>
    <span class="n">ra_name</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ra</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">'.'</span><span class="p">,</span><span class="s1">'_'</span><span class="p">)</span>
    <span class="n">dec_name</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dec</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">'.'</span><span class="p">,</span> <span class="s1">'_'</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">irgsc_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">genfromtxt</span><span class="p">(</span><span class="s1">'IRGSC'</span> <span class="o">+</span> <span class="s1">'_'</span> <span class="o">+</span> <span class="s1">'RA'</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">ra_name</span><span class="p">)</span> <span class="o">+</span> <span class="s1">'DEC'</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">dec_name</span><span class="p">)</span> <span class="o">+</span>\
                  <span class="nb">str</span><span class="p">(</span><span class="n">current_datetime</span><span class="p">)</span> <span class="o">+</span> <span class="s1">'.csv'</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="s1">','</span><span class="p">,</span> <span class="n">skip_header</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

    <span class="k">except</span> <span class="ne">FileNotFoundError</span><span class="p">:</span>
        <span class="n">gc</span> <span class="o">=</span> <span class="n">GenerateIRGSC</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ra</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">dec</span><span class="p">)</span>
        <span class="n">gc</span><span class="o">.</span><span class="n">generate_irgsc</span><span class="p">()</span>
    <span class="n">irgsc_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">genfromtxt</span><span class="p">(</span><span class="s1">'IRGSC'</span> <span class="o">+</span> <span class="s1">'_'</span> <span class="o">+</span> <span class="s1">'RA'</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">ra_name</span><span class="p">)</span> <span class="o">+</span> <span class="s1">'DEC'</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">dec_name</span><span class="p">)</span> <span class="o">+</span>\
                  <span class="nb">str</span><span class="p">(</span><span class="n">current_datetime</span><span class="p">)</span> <span class="o">+</span> <span class="s1">'.csv'</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="s1">','</span><span class="p">,</span> <span class="n">skip_header</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">ps1_objid</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">ps_ra</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">err_ps_ra</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">2</span><span class="p">]</span>
    <span class="n">ps_dec</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">3</span><span class="p">]</span>
    <span class="n">err_ps_dec</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">4</span><span class="p">]</span>
    <span class="n">ec_gmag</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">5</span><span class="p">]</span>
    <span class="n">e_ec_gmag</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">6</span><span class="p">]</span>
    <span class="n">ec_rmag</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">7</span><span class="p">]</span>
    <span class="n">e_ec_rmag</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">8</span><span class="p">]</span>
    <span class="n">ec_imag</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">9</span><span class="p">]</span>
    <span class="n">e_ec_imag</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">10</span><span class="p">]</span>
    <span class="n">ec_zmag</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">11</span><span class="p">]</span>
    <span class="n">e_ec_zmag</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">12</span><span class="p">]</span>
    <span class="n">ec_ymag</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">13</span><span class="p">]</span>
    <span class="n">e_ec_ymag</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">14</span><span class="p">]</span>
    <span class="n">teff</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">15</span><span class="p">]</span>
    <span class="n">logg</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">16</span><span class="p">]</span>
    <span class="n">feh</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">17</span><span class="p">]</span>
    <span class="n">sam_g</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">18</span><span class="p">]</span>
    <span class="n">sam_r</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">19</span><span class="p">]</span>
    <span class="n">sam_i</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">20</span><span class="p">]</span>
    <span class="n">sam_z</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">21</span><span class="p">]</span>
    <span class="n">sam_y</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">22</span><span class="p">]</span>
    <span class="n">sam_j</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">23</span><span class="p">]</span>
    <span class="n">sam_h</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">24</span><span class="p">]</span>
    <span class="n">sam_k</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">25</span><span class="p">]</span>
    <span class="n">sf_avg</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">26</span><span class="p">]</span>
    <span class="n">sigma_sf</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">27</span><span class="p">]</span>
    <span class="n">min_dquad_element</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">28</span><span class="p">]</span>
    <span class="n">computed_j</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">29</span><span class="p">]</span>
    <span class="n">computed_j_error</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">30</span><span class="p">]</span>
    <span class="n">computed_h</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">31</span><span class="p">]</span>
    <span class="n">computed_h_error</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">32</span><span class="p">]</span>
    <span class="n">computed_k</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">33</span><span class="p">]</span>
    <span class="n">computed_k_error</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">34</span><span class="p">]</span>
    <span class="n">gaia_source_id</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">35</span><span class="p">]</span>
    <span class="n">gaia_ra</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">36</span><span class="p">]</span>
    <span class="n">gaia_ra_error</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">37</span><span class="p">]</span>
    <span class="n">gaia_dec</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">38</span><span class="p">]</span>
    <span class="n">gaia_dec_error</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">39</span><span class="p">]</span>
    <span class="n">gaia_parallax</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">40</span><span class="p">]</span>
    <span class="n">gaia_parallax_error</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">41</span><span class="p">]</span>
    <span class="n">gaia_pm</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">42</span><span class="p">]</span>
    <span class="n">gaia_pm_ra</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">43</span><span class="p">]</span>
    <span class="n">gaia_pm_ra_error</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">44</span><span class="p">]</span>
    <span class="n">gaia_pm_dec</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">45</span><span class="p">]</span>
    <span class="n">gaia_pm_dec_error</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">46</span><span class="p">]</span>
    <span class="n">gaia_ruwe</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">47</span><span class="p">]</span>
    <span class="n">objinfoflag</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">48</span><span class="p">]</span>
    <span class="n">qualityflag</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">49</span><span class="p">]</span>
    <span class="n">ndetections</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">50</span><span class="p">]</span>
    <span class="n">nstackdetections</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">51</span><span class="p">]</span>
    <span class="n">ginfoflag</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">52</span><span class="p">]</span>
    <span class="n">ginfoflag2</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">53</span><span class="p">]</span>
    <span class="n">ginfoflag3</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">54</span><span class="p">]</span>
    <span class="n">rinfoflag</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">55</span><span class="p">]</span>
    <span class="n">rinfoflag2</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">56</span><span class="p">]</span>
    <span class="n">rinfoflag3</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">57</span><span class="p">]</span>
    <span class="n">iinfoflag</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">58</span><span class="p">]</span>
    <span class="n">iinfoflag2</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">59</span><span class="p">]</span>
    <span class="n">iinfoflag3</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">60</span><span class="p">]</span>
    <span class="n">zinfoflag</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">61</span><span class="p">]</span>
    <span class="n">zinfoflag2</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">62</span><span class="p">]</span>
    <span class="n">zinfoflag3</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">63</span><span class="p">]</span>
    <span class="n">yinfoflag</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">64</span><span class="p">]</span>
    <span class="n">yinfoflag2</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">65</span><span class="p">]</span>
    <span class="n">yinfoflag3</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">66</span><span class="p">]</span>

    <span class="n">irgsc_data</span> <span class="o">=</span> <span class="n">ps1_objid</span><span class="p">,</span> <span class="n">ps_ra</span><span class="p">,</span> <span class="n">err_ps_ra</span><span class="p">,</span> <span class="n">ps_dec</span><span class="p">,</span> <span class="n">err_ps_dec</span><span class="p">,</span> <span class="n">ec_gmag</span><span class="p">,</span> <span class="n">e_ec_gmag</span><span class="p">,</span> <span class="n">ec_rmag</span><span class="p">,</span> <span class="n">e_ec_rmag</span><span class="p">,</span>\
        <span class="n">ec_imag</span><span class="p">,</span> <span class="n">e_ec_imag</span><span class="p">,</span> <span class="n">ec_zmag</span><span class="p">,</span> <span class="n">e_ec_zmag</span><span class="p">,</span> <span class="n">ec_ymag</span><span class="p">,</span> <span class="n">e_ec_ymag</span><span class="p">,</span> <span class="n">teff</span><span class="p">,</span> <span class="n">logg</span><span class="p">,</span> <span class="n">feh</span><span class="p">,</span> <span class="n">sam_g</span><span class="p">,</span>\
            <span class="n">sam_r</span><span class="p">,</span> <span class="n">sam_i</span><span class="p">,</span> <span class="n">sam_z</span><span class="p">,</span> <span class="n">sam_y</span><span class="p">,</span> <span class="n">sam_j</span><span class="p">,</span> <span class="n">sam_h</span><span class="p">,</span> <span class="n">sam_k</span><span class="p">,</span> <span class="n">sf_avg</span><span class="p">,</span> <span class="n">sigma_sf</span><span class="p">,</span> <span class="n">min_dquad_element</span><span class="p">,</span>\
            <span class="n">computed_j</span><span class="p">,</span> <span class="n">computed_j_error</span><span class="p">,</span> <span class="n">computed_h</span><span class="p">,</span> <span class="n">computed_h_error</span><span class="p">,</span> <span class="n">computed_k</span><span class="p">,</span> <span class="n">computed_k_error</span><span class="p">,</span>\
                <span class="n">gaia_source_id</span><span class="p">,</span> <span class="n">gaia_ra</span><span class="p">,</span> <span class="n">gaia_ra_error</span><span class="p">,</span> <span class="n">gaia_dec</span><span class="p">,</span> <span class="n">gaia_dec_error</span><span class="p">,</span> <span class="n">gaia_parallax</span><span class="p">,</span>\
                <span class="n">gaia_parallax_error</span><span class="p">,</span> <span class="n">gaia_pm</span><span class="p">,</span> <span class="n">gaia_pm_ra</span><span class="p">,</span> <span class="n">gaia_pm_ra_error</span><span class="p">,</span> <span class="n">gaia_pm_dec</span><span class="p">,</span>\
                    <span class="n">gaia_pm_dec_error</span><span class="p">,</span> <span class="n">gaia_ruwe</span><span class="p">,</span> <span class="n">objinfoflag</span><span class="p">,</span> <span class="n">qualityflag</span><span class="p">,</span> <span class="n">ndetections</span><span class="p">,</span>\
                    <span class="n">nstackdetections</span><span class="p">,</span> <span class="n">ginfoflag</span><span class="p">,</span> <span class="n">ginfoflag2</span><span class="p">,</span> <span class="n">ginfoflag3</span><span class="p">,</span> <span class="n">rinfoflag</span><span class="p">,</span> <span class="n">rinfoflag2</span><span class="p">,</span>\
                        <span class="n">rinfoflag3</span><span class="p">,</span> <span class="n">iinfoflag</span><span class="p">,</span> <span class="n">iinfoflag2</span><span class="p">,</span> <span class="n">iinfoflag3</span><span class="p">,</span> <span class="n">zinfoflag</span><span class="p">,</span> <span class="n">zinfoflag2</span><span class="p">,</span>\
                        <span class="n">zinfoflag3</span><span class="p">,</span> <span class="n">yinfoflag</span><span class="p">,</span> <span class="n">yinfoflag2</span><span class="p">,</span> <span class="n">yinfoflag3</span>
    <span class="k">return</span> <span class="n">irgsc_data</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="irgsctool._validate.ValidateIRGSC.validate">
<code class="highlight language-python"><span class="n">validate</span><span class="p">(</span><span class="n">validate</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>
</h3>
<div class="doc doc-contents">
<p><code>irgsctool.ValidateIRGSC.calidate(validate=True)</code></p>
<p>This method compares the observed and computed NIR magnitudes for a given field.
If this is set to True, the method first obtains the UKIDSS data for the given field.
The output is a validated IRGSC and plots showing the comparison of the 
computed NIR magnitudes with the observed ones.</p>
<p><strong>Raises:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<code>ValueError</code>
</td>
<td><p>if validate is False</p></td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>irgsctool/_validate.py</code></summary>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">validate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">validate</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""</span>

<span class="sd">        `irgsctool.ValidateIRGSC.calidate(validate=True)`</span>

<span class="sd">        This method compares the observed and computed NIR magnitudes for a given field.</span>
<span class="sd">        If this is set to True, the method first obtains the UKIDSS data for the given field.</span>
<span class="sd">        The output is a validated IRGSC and plots showing the comparison of the </span>
<span class="sd">        computed NIR magnitudes with the observed ones.</span>

<span class="sd">        Raises:</span>
<span class="sd">                ValueError: if validate is False</span>

<span class="sd">    """</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">""</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">'###############################################################################'</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">'Now validating the generated IRGSC using the UKIDSS data file if it is present.'</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">""</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">'###############################################################################'</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">validate</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">True</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">'Cannot proceed as validate=False'</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">validate</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
        <span class="n">ukidss_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rd</span><span class="o">.</span><span class="n">read_nir_data</span><span class="p">()</span>
        <span class="n">irgsc_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">read_irgsc</span><span class="p">()</span>
        <span class="n">ukidss_j</span><span class="p">,</span> <span class="n">ukidss_h</span><span class="p">,</span> <span class="n">ukidss_k</span><span class="p">,</span> <span class="n">e_ukidss_j</span><span class="p">,</span> <span class="n">e_ukidss_h</span><span class="p">,</span> <span class="n">e_ukidss_k</span><span class="p">,</span> <span class="n">ukidss_ra</span><span class="p">,</span> <span class="n">ukidss_dec</span> <span class="o">=</span> <span class="n">ukidss_data</span>
        <span class="n">ps1_objid</span><span class="p">,</span> <span class="n">ps_ra</span><span class="p">,</span> <span class="n">err_ps_ra</span><span class="p">,</span> <span class="n">ps_dec</span><span class="p">,</span> <span class="n">err_ps_dec</span><span class="p">,</span> <span class="n">ec_gmag</span><span class="p">,</span> <span class="n">e_ec_gmag</span><span class="p">,</span> <span class="n">ec_rmag</span><span class="p">,</span>\
            <span class="n">e_ec_rmag</span><span class="p">,</span> <span class="n">ec_imag</span><span class="p">,</span> <span class="n">e_ec_imag</span><span class="p">,</span> <span class="n">ec_zmag</span><span class="p">,</span> <span class="n">e_ec_zmag</span><span class="p">,</span> <span class="n">ec_ymag</span><span class="p">,</span> <span class="n">e_ec_ymag</span><span class="p">,</span> <span class="n">teff</span><span class="p">,</span>\
            <span class="n">logg</span><span class="p">,</span> <span class="n">feh</span><span class="p">,</span> <span class="n">sam_g</span><span class="p">,</span><span class="n">sam_r</span><span class="p">,</span> <span class="n">sam_i</span><span class="p">,</span> <span class="n">sam_z</span><span class="p">,</span> <span class="n">sam_y</span><span class="p">,</span> <span class="n">sam_j</span><span class="p">,</span> <span class="n">sam_h</span><span class="p">,</span> <span class="n">sam_k</span><span class="p">,</span> <span class="n">sf_avg</span><span class="p">,</span> <span class="n">sigma_sf</span><span class="p">,</span>\
                <span class="n">min_dquad_element</span><span class="p">,</span> <span class="n">computed_j</span><span class="p">,</span> <span class="n">computed_j_error</span><span class="p">,</span> <span class="n">computed_h</span><span class="p">,</span> <span class="n">computed_h_error</span><span class="p">,</span>\
                    <span class="n">computed_k</span><span class="p">,</span> <span class="n">computed_k_error</span><span class="p">,</span> <span class="n">gaia_source_id</span><span class="p">,</span> <span class="n">gaia_ra</span><span class="p">,</span> <span class="n">gaia_ra_error</span><span class="p">,</span>\
                        <span class="n">gaia_dec</span><span class="p">,</span> <span class="n">gaia_dec_error</span><span class="p">,</span> <span class="n">gaia_parallax</span><span class="p">,</span> <span class="n">gaia_parallax_error</span><span class="p">,</span>\
                        <span class="n">gaia_pm</span><span class="p">,</span> <span class="n">gaia_pm_ra</span><span class="p">,</span> <span class="n">gaia_pm_ra_error</span><span class="p">,</span> <span class="n">gaia_pm_dec</span><span class="p">,</span> <span class="n">gaia_pm_dec_error</span><span class="p">,</span>\
                            <span class="n">gaia_ruwe</span><span class="p">,</span> <span class="n">objinfoflag</span><span class="p">,</span> <span class="n">qualityflag</span><span class="p">,</span> <span class="n">ndetections</span><span class="p">,</span> <span class="n">nstackdetections</span><span class="p">,</span>\
                            <span class="n">ginfoflag</span><span class="p">,</span> <span class="n">ginfoflag2</span><span class="p">,</span> <span class="n">ginfoflag3</span><span class="p">,</span> <span class="n">rinfoflag</span><span class="p">,</span> <span class="n">rinfoflag2</span><span class="p">,</span> <span class="n">rinfoflag3</span><span class="p">,</span>\
                                <span class="n">iinfoflag</span><span class="p">,</span> <span class="n">iinfoflag2</span><span class="p">,</span> <span class="n">iinfoflag3</span><span class="p">,</span> <span class="n">zinfoflag</span><span class="p">,</span> <span class="n">zinfoflag2</span><span class="p">,</span>\
                                <span class="n">zinfoflag3</span><span class="p">,</span> <span class="n">yinfoflag</span><span class="p">,</span> <span class="n">yinfoflag2</span><span class="p">,</span> <span class="n">yinfoflag3</span> <span class="o">=</span> <span class="n">irgsc_data</span>

    <span class="n">validate_params</span><span class="o">=</span><span class="p">[];</span> <span class="n">ob_j</span> <span class="o">=</span> <span class="p">[];</span> <span class="n">e_ob_j</span> <span class="o">=</span> <span class="p">[];</span> <span class="n">ob_h</span> <span class="o">=</span> <span class="p">[];</span> <span class="n">e_ob_h</span> <span class="o">=</span> <span class="p">[];</span> <span class="n">ob_k</span> <span class="o">=</span> <span class="p">[];</span> <span class="n">e_ob_k</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">diff_jf</span> <span class="o">=</span> <span class="p">[];</span> <span class="n">diff_hf</span> <span class="o">=</span> <span class="p">[];</span> <span class="n">diff_kf</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">ra_name</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ra</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">'.'</span><span class="p">,</span><span class="s1">'_'</span><span class="p">);</span> <span class="n">dec_name</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dec</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">'.'</span><span class="p">,</span> <span class="s1">'_'</span><span class="p">)</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">'validated_IRGSC'</span> <span class="o">+</span> <span class="s1">'_'</span> <span class="o">+</span> <span class="s1">'RA'</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">ra_name</span><span class="p">)</span> <span class="o">+</span> <span class="s1">'_'</span> <span class="o">+</span> <span class="s1">'DEC'</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">dec_name</span><span class="p">)</span> <span class="o">+</span> <span class="s1">'_'</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">current_datetime</span><span class="p">)</span> <span class="o">+</span> <span class="s1">'.csv'</span><span class="p">,</span> <span class="s1">'w'</span><span class="p">)</span> <span class="k">as</span> <span class="n">file2</span><span class="p">:</span>
        <span class="n">writer</span><span class="o">=</span><span class="n">csv</span><span class="o">.</span><span class="n">writer</span><span class="p">(</span><span class="n">file2</span><span class="p">)</span>
        <span class="n">writer</span><span class="o">.</span><span class="n">writerow</span><span class="p">(</span><span class="n">header</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i1</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ps_ra</span><span class="p">)):</span>
            <span class="c1">#positionally matching the sources in the UKIDSS within 1" to the PS1 sources in the catalogue</span>
            <span class="n">gamma_ukidss</span> <span class="o">=</span> <span class="mi">3600</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(((</span><span class="n">ps_ra</span><span class="p">[</span><span class="n">i1</span><span class="p">]</span> <span class="o">-</span> <span class="n">ukidss_ra</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="n">ps_dec</span><span class="p">[</span><span class="n">i1</span><span class="p">])))</span><span class="o">**</span><span class="mi">2</span>\
                                  <span class="o">+</span> <span class="p">(</span><span class="n">ps_dec</span><span class="p">[</span><span class="n">i1</span><span class="p">]</span> <span class="o">-</span> <span class="n">ukidss_dec</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
            <span class="n">index_ukidss_position</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">gamma_ukidss</span><span class="o">&lt;=</span><span class="mf">1.0</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">index_ukidss_position</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">matched_positions</span> <span class="o">=</span> <span class="n">gamma_ukidss</span><span class="p">[</span><span class="n">index_ukidss_position</span><span class="p">]</span>
                <span class="n">minimum_seperation</span> <span class="o">=</span> <span class="n">gamma_ukidss</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">matched_positions</span><span class="p">)</span> <span class="o">==</span> <span class="n">gamma_ukidss</span><span class="p">)[</span><span class="mi">0</span><span class="p">]]</span>
                <span class="n">index_minimum_seperation</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">minimum_seperation</span> <span class="o">==</span> <span class="n">gamma_ukidss</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">diff_j</span> <span class="o">=</span> <span class="n">ukidss_j</span><span class="p">[</span><span class="n">index_minimum_seperation</span><span class="p">]</span> <span class="o">-</span> <span class="n">computed_j</span><span class="p">[</span><span class="n">i1</span><span class="p">]</span>
                <span class="n">diff_h</span> <span class="o">=</span> <span class="n">ukidss_h</span><span class="p">[</span><span class="n">index_minimum_seperation</span><span class="p">]</span> <span class="o">-</span> <span class="n">computed_h</span><span class="p">[</span><span class="n">i1</span><span class="p">]</span>
                <span class="n">diff_k</span> <span class="o">=</span> <span class="n">ukidss_k</span><span class="p">[</span><span class="n">index_minimum_seperation</span><span class="p">]</span> <span class="o">-</span> <span class="n">computed_k</span><span class="p">[</span><span class="n">i1</span><span class="p">]</span>
                <span class="n">validate_params</span> <span class="o">=</span> <span class="n">ps1_objid</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">ps_ra</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">err_ps_ra</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">ps_dec</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">err_ps_dec</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">ec_gmag</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">e_ec_gmag</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">ec_rmag</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span>\
                <span class="n">e_ec_rmag</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">ec_imag</span><span class="p">,</span> <span class="n">e_ec_imag</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">ec_zmag</span><span class="p">,</span> <span class="n">e_ec_zmag</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">ec_ymag</span><span class="p">,</span> <span class="n">e_ec_ymag</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">teff</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">logg</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">feh</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">sam_g</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span>\
                <span class="n">sam_r</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">sam_i</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">sam_z</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">sam_y</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">sam_j</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">sam_h</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">sam_k</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">sf_avg</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">sigma_sf</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">min_dquad_element</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span>\
                <span class="n">computed_j</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">computed_j_error</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">computed_h</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">computed_h_error</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">computed_k</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">computed_k_error</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">gaia_source_id</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span>\
                <span class="n">gaia_ra</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">gaia_ra_error</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">gaia_dec</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">gaia_dec_error</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">gaia_parallax</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">gaia_parallax_error</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">gaia_pm</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">gaia_pm_ra</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span>\
                <span class="n">gaia_pm_ra_error</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">gaia_pm_dec</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">gaia_pm_dec_error</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">gaia_ruwe</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">objinfoflag</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">qualityflag</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">ndetections</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">nstackdetections</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span>\
                <span class="n">ginfoflag</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">ginfoflag2</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">ginfoflag3</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">rinfoflag</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">rinfoflag2</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">rinfoflag3</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">iinfoflag</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">iinfoflag2</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">iinfoflag3</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span>\
                <span class="n">zinfoflag</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">zinfoflag2</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">zinfoflag3</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">yinfoflag</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">yinfoflag2</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">yinfoflag3</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">diff_j</span><span class="p">,</span> <span class="n">diff_h</span><span class="p">,</span> <span class="n">diff_k</span><span class="p">,</span>\
                <span class="n">ukidss_j</span><span class="p">[</span><span class="n">index_minimum_seperation</span><span class="p">],</span> <span class="n">e_ukidss_j</span><span class="p">[</span><span class="n">index_minimum_seperation</span><span class="p">],</span> <span class="n">ukidss_h</span><span class="p">[</span><span class="n">index_minimum_seperation</span><span class="p">],</span> <span class="n">e_ukidss_h</span><span class="p">[</span><span class="n">index_minimum_seperation</span><span class="p">],</span>\
                <span class="n">ukidss_k</span><span class="p">[</span><span class="n">index_minimum_seperation</span><span class="p">],</span> <span class="n">e_ukidss_k</span><span class="p">[</span><span class="n">index_minimum_seperation</span><span class="p">]</span>
                <span class="n">writer</span><span class="o">.</span><span class="n">writerow</span><span class="p">(</span><span class="n">validate_params</span><span class="p">)</span>
                <span class="n">ob_j</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ob_j</span><span class="p">,</span> <span class="n">ukidss_j</span><span class="p">[</span><span class="n">index_minimum_seperation</span><span class="p">])</span>
                <span class="n">e_ob_j</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">e_ob_j</span><span class="p">,</span> <span class="n">e_ukidss_j</span><span class="p">[</span><span class="n">index_minimum_seperation</span><span class="p">])</span>
                <span class="n">ob_h</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ob_h</span><span class="p">,</span> <span class="n">ukidss_h</span><span class="p">[</span><span class="n">index_minimum_seperation</span><span class="p">])</span>
                <span class="n">e_ob_h</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">e_ob_h</span><span class="p">,</span> <span class="n">e_ukidss_h</span><span class="p">[</span><span class="n">index_minimum_seperation</span><span class="p">])</span>
                <span class="n">ob_k</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ob_k</span><span class="p">,</span> <span class="n">ukidss_k</span><span class="p">[</span><span class="n">index_minimum_seperation</span><span class="p">])</span>
                <span class="n">e_ob_k</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">e_ob_k</span><span class="p">,</span> <span class="n">e_ukidss_k</span><span class="p">[</span><span class="n">index_minimum_seperation</span><span class="p">])</span>
                <span class="n">diff_jf</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">diff_jf</span><span class="p">,</span> <span class="n">diff_j</span><span class="p">)</span>
                <span class="n">diff_hf</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">diff_hf</span><span class="p">,</span> <span class="n">diff_h</span><span class="p">)</span>
                <span class="n">diff_kf</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">diff_kf</span><span class="p">,</span> <span class="n">diff_k</span><span class="p">)</span>
            <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">index_ukidss_position</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">diff_j</span> <span class="o">=</span> <span class="n">ukidss_j</span><span class="p">[</span><span class="n">index_ukidss_position</span><span class="p">]</span> <span class="o">-</span> <span class="n">computed_j</span><span class="p">[</span><span class="n">i1</span><span class="p">]</span>
                <span class="n">diff_h</span> <span class="o">=</span> <span class="n">ukidss_h</span><span class="p">[</span><span class="n">index_ukidss_position</span><span class="p">]</span> <span class="o">-</span> <span class="n">computed_h</span><span class="p">[</span><span class="n">i1</span><span class="p">]</span>
                <span class="n">diff_k</span> <span class="o">=</span> <span class="n">ukidss_k</span><span class="p">[</span><span class="n">index_ukidss_position</span><span class="p">]</span> <span class="o">-</span> <span class="n">computed_k</span><span class="p">[</span><span class="n">i1</span><span class="p">]</span>
                <span class="n">validate_params</span> <span class="o">=</span> <span class="n">ps1_objid</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">ps_ra</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">err_ps_ra</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">ps_dec</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">err_ps_dec</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">ec_gmag</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">e_ec_gmag</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">ec_rmag</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span>\
                <span class="n">e_ec_rmag</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">ec_imag</span><span class="p">,</span> <span class="n">e_ec_imag</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">ec_zmag</span><span class="p">,</span> <span class="n">e_ec_zmag</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">ec_ymag</span><span class="p">,</span> <span class="n">e_ec_ymag</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">teff</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">logg</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">feh</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">sam_g</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span>\
                <span class="n">sam_r</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">sam_i</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">sam_z</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">sam_y</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">sam_j</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">sam_h</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">sam_k</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">sf_avg</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">sigma_sf</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">min_dquad_element</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span>\
                <span class="n">computed_j</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">computed_j_error</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">computed_h</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">computed_h_error</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">computed_k</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">computed_k_error</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">gaia_source_id</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span>\
                <span class="n">gaia_ra</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">gaia_ra_error</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">gaia_dec</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">gaia_dec_error</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">gaia_parallax</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">gaia_parallax_error</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">gaia_pm</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">gaia_pm_ra</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span>\
                <span class="n">gaia_pm_ra_error</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">gaia_pm_dec</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">gaia_pm_dec_error</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">gaia_ruwe</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">objinfoflag</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">qualityflag</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">ndetections</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">nstackdetections</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span>\
                <span class="n">ginfoflag</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">ginfoflag2</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">ginfoflag3</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">rinfoflag</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">rinfoflag2</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">rinfoflag3</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">iinfoflag</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">iinfoflag2</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">iinfoflag3</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span>\
                <span class="n">zinfoflag</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">zinfoflag2</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">zinfoflag3</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">yinfoflag</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">yinfoflag2</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">yinfoflag3</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">diff_j</span><span class="p">,</span> <span class="n">diff_h</span><span class="p">,</span> <span class="n">diff_k</span><span class="p">,</span>\
                <span class="n">ukidss_j</span><span class="p">[</span><span class="n">index_ukidss_position</span><span class="p">],</span> <span class="n">e_ukidss_j</span><span class="p">[</span><span class="n">index_ukidss_position</span><span class="p">],</span> <span class="n">ukidss_h</span><span class="p">[</span><span class="n">index_ukidss_position</span><span class="p">],</span> <span class="n">e_ukidss_h</span><span class="p">[</span><span class="n">index_ukidss_position</span><span class="p">],</span>\
                <span class="n">ukidss_k</span><span class="p">[</span><span class="n">index_ukidss_position</span><span class="p">],</span> <span class="n">e_ukidss_k</span><span class="p">[</span><span class="n">index_ukidss_position</span><span class="p">]</span>
                <span class="n">writer</span><span class="o">.</span><span class="n">writerow</span><span class="p">(</span><span class="n">validate_params</span><span class="p">)</span>
                <span class="n">ob_j</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ob_j</span><span class="p">,</span> <span class="n">ukidss_j</span><span class="p">[</span><span class="n">index_ukidss_position</span><span class="p">])</span>
                <span class="n">e_ob_j</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">e_ob_j</span><span class="p">,</span> <span class="n">e_ukidss_j</span><span class="p">[</span><span class="n">index_ukidss_position</span><span class="p">])</span>
                <span class="n">ob_h</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ob_h</span><span class="p">,</span> <span class="n">ukidss_h</span><span class="p">[</span><span class="n">index_ukidss_position</span><span class="p">])</span>
                <span class="n">e_ob_h</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">e_ob_h</span><span class="p">,</span> <span class="n">e_ukidss_h</span><span class="p">[</span><span class="n">index_ukidss_position</span><span class="p">])</span>
                <span class="n">ob_k</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ob_k</span><span class="p">,</span> <span class="n">ukidss_k</span><span class="p">[</span><span class="n">index_ukidss_position</span><span class="p">])</span>
                <span class="n">e_ob_k</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">e_ob_k</span><span class="p">,</span> <span class="n">e_ukidss_k</span><span class="p">[</span><span class="n">index_ukidss_position</span><span class="p">])</span>
                <span class="n">diff_jf</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">diff_jf</span><span class="p">,</span> <span class="n">diff_j</span><span class="p">)</span>
                <span class="n">diff_hf</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">diff_hf</span><span class="p">,</span> <span class="n">diff_h</span><span class="p">)</span>
                <span class="n">diff_kf</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">diff_kf</span><span class="p">,</span> <span class="n">diff_k</span><span class="p">)</span>

    <span class="n">indjp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">diff_jf</span><span class="p">)</span><span class="o">&lt;</span><span class="mf">0.2</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">indhp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">diff_hf</span><span class="p">)</span><span class="o">&lt;</span><span class="mf">0.2</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">indkp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">diff_kf</span><span class="p">)</span><span class="o">&lt;</span><span class="mf">0.2</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">clf</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">ob_j</span><span class="p">,</span> <span class="n">e_ob_j</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">'Error in $J_</span><span class="si">{UKIDSS}</span><span class="s1">$'</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">'$J_</span><span class="si">{UKIDSS}</span><span class="s1">'</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">'obj_vs_err_obj.png'</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">clf</span><span class="p">()</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">clf</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">ob_h</span><span class="p">,</span> <span class="n">e_ob_h</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">'Error in $H_</span><span class="si">{UKIDSS}</span><span class="s1">$'</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">'$H_</span><span class="si">{UKIDSS}</span><span class="s1">'</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">'obh_vs_err_obh.png'</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">clf</span><span class="p">()</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">clf</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">ob_k</span><span class="p">,</span> <span class="n">e_ob_k</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">'Error in $K_</span><span class="si">{UKIDSS}</span><span class="s1">$'</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">'$K_</span><span class="si">{UKIDSS}</span><span class="s1">'</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">'obk_vs_err_obk.png'</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">clf</span><span class="p">()</span>


    <span class="n">bins2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">diff_jf</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">diff_jf</span><span class="p">)</span><span class="o">+</span><span class="mf">.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">clf</span><span class="p">()</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
    <span class="kn">from</span> <span class="nn">matplotlib.gridspec</span> <span class="kn">import</span> <span class="n">GridSpec</span>
    <span class="n">gs</span> <span class="o">=</span> <span class="n">GridSpec</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
    <span class="n">ax_joint</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">4</span><span class="p">,</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">])</span>
    <span class="n">ax_marg_x</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">])</span>
    <span class="n">ax_marg_y</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
    <span class="n">ax_joint</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">ob_j</span><span class="p">,</span> <span class="n">diff_jf</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.3</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">'g'</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span>\
                    <span class="s1">'No. of stars ='</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ob_j</span><span class="p">)))</span>
    <span class="n">ax_joint</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
    <span class="n">ax_joint</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">ax_joint</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span> <span class="o">=</span> <span class="s1">'best'</span><span class="p">)</span>
    <span class="n">nx</span><span class="p">,</span> <span class="n">bx</span><span class="p">,</span> <span class="n">px</span> <span class="o">=</span> <span class="n">ax_marg_x</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">ob_j</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">'m'</span><span class="p">,</span> <span class="n">edgecolor</span> <span class="o">=</span> <span class="s1">'g'</span><span class="p">,</span> <span class="n">density</span> <span class="o">=</span><span class="kc">True</span><span class="p">,</span>\
                                <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">'Observed J'</span><span class="p">)</span>
    <span class="n">ny</span><span class="p">,</span> <span class="n">by</span><span class="p">,</span> <span class="n">px</span> <span class="o">=</span> <span class="n">ax_marg_y</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">diff_jf</span><span class="p">,</span> <span class="n">bins</span> <span class="o">=</span> <span class="n">bins2</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="s2">"horizontal"</span><span class="p">,</span>\
                                <span class="n">edgecolor</span> <span class="o">=</span> <span class="s1">'g'</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span>\
                                <span class="n">facecolor</span> <span class="o">=</span> <span class="s1">'orange'</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">'Difference'</span><span class="p">)</span>
    <span class="n">biny_max</span> <span class="o">=</span> <span class="n">find_nearest</span><span class="p">(</span><span class="n">ny</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">ny</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">'binymax='</span><span class="p">,</span> <span class="n">biny_max</span><span class="p">)</span>
    <span class="c1">#ax_marg_y.set_title('Median at:%0.2f'%(by[np.where(ny==biny_max)[0][0]]))</span>
    <span class="n">ax_joint</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">'Median and spread of the scatter ='</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="s2">"</span><span class="si">{:.3f}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">diff_jf</span><span class="p">)))</span>\
                       <span class="o">+</span><span class="sa">r</span><span class="s1">'$\pm$'</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="s2">"</span><span class="si">{:.3f}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">diff_jf</span><span class="p">))))</span>
    <span class="n">ax_marg_x</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">'No. of sources lying in the range -0.2 &lt; ($J_</span><span class="si">{o}</span><span class="s1">$ - $J_</span><span class="si">{c}</span><span class="s1">$) &lt; 0.2 ='</span> <span class="o">+</span> \
                        <span class="nb">str</span><span class="p">(</span><span class="s2">"</span><span class="si">{:.2f}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="mi">100</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">indjp</span><span class="p">)</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">diff_jf</span><span class="p">))</span><span class="o">+</span><span class="s1">'%'</span><span class="p">))</span>
    <span class="n">ax_marg_y</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">ax_marg_x</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
    <span class="n">ax_marg_x</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">'best'</span><span class="p">)</span>
    <span class="n">ax_marg_y</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
    <span class="n">ax_marg_y</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">'best'</span><span class="p">)</span>
    <span class="c1"># Turn off tick labels on marginals</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span><span class="n">ax_marg_x</span><span class="o">.</span><span class="n">get_xticklabels</span><span class="p">(),</span> <span class="n">visible</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span><span class="n">ax_marg_y</span><span class="o">.</span><span class="n">get_yticklabels</span><span class="p">(),</span> <span class="n">visible</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="c1"># Set labels on joint</span>
    <span class="n">ax_joint</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">'Observed J magnitude'</span><span class="p">)</span>
    <span class="n">ax_joint</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">'$J_</span><span class="si">{UKIDSS}</span><span class="s1">$ - $J_</span><span class="si">{Computed}</span><span class="s1">$'</span><span class="p">)</span>
    <span class="c1"># Set labels on marginals</span>
    <span class="n">ax_marg_y</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">'N'</span><span class="p">)</span>
    <span class="n">ax_marg_x</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">'N'</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">'validation_plot_j'</span> <span class="o">+</span> <span class="s1">'_'</span> <span class="o">+</span> <span class="s1">'RA'</span> <span class="o">+</span> <span class="s1">'_'</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ra</span><span class="p">)</span> <span class="o">+</span> <span class="s1">'_'</span> <span class="o">+</span> <span class="s1">'DEC'</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dec</span><span class="p">)</span>\
                <span class="o">+</span><span class="s1">'.png'</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">clf</span><span class="p">()</span>

    <span class="n">bins2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">diff_hf</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">diff_hf</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">+</span><span class="mf">.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">clf</span><span class="p">()</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
    <span class="kn">from</span> <span class="nn">matplotlib.gridspec</span> <span class="kn">import</span> <span class="n">GridSpec</span>
    <span class="n">gs</span> <span class="o">=</span> <span class="n">GridSpec</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
    <span class="n">ax_joint</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">4</span><span class="p">,</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">])</span>
    <span class="n">ax_marg_x</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">])</span>
    <span class="n">ax_marg_y</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
    <span class="n">ax_joint</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">ob_h</span><span class="p">,</span> <span class="n">diff_hf</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.3</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">'g'</span><span class="p">,</span>\
                        <span class="n">label</span> <span class="o">=</span> <span class="s1">'No. of stars ='</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ob_j</span><span class="p">)))</span>
    <span class="n">ax_joint</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
    <span class="n">ax_joint</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">ax_joint</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">,</span> <span class="n">loc</span> <span class="o">=</span> <span class="s1">'best'</span><span class="p">)</span>
    <span class="n">nx</span><span class="p">,</span> <span class="n">bx</span><span class="p">,</span> <span class="n">px</span> <span class="o">=</span> <span class="n">ax_marg_x</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">ob_h</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">'m'</span><span class="p">,</span> <span class="n">edgecolor</span> <span class="o">=</span> <span class="s1">'g'</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span>\
                            <span class="n">label</span> <span class="o">=</span> <span class="s1">'Observed J'</span><span class="p">)</span>
    <span class="n">ny</span><span class="p">,</span> <span class="n">by</span><span class="p">,</span> <span class="n">px</span> <span class="o">=</span> <span class="n">ax_marg_y</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">diff_hf</span><span class="p">,</span> <span class="n">bins</span> <span class="o">=</span> <span class="n">bins2</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="s2">"horizontal"</span><span class="p">,</span>\
                             <span class="n">edgecolor</span> <span class="o">=</span> <span class="s1">'g'</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">facecolor</span> <span class="o">=</span> <span class="s1">'orange'</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">'Difference'</span><span class="p">)</span>
    <span class="n">biny_max</span> <span class="o">=</span> <span class="n">find_nearest</span><span class="p">(</span><span class="n">ny</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">ny</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">'binymax='</span><span class="p">,</span> <span class="n">biny_max</span><span class="p">)</span>
    <span class="c1">#ax_marg_y.set_title('Median at:%0.2f'%(by[np.where(ny==biny_max)[0][0]]))</span>
    <span class="n">ax_joint</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">'Median and spread of the scatter ='</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="s2">"</span><span class="si">{:.3f}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">diff_hf</span><span class="p">)))</span>\
                       <span class="o">+</span><span class="sa">r</span><span class="s1">'$\pm$'</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="s2">"</span><span class="si">{:.3f}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">diff_hf</span><span class="p">))))</span>
    <span class="n">ax_marg_x</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">'No. of sources lying in the range -0.2 &lt; ($H_</span><span class="si">{o}</span><span class="s1">$ - $H_</span><span class="si">{c}</span><span class="s1">$) &lt; 0.2 ='</span> <span class="o">+</span> \
                        <span class="nb">str</span><span class="p">(</span><span class="s2">"</span><span class="si">{:.2f}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="mi">100</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">indhp</span><span class="p">)</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">diff_hf</span><span class="p">))</span><span class="o">+</span><span class="s1">'%'</span><span class="p">))</span>
    <span class="n">ax_marg_y</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">ax_marg_x</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
    <span class="n">ax_marg_x</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">'best'</span><span class="p">)</span>
    <span class="n">ax_marg_y</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
    <span class="n">ax_marg_y</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">'best'</span><span class="p">)</span>
    <span class="c1"># Turn off tick labels on marginals</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span><span class="n">ax_marg_x</span><span class="o">.</span><span class="n">get_xticklabels</span><span class="p">(),</span> <span class="n">visible</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span><span class="n">ax_marg_y</span><span class="o">.</span><span class="n">get_yticklabels</span><span class="p">(),</span> <span class="n">visible</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="c1"># Set labels on joint</span>
    <span class="n">ax_joint</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">'Observed H magnitude'</span><span class="p">)</span>
    <span class="n">ax_joint</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">'$H_</span><span class="si">{UKIDSS}</span><span class="s1">$ - $H_</span><span class="si">{Computed}</span><span class="s1">$'</span><span class="p">)</span>
    <span class="c1"># Set labels on marginals</span>
    <span class="n">ax_marg_y</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">'N'</span><span class="p">)</span>
    <span class="n">ax_marg_x</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">'N'</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">'validation_plot_h'</span> <span class="o">+</span> <span class="s1">'_'</span> <span class="o">+</span> <span class="s1">'RA'</span> <span class="o">+</span> <span class="s1">'_'</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ra</span><span class="p">)</span> <span class="o">+</span> <span class="s1">'_'</span> <span class="o">+</span> <span class="s1">'DEC'</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dec</span><span class="p">)</span><span class="o">+</span>\
                <span class="s1">'.png'</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">clf</span><span class="p">()</span>

    <span class="n">bins2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">diff_jf</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">diff_jf</span><span class="p">)</span><span class="o">+</span><span class="mf">.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">clf</span><span class="p">()</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
    <span class="kn">from</span> <span class="nn">matplotlib.gridspec</span> <span class="kn">import</span> <span class="n">GridSpec</span>
    <span class="n">gs</span> <span class="o">=</span> <span class="n">GridSpec</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
    <span class="n">ax_joint</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">4</span><span class="p">,</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">])</span>
    <span class="n">ax_marg_x</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">])</span>
    <span class="n">ax_marg_y</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
    <span class="n">ax_joint</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">ob_k</span><span class="p">,</span> <span class="n">diff_kf</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.3</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">'g'</span><span class="p">,</span>\
                         <span class="n">label</span> <span class="o">=</span> <span class="s1">'No. of stars ='</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ob_j</span><span class="p">)))</span>
    <span class="n">ax_joint</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
    <span class="n">ax_joint</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">ax_joint</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">,</span> <span class="n">loc</span> <span class="o">=</span> <span class="s1">'best'</span><span class="p">)</span>
    <span class="n">nx</span><span class="p">,</span> <span class="n">bx</span><span class="p">,</span> <span class="n">px</span> <span class="o">=</span> <span class="n">ax_marg_x</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">ob_k</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">'m'</span><span class="p">,</span> <span class="n">edgecolor</span> <span class="o">=</span> <span class="s1">'g'</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span>\
                                    <span class="n">label</span> <span class="o">=</span> <span class="s1">'Observed J'</span><span class="p">)</span>
    <span class="n">ny</span><span class="p">,</span> <span class="n">by</span><span class="p">,</span> <span class="n">px</span> <span class="o">=</span> <span class="n">ax_marg_y</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">diff_kf</span><span class="p">,</span> <span class="n">bins</span> <span class="o">=</span> <span class="n">bins2</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="s2">"horizontal"</span><span class="p">,</span>\
                                <span class="n">edgecolor</span> <span class="o">=</span> <span class="s1">'g'</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">facecolor</span> <span class="o">=</span> <span class="s1">'orange'</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span>\
                                    <span class="s1">'Difference'</span><span class="p">)</span>
    <span class="n">biny_max</span> <span class="o">=</span> <span class="n">find_nearest</span><span class="p">(</span><span class="n">ny</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">ny</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">'binymax='</span><span class="p">,</span> <span class="n">biny_max</span><span class="p">)</span>
    <span class="c1">#ax_marg_y.set_title('Median at:%0.2f'%(by[np.where(ny==biny_max)[0][0]]))</span>
    <span class="n">ax_marg_y</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">ax_marg_x</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
    <span class="n">ax_marg_x</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">'best'</span><span class="p">)</span>
    <span class="n">ax_marg_y</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
    <span class="n">ax_marg_y</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">'best'</span><span class="p">)</span>
    <span class="n">ax_joint</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">'Median and spread of the scatter ='</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="s2">"</span><span class="si">{:.3f}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">diff_kf</span><span class="p">)))</span>\
                       <span class="o">+</span><span class="sa">r</span><span class="s1">'$\pm$'</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="s2">"</span><span class="si">{:.3f}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">diff_kf</span><span class="p">))))</span>
    <span class="n">ax_marg_x</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">'No. of sources lying in the range -0.2 &lt; ($K_</span><span class="si">{o}</span><span class="s1">$ - $K_</span><span class="si">{c}</span><span class="s1">$) &lt; 0.2 ='</span> <span class="o">+</span>\
                        <span class="nb">str</span><span class="p">(</span><span class="s2">"</span><span class="si">{:.2f}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="mi">100</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">indkp</span><span class="p">)</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">diff_kf</span><span class="p">))</span><span class="o">+</span><span class="s1">'%'</span><span class="p">))</span>
    <span class="c1"># Turn off tick labels on marginals</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span><span class="n">ax_marg_x</span><span class="o">.</span><span class="n">get_xticklabels</span><span class="p">(),</span> <span class="n">visible</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span><span class="n">ax_marg_y</span><span class="o">.</span><span class="n">get_yticklabels</span><span class="p">(),</span> <span class="n">visible</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="c1"># Set labels on joint</span>
    <span class="n">ax_joint</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">'Observed K magnitude'</span><span class="p">)</span>
    <span class="n">ax_joint</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">'$K_</span><span class="si">{UKIDSS}</span><span class="s1">$ - $K_</span><span class="si">{Computed}</span><span class="s1">$'</span><span class="p">)</span>
    <span class="c1"># Set labels on marginals</span>
    <span class="n">ax_marg_y</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">'N'</span><span class="p">)</span>
    <span class="n">ax_marg_x</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">'N'</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">'validation_plot_k'</span> <span class="o">+</span> <span class="s1">'_'</span> <span class="o">+</span> <span class="s1">'RA'</span> <span class="o">+</span> <span class="s1">'_'</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ra</span><span class="p">)</span> <span class="o">+</span> <span class="s1">'_'</span> <span class="o">+</span> <span class="s1">'DEC'</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dec</span><span class="p">)</span><span class="o">+</span>\
                <span class="s1">'.png'</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">clf</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div><footer>
<div aria-label="Footer Navigation" class="rst-footer-buttons" role="navigation">
<a class="btn btn-neutral float-left" href="about.html" title="About"><span class="icon icon-circle-arrow-left"></span> Previous</a>
<a class="btn btn-neutral float-right" href="license.html" title="License">Next <span class="icon icon-circle-arrow-right"></span></a>
</div>
<hr/>
<div role="contentinfo">
<!-- Copyright etc -->
</div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
</div>
</div>
</section>
</div>
<div aria-label="Versions" class="rst-versions" role="note">
<span class="rst-current-version" data-toggle="rst-current-version">
<span><a href="about.html" style="color: #fcfcfc">Â« Previous</a></span>
<span><a href="license.html" style="color: #fcfcfc">Next Â»</a></span>
</span>
</div>
<script>var base_url = '.';</script>
<script defer="" src="js/theme_extra.js"></script>
<script defer="" src="js/theme.js"></script>
<script defer="" src="javascripts/mathjax.js"></script>
<script defer="" src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script defer="" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
<script defer="">
        window.onload = function () {
            SphinxRtdTheme.Navigation.enable(true);
        };
    </script>
<script>const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});</script></body>
</html>
